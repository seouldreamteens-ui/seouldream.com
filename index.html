<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>ë“œë¦¼í‹´ì¦ˆ êµì ê´€ë¦¬</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=Gmarket+Sans:wght@300;500;700&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CSS ë³€ìˆ˜ & ë¦¬ì…‹
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --primary:    #2563EB;
  --primary-dk: #1D4ED8;
  --primary-lt: #EFF6FF;
  --accent:     #F59E0B;
  --accent-lt:  #FFFBEB;
  --success:    #10B981;
  --danger:     #EF4444;
  --gray-50:    #F9FAFB;
  --gray-100:   #F3F4F6;
  --gray-200:   #E5E7EB;
  --gray-400:   #9CA3AF;
  --gray-600:   #4B5563;
  --gray-800:   #1F2937;
  --white:      #FFFFFF;
  --shadow-sm:  0 1px 3px rgba(0,0,0,.08), 0 1px 2px rgba(0,0,0,.06);
  --shadow-md:  0 4px 16px rgba(0,0,0,.10);
  --shadow-lg:  0 10px 40px rgba(0,0,0,.12);
  --radius:     14px;
  --radius-sm:  8px;
  --font-main:  'Noto Sans KR', sans-serif;
  --font-brand: 'Gmarket Sans', sans-serif;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth;}
body{
  font-family:var(--font-main);
  background:var(--gray-50);
  color:var(--gray-800);
  min-height:100vh;
  padding-bottom:80px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   í—¤ë”
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
header{
  background:linear-gradient(135deg,var(--primary) 0%,#3B82F6 60%,#60A5FA 100%);
  color:#fff;
  padding:16px 20px 12px;
  position:sticky;top:0;z-index:100;
  box-shadow:0 2px 16px rgba(37,99,235,.35);
}
.header-top{display:flex;align-items:center;justify-content:space-between;gap:12px;}
.brand{
  font-family:var(--font-brand);
  font-size:1.1rem;font-weight:700;
  display:flex;align-items:center;gap:8px;
  white-space:nowrap;
}
.brand-icon{font-size:1.4rem;}
/* í—¤ë” ê²€ìƒ‰ì°½: ë‘ ë²ˆì§¸ ì¤„ ì „ì²´ ë„ˆë¹„ */
.header-search-wrap{
  position:relative;
  margin-top:10px;
}
.header-search{
  display:flex;align-items:center;
  background:rgba(255,255,255,.2);
  border:1.5px solid rgba(255,255,255,.35);
  border-radius:50px;
  padding:8px 16px;gap:8px;
  transition:background .2s;
  width:100%;
  box-sizing:border-box;
}
.header-search:focus-within{background:rgba(255,255,255,.3);}
.header-search input{
  background:none;border:none;outline:none;
  color:#fff;font-size:.92rem;font-family:var(--font-main);
  width:100%;
}
.header-search input::placeholder{color:rgba(255,255,255,.75);}

/* ê²€ìƒ‰ ë“œë¡­ë‹¤ìš´ ê²°ê³¼ */
.search-dropdown{
  position:absolute;top:calc(100% + 8px);left:0;right:0;
  background:#fff;border-radius:var(--radius);
  box-shadow:var(--shadow-lg);
  z-index:300;
  max-height:70vh;overflow-y:auto;
  display:none;
  border:1px solid var(--gray-100);
}
.search-dropdown.show{display:block;animation:fadeUp .15s ease;}
.search-drop-header{
  padding:9px 14px;
  font-size:.72rem;font-weight:800;letter-spacing:.05em;
  color:var(--gray-400);text-transform:uppercase;
  background:var(--gray-50);border-bottom:1px solid var(--gray-100);
  position:sticky;top:0;
}
.search-drop-item{
  display:flex;align-items:center;gap:10px;
  padding:11px 14px;cursor:pointer;
  border-bottom:1px solid var(--gray-100);
  transition:background .12s;
}
.search-drop-item:last-child{border-bottom:none;}
.search-drop-item:hover{background:var(--primary-lt);}
.search-drop-avatar{
  width:34px;height:34px;border-radius:50%;flex-shrink:0;
  display:flex;align-items:center;justify-content:center;
  font-size:.9rem;font-weight:700;
  background:var(--primary-lt);color:var(--primary);
}
.search-drop-avatar.teacher{background:var(--accent-lt);color:#92400E;}
.search-drop-name{font-weight:700;font-size:.88rem;color:var(--gray-800);}
.search-drop-sub{font-size:.75rem;color:var(--gray-500);margin-top:1px;}
.search-drop-empty{
  padding:24px;text-align:center;
  font-size:.85rem;color:var(--gray-400);
}
.search-clear-btn{
  background:none;border:none;cursor:pointer;
  color:rgba(255,255,255,.7);font-size:1rem;padding:0;
  line-height:1;flex-shrink:0;
  display:none;
}
.search-clear-btn.show{display:block;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.bottom-nav{
  position:fixed;bottom:0;left:0;right:0;
  background:#fff;
  display:flex;
  border-top:1px solid var(--gray-200);
  box-shadow:0 -4px 20px rgba(0,0,0,.07);
  z-index:100;
}
.nav-btn{
  flex:1;display:flex;flex-direction:column;align-items:center;
  gap:3px;padding:8px 4px 10px;
  background:none;border:none;cursor:pointer;
  color:var(--gray-400);font-family:var(--font-main);
  font-size:.65rem;font-weight:500;
  transition:color .2s;
  -webkit-tap-highlight-color:transparent;
}
.nav-btn .icon{font-size:1.35rem;transition:transform .2s;}
.nav-btn.active{color:var(--primary);}
.nav-btn.active .icon{transform:translateY(-2px);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ë·° ì»¨í…Œì´ë„ˆ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.view{display:none;padding:16px;}
.view.active{display:block;animation:fadeUp .25s ease;}
@keyframes fadeUp{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì¹´ë“œ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card{
  background:#fff;border-radius:var(--radius);
  box-shadow:var(--shadow-sm);
  margin-bottom:12px;overflow:hidden;
  border:1px solid var(--gray-100);
}
.card-header{
  padding:14px 16px;
  display:flex;align-items:center;justify-content:space-between;
  border-bottom:1px solid var(--gray-100);
}
.card-title{font-size:.95rem;font-weight:700;color:var(--gray-800);}
.card-body{padding:14px 16px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ë°°ì§€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.badge{
  display:inline-flex;align-items:center;
  padding:2px 10px;border-radius:50px;
  font-size:.72rem;font-weight:600;
}
.badge-blue{background:var(--primary-lt);color:var(--primary);}
.att-stats-table{width:100%;border-collapse:collapse;font-size:.78rem;}
.att-stats-table th{padding:6px 10px;background:var(--gray-50);color:var(--gray-500);font-weight:700;text-align:center;border-bottom:1px solid var(--gray-100);}
.att-stats-table td{padding:7px 10px;text-align:center;border-bottom:1px solid var(--gray-100);color:var(--gray-700);}
.att-stats-table tr:last-child td{border-bottom:none;}
.att-stats-rate{font-weight:700;color:var(--primary);}
.att-stats-rate.low{color:var(--danger);}
.att-stats-rate.mid{color:var(--accent);}
.attstat-table{
  width:100%;border-collapse:collapse;font-size:.78rem;min-width:320px;
}
.attstat-table th{
  background:var(--primary);color:#fff;padding:7px 8px;
  text-align:center;font-weight:700;white-space:nowrap;
  position:sticky;top:0;z-index:2;
}
.attstat-table th:first-child{position:sticky;left:0;z-index:3;background:var(--primary);}
.attstat-table td{
  padding:7px 8px;text-align:center;
  border-bottom:1px solid var(--gray-100);white-space:nowrap;
}
.attstat-table td:first-child{
  font-weight:700;text-align:left;
  position:sticky;left:0;background:#fff;z-index:1;
  border-right:1px solid var(--gray-100);max-width:90px;
  overflow:hidden;text-overflow:ellipsis;
}
.attstat-table tr:nth-child(even) td{background:var(--gray-50);}
.attstat-table tr:nth-child(even) td:first-child{background:var(--gray-50);}
.att-o{color:#16A34A;font-weight:700;font-size:.85rem;}
.att-x{color:#DC2626;font-weight:700;font-size:.8rem;}
.att-empty{color:var(--gray-300);}
.attstat-wrap{overflow-x:auto;border-radius:var(--radius);border:1px solid var(--gray-100);}
.att-note-btn{
  background:var(--gray-100);border:1.5px solid var(--gray-200);
  color:var(--gray-500);border-radius:6px;padding:4px 8px;
  cursor:pointer;font-size:.82rem;transition:.15s;flex-shrink:0;
}
.att-note-btn:hover{background:var(--gray-200);}
.att-note-btn.has-note{background:#FEF9C3;border-color:#FDE047;color:#854D0E;}
.att-note-input{margin-top:5px;font-size:.82rem;}
.att-note-wrap{padding:0 14px 8px;background:var(--gray-50);border-top:1px dashed var(--gray-100);}
.filter-tag{
  font-size:.72rem;padding:4px 10px;border-radius:50px;
  background:var(--gray-100);border:1.5px solid var(--gray-200);
  color:var(--gray-600);cursor:pointer;font-weight:600;transition:.15s;
}
.filter-tag.active{
  background:var(--primary);border-color:var(--primary);color:#fff;
}
.sort-tab{padding:7px 0;border:none;border-radius:50px;font-size:.78rem;font-weight:600;font-family:var(--font-main);background:none;color:var(--gray-600);cursor:pointer;transition:all .18s;}
.sort-tab.active{background:#fff;color:var(--primary);box-shadow:var(--shadow-sm);}
.badge-green{background:#D1FAE5;color:#065F46;}
.badge-amber{background:var(--accent-lt);color:#92400E;}
.badge-red{background:#FEE2E2;color:#991B1B;}
.badge-gray{background:var(--gray-100);color:var(--gray-600);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   í¼ ìš”ì†Œ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.form-group{margin-bottom:14px;}
.form-label{
  display:block;font-size:.8rem;font-weight:600;
  color:var(--gray-600);margin-bottom:5px;
}
.form-control{
  width:100%;padding:10px 13px;
  border:1.5px solid var(--gray-200);border-radius:var(--radius-sm);
  font-size:.9rem;font-family:var(--font-main);
  color:var(--gray-800);background:#fff;
  outline:none;transition:border-color .2s,box-shadow .2s;
}
.form-control:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(37,99,235,.1);}
select.form-control{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236B7280' d='M6 8L1 3h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;padding-right:32px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ë²„íŠ¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:6px;
  padding:10px 18px;border-radius:var(--radius-sm);
  font-size:.88rem;font-weight:600;font-family:var(--font-main);
  border:none;cursor:pointer;
  transition:all .18s;-webkit-tap-highlight-color:transparent;
  white-space:nowrap;
}
.btn:active{transform:scale(.97);}
.btn-primary{background:var(--primary);color:#fff;}
.btn-primary:hover{background:var(--primary-dk);}
.btn-success{background:var(--success);color:#fff;}
.btn-danger{background:var(--danger);color:#fff;}
.btn-outline{background:#fff;color:var(--primary);border:1.5px solid var(--primary);}
.btn-sm{padding:6px 13px;font-size:.8rem;}
.btn-full{width:100%;}
.btn-accent{background:var(--accent);color:#fff;}
.btn:disabled{opacity:.45;cursor:not-allowed;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì„¹ì…˜ íƒ€ì´í‹€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.section-title{
  font-family:var(--font-brand);
  font-size:1rem;font-weight:700;
  color:var(--gray-800);
  margin-bottom:12px;
  display:flex;align-items:center;gap:8px;
}
.section-title::after{content:'';flex:1;height:1px;background:var(--gray-200);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ëŒ€ì‹œë³´ë“œ - ê²€ìƒ‰ ê²°ê³¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.stat-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:16px;}
.stat-card{
  background:#fff;border-radius:var(--radius);
  padding:14px;text-align:center;
  box-shadow:var(--shadow-sm);border:1px solid var(--gray-100);
}
.stat-num{font-size:1.8rem;font-weight:700;color:var(--primary);font-family:var(--font-brand);}
.stat-label{font-size:.75rem;color:var(--gray-600);margin-top:2px;}

.person-card{
  display:flex;align-items:flex-start;gap:12px;
  padding:14px;background:#fff;
  border-radius:var(--radius);
  box-shadow:var(--shadow-sm);border:1px solid var(--gray-100);
  margin-bottom:10px;cursor:pointer;
  transition:box-shadow .2s,transform .15s;
}
.person-card:active{transform:scale(.99);}
.person-card:hover{box-shadow:var(--shadow-md);}
.avatar{
  width:44px;height:44px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:1.1rem;flex-shrink:0;
  background:var(--primary-lt);color:var(--primary);
  font-weight:700;
}
.avatar.teacher{background:var(--accent-lt);color:#92400E;}
.person-info .name{font-weight:700;font-size:.95rem;}
.person-info .sub{font-size:.78rem;color:var(--gray-600);margin-top:2px;}
.person-info .tags{display:flex;flex-wrap:wrap;gap:4px;margin-top:6px;}

/* ìƒì¼ í•„í„° */
.month-filter{
  display:flex;flex-wrap:wrap;gap:6px;margin-bottom:14px;
  overflow:visible;
}
.month-btn{
  padding:5px 11px;border-radius:50px;
  border:1.5px solid var(--gray-200);
  background:#fff;cursor:pointer;
  font-size:.78rem;font-weight:600;
  font-family:var(--font-main);
  transition:all .18s;
}
.month-btn.active{background:var(--primary);color:#fff;border-color:var(--primary);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì¶œì„ ì²´í¬
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.att-header{
  display:flex;align-items:center;gap:10px;
  margin-bottom:14px;flex-wrap:wrap;
}
.att-header select{flex:1;min-width:0;}

.att-row{
  display:flex;align-items:center;
  padding:11px 14px;background:#fff;
  border-radius:var(--radius-sm);
  border:1px solid var(--gray-100);
  margin-bottom:8px;gap:10px;
  transition:border-color .2s;
}
.att-row.absent{border-color:#FCA5A5;background:#FFF5F5;}
.att-name{flex:1;font-weight:600;font-size:.9rem;}
.att-toggle{
  display:flex;border-radius:50px;
  border:1.5px solid var(--gray-200);
  overflow:hidden;
  flex-shrink:0;
}
.att-toggle button{
  padding:5px 12px;border:none;cursor:pointer;
  font-size:.78rem;font-weight:600;
  font-family:var(--font-main);
  background:#fff;color:var(--gray-600);
  transition:all .15s;
}
.att-toggle button.att-on.active{background:var(--success);color:#fff;}
.att-toggle button.att-off.active{background:var(--danger);color:#fff;}
.absence-reason{
  margin-top:8px;padding-left:0;
  animation:fadeUp .2s ease;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ìƒˆì¹œêµ¬ ê´€ë¦¬
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.newbie-card{
  background:#fff;border-radius:var(--radius);
  border:1px solid var(--gray-200);
  margin-bottom:12px;overflow:hidden;
  box-shadow:var(--shadow-sm);
}
.newbie-header{
  padding:12px 14px;
  display:flex;align-items:center;justify-content:space-between;
  background:var(--gray-50);border-bottom:1px solid var(--gray-100);
}
.newbie-name{font-weight:700;}
.week-grid{
  display:grid;grid-template-columns:repeat(2,1fr);
  gap:10px;padding:12px 14px;
}
.week-item{
  display:flex;flex-direction:column;gap:5px;
}
.week-label{font-size:.72rem;font-weight:700;color:var(--primary);}
.week-row{display:flex;gap:6px;align-items:center;}
.week-row input[type=date]{
  flex:1;padding:6px 8px;
  border:1.5px solid var(--gray-200);border-radius:var(--radius-sm);
  font-size:.8rem;font-family:var(--font-main);outline:none;
}
.week-row input[type=date]:focus{border-color:var(--primary);}
.check-btn{
  padding:6px 10px;border:none;border-radius:var(--radius-sm);
  cursor:pointer;font-size:.8rem;font-weight:700;
  transition:all .15s;
}
.check-btn.present{background:#D1FAE5;color:#065F46;}
.check-btn.absent{background:#FEE2E2;color:#991B1B;}
.check-btn.none{background:var(--gray-100);color:var(--gray-600);}

.assign-section{
  padding:12px 14px;
  border-top:1px solid var(--gray-100);
  background:linear-gradient(135deg,#EFF6FF,#F0FDF4);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ëª¨ë‹¬
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-backdrop{
  position:fixed;inset:0;
  background:rgba(0,0,0,.45);
  z-index:200;display:none;
  align-items:flex-end;justify-content:center;
}
.modal-backdrop.open{display:flex;animation:backdropIn .2s ease;}
@keyframes backdropIn{from{opacity:0;}to{opacity:1;}}
.modal{
  width:100%;max-width:480px;max-height:90vh;
  background:#fff;border-radius:var(--radius) var(--radius) 0 0;
  overflow:hidden;display:flex;flex-direction:column;
  animation:slideUp .25s ease;
}
@keyframes slideUp{from{transform:translateY(100%);}to{transform:translateY(0);}}
.modal-header{
  padding:16px 20px;display:flex;align-items:center;justify-content:space-between;
  border-bottom:1px solid var(--gray-100);flex-shrink:0;
}
.modal-title{font-weight:700;font-size:1rem;}
.modal-close{
  width:32px;height:32px;border-radius:50%;
  border:none;background:var(--gray-100);cursor:pointer;
  font-size:1.1rem;display:flex;align-items:center;justify-content:center;
}
.modal-body{padding:20px;overflow-y:auto;flex:1;}
.modal-footer{
  padding:14px 20px;border-top:1px solid var(--gray-100);
  display:flex;gap:8px;flex-shrink:0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   í† ìŠ¤íŠ¸
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toast{
  position:fixed;bottom:90px;left:50%;transform:translateX(-50%) translateY(20px);
  background:var(--gray-800);color:#fff;
  padding:10px 22px;border-radius:50px;
  font-size:.85rem;font-weight:600;
  opacity:0;transition:all .3s;
  pointer-events:none;z-index:500;
  white-space:nowrap;
}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
.toast.success{background:var(--success);}
.toast.error{background:var(--danger);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ë¡œë”©
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.loading{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  padding:40px;gap:12px;color:var(--gray-400);
}
.spinner{
  width:36px;height:36px;
  border:3px solid var(--gray-200);
  border-top-color:var(--primary);
  border-radius:50%;
  animation:spin .7s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg);}}

.empty{
  text-align:center;padding:32px 16px;
  color:var(--gray-400);font-size:.9rem;
}
.empty-icon{font-size:2.5rem;margin-bottom:8px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ë°˜ì‘í˜• íƒœë¸”ë¦¿+
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ë¡œê·¸ì¸ í™”ë©´
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#loginScreen{
  position:fixed;inset:0;z-index:999;
  background:linear-gradient(160deg,#1E3A8A 0%,#2563EB 50%,#38BDF8 100%);
  display:none;flex-direction:column;align-items:center;justify-content:center;
  padding:32px 24px;
}
.login-card{
  width:100%;max-width:400px;
  background:rgba(255,255,255,.97);
  border-radius:24px;
  padding:36px 28px 28px;
  box-shadow:0 20px 60px rgba(0,0,0,.25);
}
.login-logo{
  text-align:center;margin-bottom:28px;
}
.login-logo .cross{
  font-size:2.8rem;margin-bottom:6px;
  animation:float 3s ease-in-out infinite;
}
@keyframes float{0%,100%{transform:translateY(0);}50%{transform:translateY(-6px);}}
.login-logo h1{
  font-family:var(--font-brand);font-size:1.3rem;font-weight:700;
  color:var(--gray-800);margin-bottom:2px;
}
.login-logo p{font-size:.8rem;color:var(--gray-400);}
.login-card .form-group{margin-bottom:16px;}

/* ì‚¬ìš©ì ì •ë³´ ì¹© (í—¤ë”) */
.user-chip{
  display:flex;align-items:center;gap:7px;
  background:rgba(255,255,255,.18);
  border:1.5px solid rgba(255,255,255,.3);
  border-radius:50px;
  padding:5px 12px 5px 6px;
  cursor:pointer;
  transition:background .2s;
  white-space:nowrap;
}
.user-chip:hover{background:rgba(255,255,255,.28);}
.user-chip .u-avatar{
  width:26px;height:26px;border-radius:50%;
  background:rgba(255,255,255,.9);
  color:var(--primary);
  display:flex;align-items:center;justify-content:center;
  font-size:.75rem;font-weight:800;
}
.user-chip .u-name{font-size:.78rem;font-weight:600;color:#fff;}
.user-chip .u-role{font-size:.65rem;color:rgba(255,255,255,.75);}

/* ê¶Œí•œë³„ ì ê¸ˆ */
.locked-banner{
  background:#FEF3C7;border:1.5px solid #FCD34D;
  border-radius:var(--radius-sm);padding:12px 14px;
  display:flex;align-items:center;gap:10px;
  margin-bottom:14px;font-size:.85rem;color:#92400E;font-weight:600;
}


/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì½œì•„ì›ƒ (ê³µì§€ì‚¬í•­ / ì‚¬ì—­ì¼ì •)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.callout{
  border-radius:var(--radius);
  margin-bottom:14px;
  overflow:hidden;
  box-shadow:var(--shadow-sm);
}
.callout-header{
  display:flex;align-items:center;justify-content:space-between;
  padding:13px 16px 11px;
  cursor:pointer;
  user-select:none;
  -webkit-tap-highlight-color:transparent;
  transition:opacity .15s;
}
.callout-header:active{opacity:.8;}
.callout-title{
  display:flex;align-items:center;gap:9px;
  font-weight:700;font-size:.95rem;
}
.callout-icon{font-size:1.15rem;}
.callout-chevron{
  font-size:.75rem;color:inherit;opacity:.7;
  transition:transform .25s;
}
.callout.open .callout-chevron{transform:rotate(180deg);}
.callout-body{
  max-height:0;overflow:hidden;
  transition:max-height .3s ease, padding .3s ease;
  padding:0 16px;
}
.callout.open .callout-body{
  max-height:3000px;
  padding:0 16px 14px;
}
/* ê³µì§€ì‚¬í•­ â€” íŒŒë€ ê³„ì—´ */
.callout-notice{
  background:linear-gradient(135deg,#EFF6FF 0%,#DBEAFE 100%);
  border:1.5px solid #BFDBFE;
}
.callout-notice .callout-header{color:#1D4ED8;}
/* ì‚¬ì—­ì¼ì • â€” ì´ˆë¡ ê³„ì—´ */
.callout-schedule{
  background:linear-gradient(135deg,#F0FDF4 0%,#DCFCE7 100%);
  border:1.5px solid #BBF7D0;
}
.callout-schedule .callout-header{color:#15803D;}

/* ê³µì§€/ì¼ì • ì•„ì´í…œ */
.notice-item{
  display:flex;align-items:flex-start;gap:10px;
  padding:10px 0;
  border-bottom:1px solid rgba(0,0,0,.06);
  font-size:.875rem;
}
.notice-item:last-child{border-bottom:none;padding-bottom:0;}
.notice-dot{
  width:7px;height:7px;border-radius:50%;
  flex-shrink:0;margin-top:5px;
}
.notice-dot-blue{background:#3B82F6;}
.notice-dot-green{background:#22C55E;}
.notice-meta{
  font-size:.72rem;font-weight:600;
  opacity:.6;margin-top:2px;
}
.notice-text{font-weight:500;line-height:1.45;color:var(--gray-800);}

/* ì¶”ê°€ ë²„íŠ¼ (callout ë‚´) */
.callout-add-btn{
  display:flex;align-items:center;gap:6px;
  width:100%;margin-top:10px;padding:8px 12px;
  background:rgba(255,255,255,.65);
  border:1.5px dashed rgba(0,0,0,.15);
  border-radius:var(--radius-sm);
  font-size:.82rem;font-weight:600;
  color:inherit;opacity:.75;cursor:pointer;
  font-family:var(--font-main);
  transition:opacity .15s,background .15s;
}
.callout-add-btn:hover{opacity:1;background:rgba(255,255,255,.85);}

/* ì…ë ¥ ì¸ë¼ì¸ í¼ */
.inline-form{
  display:none;flex-direction:column;gap:8px;
  margin-top:8px;padding:12px;
  background:rgba(255,255,255,.7);
  border-radius:var(--radius-sm);
  animation:fadeUp .2s ease;
}
.inline-form.show{display:flex;}
.inline-form input,.inline-form select{
  padding:8px 11px;
  border:1.5px solid rgba(0,0,0,.12);border-radius:var(--radius-sm);
  font-size:.85rem;font-family:var(--font-main);
  background:rgba(255,255,255,.9);outline:none;
}
.inline-form input:focus,.inline-form select:focus{border-color:rgba(0,0,0,.3);}
.inline-form-btns{display:flex;gap:6px;}
.inline-form-btns button{
  flex:1;padding:7px;border:none;border-radius:var(--radius-sm);
  font-size:.82rem;font-weight:700;font-family:var(--font-main);cursor:pointer;
}
.btn-save-inline{background:#1D4ED8;color:#fff;}
.btn-cancel-inline{background:rgba(0,0,0,.08);color:var(--gray-700);}
.callout-schedule .btn-save-inline{background:#15803D;}

/* ìƒì¼ ì›”ë³„ í•„í„° â€” ëŒ€ì‹œë³´ë“œ ë‚´ ìœ ì§€ */


/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì›”ê°„ ìº˜ë¦°ë” (ì‚¬ì—­ì¼ì •)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cal-nav{
  display:flex;align-items:center;justify-content:space-between;
  padding:10px 14px 6px;
}
.cal-nav-title{
  font-family:var(--font-brand);font-size:1rem;font-weight:700;
  color:#15803D;
}
.cal-nav-btn{
  width:30px;height:30px;border-radius:50%;border:none;
  background:rgba(21,128,61,.1);color:#15803D;
  font-size:1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;
  transition:background .15s;
}
.cal-nav-btn:hover{background:rgba(21,128,61,.2);}
.cal-grid{
  display:grid;grid-template-columns:repeat(7,1fr);
  padding:0 10px 4px;gap:2px;
}
.cal-dow{
  text-align:center;font-size:.65rem;font-weight:700;
  padding:4px 0;color:var(--gray-400);
}
.cal-dow:first-child{color:#EF4444;}
.cal-dow:last-child{color:#3B82F6;}
.cal-day{
  position:relative;
  display:flex;flex-direction:column;align-items:center;
  min-height:38px;padding:3px 1px 4px;
  border-radius:8px;cursor:default;
}
.cal-day.has-event{cursor:pointer;}
.cal-day.has-event:hover{background:rgba(21,128,61,.07);}
.cal-day.today .cal-day-num{
  background:#15803D;color:#fff;
  border-radius:50%;width:22px;height:22px;
  display:flex;align-items:center;justify-content:center;
  font-weight:800;
}
.cal-day.other-month .cal-day-num{color:var(--gray-200);}
.cal-day-num{
  font-size:.78rem;font-weight:600;color:var(--gray-700);
  line-height:22px;
}
.cal-dots{display:flex;gap:2px;flex-wrap:wrap;justify-content:center;margin-top:2px;}
.cal-dot{width:5px;height:5px;border-radius:50%;flex-shrink:0;}

/* ì¼ì • ìƒì„¸ íŒ¨ë„ */
.cal-detail{
  padding:0 14px 10px;
  display:none;
  animation:fadeUp .2s ease;
}
.cal-detail.show{display:block;}
.cal-detail-title{
  font-size:.75rem;font-weight:700;color:#15803D;
  margin-bottom:8px;padding-top:8px;
  border-top:1px solid rgba(21,128,61,.15);
}


/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì„¤êµÂ·ì†Œê·¸ë£¹ ì½œì•„ì›ƒ (êµì‚¬ìš© í™ˆ)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.callout-sermon{
  background:linear-gradient(135deg,#FDF4FF 0%,#F3E8FF 100%);
  border:1.5px solid #E9D5FF;
}
.callout-sermon .callout-header{color:#7C3AED;}
.callout-sermon .cal-nav-btn{background:rgba(124,58,237,.1);color:#7C3AED;}
.callout-sermon .cal-nav-btn:hover{background:rgba(124,58,237,.2);}
.callout-sermon .btn-save-inline{background:#7C3AED;}

/* ì„¤êµ í•„ë“œ ì¹´ë“œ */
.sermon-field{
  padding:11px 14px;
  border-bottom:1px solid rgba(124,58,237,.1);
}
.sermon-field:last-of-type{border-bottom:none;}
.sermon-field-label{
  font-size:.7rem;font-weight:800;letter-spacing:.04em;
  color:#7C3AED;text-transform:uppercase;margin-bottom:4px;
}
.sermon-field-value{
  font-size:.9rem;font-weight:500;color:var(--gray-800);
  line-height:1.6;white-space:pre-wrap;
  word-break:break-word;
  overflow-wrap:break-word;
}
.sermon-field-value.empty-val{
  color:var(--gray-400);font-style:italic;font-weight:400;
}
/* ì„¤êµ í¸ì§‘ í¼ */
.sermon-edit-form{
  padding:12px 14px;
  background:rgba(255,255,255,.6);
  display:none;
  flex-direction:column;gap:10px;
  border-top:1px dashed #E9D5FF;
  animation:fadeUp .2s ease;
}
.sermon-edit-form.show{display:flex;}
.sermon-edit-form textarea{
  width:100%;padding:9px 11px;
  border:1.5px solid #E9D5FF;border-radius:var(--radius-sm);
  font-size:.88rem;font-family:var(--font-main);
  resize:vertical;min-height:70px;outline:none;
  background:rgba(255,255,255,.9);
}
.sermon-edit-form textarea:focus{border-color:#7C3AED;}
.sermon-edit-form input{
  padding:9px 11px;
  border:1.5px solid #E9D5FF;border-radius:var(--radius-sm);
  font-size:.88rem;font-family:var(--font-main);outline:none;
  background:rgba(255,255,255,.9);
}
.sermon-edit-form input:focus{border-color:#7C3AED;}
.sermon-btn-edit{
  display:inline-flex;align-items:center;gap:5px;
  margin:8px 14px 10px;padding:7px 14px;
  background:rgba(124,58,237,.08);color:#7C3AED;
  border:1.5px dashed rgba(124,58,237,.3);
  border-radius:var(--radius-sm);
  font-size:.82rem;font-weight:700;
  font-family:var(--font-main);cursor:pointer;
  transition:background .15s;
}
.sermon-btn-edit:hover{background:rgba(124,58,237,.15);}

/* êµì‚¬ìš© í™ˆ â€” í†µê³„ ê·¸ë¦¬ë“œ ìˆ¨ê¹€ */
.teacher-home .stat-grid,
.teacher-home .section-title-birthday,
.teacher-home .month-filter,
.teacher-home #studentList{ display:none !important; }
.trend-period-btn{
  flex:1;padding:8px 4px;border:1.5px solid var(--gray-200);border-radius:50px;
  background:#fff;font-family:var(--font-main);font-size:.78rem;font-weight:700;
  color:var(--gray-500);cursor:pointer;transition:all .15s;
}
.trend-period-btn.active{background:var(--primary);color:#fff;border-color:var(--primary);}
.trend-period-btn:hover:not(.active){border-color:var(--primary);color:var(--primary);}
/* ë¸Œë¦¬í•‘ ì¹´ë“œ */
.briefing-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-bottom:12px;}
.briefing-card{background:#fff;border:1.5px solid var(--gray-200);border-radius:10px;padding:12px 14px;text-align:center;}
.briefing-card .num{font-size:1.8rem;font-weight:800;line-height:1;}
.briefing-card .lbl{font-size:.7rem;color:var(--gray-500);margin-top:4px;}
/* êµì‚¬ìš© ìƒì¼ì„¹ì…˜ì€ ë³„ë„ ë Œë”ë§ */
#teacherBirthdaySection { display:block; }

/* ê³µì§€ì‚¬í•­Â·ì‚¬ì—­ì¼ì • â€” êµì‚¬ ëª¨ë“œì—ì„œ ì¶”ê°€ ë²„íŠ¼ ìˆ¨ê¹€ */
.teacher-home .callout-add-btn,
.teacher-home .inline-form{ display:none !important; }
.teacher-home .callout-notice .callout-header,
.teacher-home .callout-schedule .callout-header{ cursor:pointer; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì •ë ¬ ë“œë¡­ë‹¤ìš´ (ìƒˆì¹œêµ¬)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sort-dropdown-wrap{
  position:relative;display:inline-block;margin-bottom:14px;
}
.sort-dropdown-btn{
  display:inline-flex;align-items:center;gap:6px;
  padding:7px 14px;border-radius:50px;
  border:1.5px solid var(--gray-200);
  background:#fff;color:var(--gray-600);
  font-size:.8rem;font-weight:600;font-family:var(--font-main);
  cursor:pointer;transition:all .18s;
  box-shadow:var(--shadow-sm);
}
.sort-dropdown-btn:hover{border-color:var(--primary);color:var(--primary);}
.sort-dropdown-btn.open{border-color:var(--primary);color:var(--primary);background:var(--primary-lt);}
.sort-arrow{font-size:.65rem;transition:transform .2s;}
.sort-dropdown-btn.open .sort-arrow{transform:rotate(180deg);}
.sort-menu{
  position:absolute;top:calc(100% + 6px);left:0;
  background:#fff;border:1.5px solid var(--gray-200);
  border-radius:var(--radius-sm);
  box-shadow:var(--shadow-md);
  min-width:170px;z-index:50;
  overflow:hidden;
  display:none;
  animation:fadeUp .15s ease;
}
.sort-menu.open{display:block;}
.sort-group-label{
  padding:7px 14px 4px;
  font-size:.68rem;font-weight:800;letter-spacing:.06em;
  color:var(--gray-400);text-transform:uppercase;
  background:var(--gray-50);
  border-bottom:1px solid var(--gray-100);
}
.sort-group-label:not(:first-child){border-top:1px solid var(--gray-100);}
.sort-menu-item{
  display:flex;align-items:center;gap:8px;
  padding:9px 14px;
  font-size:.83rem;font-weight:500;font-family:var(--font-main);
  cursor:pointer;color:var(--gray-700);
  transition:background .12s;
  background:none;border:none;width:100%;text-align:left;
}
.sort-menu-item:hover{background:var(--primary-lt);color:var(--primary);}
.sort-menu-item.active{color:var(--primary);font-weight:700;background:var(--primary-lt);}
.sort-dir-icon{font-size:.8rem;opacity:.6;}
.sort-check{font-size:.72rem;margin-left:auto;opacity:0;color:var(--primary);}
.sort-menu-item.active .sort-check{opacity:1;}

/* mm.dd ë‚ ì§œ ì…ë ¥ */
.mmdd-input{
  width:100%;padding:6px 8px;
  border:1.5px solid var(--gray-200);border-radius:var(--radius-sm);
  font-size:.82rem;font-family:var(--font-main);outline:none;
  text-align:center;letter-spacing:.05em;
}
.mmdd-input:focus{border-color:var(--primary);}
.mmdd-input::placeholder{color:var(--gray-400);}

@media(min-width:600px){
  .view{padding:20px;max-width:680px;margin:0 auto;}
  .stat-grid{grid-template-columns:repeat(4,1fr);}
  .week-grid{grid-template-columns:repeat(4,1fr);}
}
</style>
</head>
<body>

<!-- â”€â”€â”€ ë¡œê·¸ì¸ í™”ë©´ â”€â”€â”€ -->
<div id="loginScreen">
  <div class="login-card">
    <div class="login-logo">
      <div class="cross">âœï¸</div>
      <h1>ë“œë¦¼í‹´ì¦ˆ êµì ê´€ë¦¬</h1>
      <p id="loginSubtitle">ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”</p>
    </div>

    <!-- STEP 1: ì´ë¦„ ì…ë ¥ -->
    <div id="loginStep1">
      <div class="form-group">
        <label class="form-label">ì´ë¦„ (ì•„ì´ë””)</label>
        <input class="form-control" id="loginName" placeholder="ì˜ˆ) ê¹€ì„ ìƒ" autocomplete="off"
          style="font-size:1rem;" onkeydown="if(event.key==='Enter')checkLoginName()">
      </div>
      <button class="btn btn-primary btn-full" onclick="checkLoginName()" style="padding:13px;font-size:1rem;">
        ë‹¤ìŒ â†’
      </button>
    </div>

    <!-- STEP 2: ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ (ì „ì²´ ì‚¬ìš©ì ê³µí†µ) -->
    <div id="loginStep2" style="display:none;">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:16px;padding:10px 14px;background:var(--primary-lt);border-radius:8px;">
        <div style="width:36px;height:36px;background:var(--primary);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:1rem;" id="loginAvatar">?</div>
        <div>
          <div style="font-weight:700;font-size:.95rem;" id="loginNameDisplay"></div>
          <div style="font-size:.75rem;color:var(--gray-500);" id="loginRoleHint"></div>
        </div>
        <button onclick="backToStep1()" style="margin-left:auto;background:none;border:none;color:var(--gray-400);cursor:pointer;font-size:.8rem;padding:4px 6px;">âœ•</button>
      </div>
      <div class="form-group">
        <label class="form-label">ë¹„ë°€ë²ˆí˜¸ <span style="font-size:.72rem;color:var(--gray-400);">(ì´ˆê¸°: 1234)</span></label>
        <div style="position:relative;">
          <input class="form-control" id="loginPw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"
            style="font-size:1rem;padding-right:44px;"
            onkeydown="if(event.key==='Enter')doLoginWithPw()">
          <button onclick="togglePwVisible()" id="pwToggleBtn"
            style="position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;font-size:.9rem;color:var(--gray-400);">ğŸ‘</button>
        </div>
      </div>
      <button class="btn btn-primary btn-full" onclick="doLoginWithPw()" style="padding:13px;font-size:1rem;">
        ë¡œê·¸ì¸ â†’
      </button>
    </div>

    <div id="loginError" style="display:none;color:var(--danger);font-size:.82rem;margin-top:12px;padding:8px 12px;background:#FEE2E2;border-radius:8px;"></div>
  </div>
</div>


<!-- â”€â”€â”€ í—¤ë” â”€â”€â”€ -->
<header>
  <div class="header-top">
    <div class="brand" onclick="goHome()" style="cursor:pointer;user-select:none;">
      <span class="brand-icon">âœï¸</span> ë“œë¦¼í‹´ì¦ˆ êµì ê´€ë¦¬
    </div>
    <div class="user-chip" id="userChip" title="ë©”ë‰´">
      <div class="u-avatar" id="userAvatar" onclick="doLogout()" title="ë¡œê·¸ì•„ì›ƒ">?</div>
      <div onclick="doLogout()" title="ë¡œê·¸ì•„ì›ƒ">
        <div class="u-name" id="userName">-</div>
        <div class="u-role" id="userRoleBadge">-</div>
      </div>
      <button id="changePwBtn" onclick="openChangePwModal()" title="ë¹„ë°€ë²ˆí˜¸ ë³€ê²½"
        style="display:none;margin-left:6px;background:rgba(255,255,255,.2);border:none;border-radius:6px;padding:4px 7px;cursor:pointer;font-size:.75rem;color:#fff;align-items:center;gap:3px;white-space:nowrap;">
        ğŸ”‘ PW
      </button>
    </div>
  </div>
  <!-- ê²€ìƒ‰ì°½: ë¸Œëœë“œ íƒ€ì´í‹€ ì•„ë˜ ì „ì²´ ë„ˆë¹„ -->
  <div class="header-search-wrap" id="searchWrap">
    <div class="header-search">
      <span style="font-size:1rem;">ğŸ”</span>
      <input type="text" id="globalSearch" placeholder="ì´ë¦„, ì—°ë½ì²˜ë¡œ ê²€ìƒ‰..." autocomplete="off">
      <button class="search-clear-btn" id="searchClearBtn" onclick="clearSearch()">âœ•</button>
    </div>
    <div class="search-dropdown" id="searchDropdown"></div>
  </div>
</header>

<!-- â”€â”€â”€ ë·° ì˜ì—­ â”€â”€â”€ -->
<main>

  <!-- ê²€ìƒ‰ ê²°ê³¼ í™”ë©´ -->
  <section class="view" id="view-search">
    <div style="display:flex;align-items:center;gap:10px;margin-bottom:14px;">
      <button class="btn btn-outline btn-sm" onclick="exitSearchPage()" style="padding:6px 12px;">â† ë’¤ë¡œ</button>
      <div style="flex:1;font-size:.9rem;font-weight:700;color:var(--gray-700);" id="searchPageTitle">ê²€ìƒ‰ ê²°ê³¼</div>
    </div>
    <div id="searchPageContent"></div>
  </section>

  <!-- ëŒ€ì‹œë³´ë“œ -->
  <section class="view active" id="view-dashboard">

    <!-- í†µê³„ ì¹´ë“œ -->
    <div class="stat-grid" id="statsGrid" style="grid-template-columns:repeat(3,1fr);">
      <div class="stat-card"><div class="stat-num" id="statTotal">-</div><div class="stat-label">ì „ì²´ í•™ìƒ</div></div>
      <div class="stat-card" onclick="showStatusList('ë“±ë¡')" style="cursor:pointer;" title="ë“±ë¡ í•™ìƒ ë³´ê¸°"><div class="stat-num" id="statActive" style="color:var(--success);">-</div><div class="stat-label">ë“±ë¡ â€º</div></div>
      <div class="stat-card" onclick="showStatusList('ìƒˆì¹œêµ¬')" style="cursor:pointer;" title="ìƒˆì¹œêµ¬ ë³´ê¸°"><div class="stat-num" id="statNewbie" style="color:var(--accent);">-</div><div class="stat-label">ìƒˆì¹œêµ¬ â€º</div></div>
      <div class="stat-card" onclick="showStatusList('ì¥ê²°ì')" style="cursor:pointer;" title="ì¥ê²°ì ë³´ê¸°"><div class="stat-num" id="statAbsent" style="color:var(--danger);">-</div><div class="stat-label">ì¥ê²°ì â€º</div></div>
      <div class="stat-card" onclick="showStatusList('ìœ í•™ìƒ')" style="cursor:pointer;" title="ìœ í•™ìƒ ë³´ê¸°"><div class="stat-num" id="statStudy" style="color:#0EA5E9;">-</div><div class="stat-label">ìœ í•™ìƒ â€º</div></div>
      <div class="stat-card"><div class="stat-num" id="statTeacher" style="color:#7C3AED;">-</div><div class="stat-label">êµì‚¬</div></div>
    </div>

    <!-- ê³µì§€ì‚¬í•­ ì½œì•„ì›ƒ -->
    <div class="callout callout-notice open" id="calloutNotice">
      <div class="callout-header" onclick="toggleCallout('calloutNotice')">
        <div class="callout-title">
          <span class="callout-icon">ğŸ“¢</span>
          <span>ê³µì§€ì‚¬í•­</span>
          <span class="badge badge-blue" id="noticeBadge" style="font-size:.65rem;">0</span>
        </div>
        <span class="callout-chevron">â–¼</span>
      </div>
      <div class="callout-body">
        <div id="noticeList"></div>
        <button class="callout-add-btn" onclick="openInlineForm('noticeForm')">ï¼‹ ê³µì§€ ì¶”ê°€</button>
        <div class="inline-form" id="noticeForm">
          <input type="text" id="noticeInput" placeholder="ê³µì§€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”">
          <input type="date" id="noticeDate">
          <div class="inline-form-btns">
            <button class="btn-cancel-inline" onclick="closeInlineForm('noticeForm')">ì·¨ì†Œ</button>
            <button class="btn-save-inline" onclick="addNotice()">ì €ì¥</button>
          </div>
        </div>
      </div>
    </div>

    <!-- â–  ì„¤êµÂ·ì†Œê·¸ë£¹ ì½œì•„ì›ƒ (êµì‚¬ìš© í™ˆ ì „ìš©) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="callout callout-sermon open" id="calloutSermon">
      <div class="callout-header" onclick="toggleCallout('calloutSermon')">
        <div class="callout-title">
          <span class="callout-icon">âœï¸</span>
          <span>ì´ë²ˆ ì£¼ ë§ì”€Â·ì†Œê·¸ë£¹</span>
        </div>
        <span class="callout-chevron">â–¼</span>
      </div>
      <div class="callout-body" style="padding:0;">

        <!-- ì£¼ì¼ ë‚ ì§œ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="cal-nav" style="padding-bottom:8px;border-bottom:1px solid rgba(124,58,237,.1);">
          <button class="cal-nav-btn" onclick="changeSermonWeek(-1)">â€¹</button>
          <div class="cal-nav-title" id="sermonWeekTitle" style="color:#7C3AED;">-</div>
          <button class="cal-nav-btn" onclick="changeSermonWeek(1)">â€º</button>
        </div>

        <!-- ì„¤êµ ì •ë³´ í‘œì‹œ -->
        <div id="sermonDisplay">
          <div class="sermon-field">
            <div class="sermon-field-label">ğŸ“– ë³¸ë¬¸</div>
            <div class="sermon-field-value empty-val" id="sfPassage">ë“±ë¡ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤</div>
          </div>
          <div class="sermon-field">
            <div class="sermon-field-label">ğŸ™ ì„¤êµ ì œëª©</div>
            <div class="sermon-field-value empty-val" id="sfTitle">ë“±ë¡ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤</div>
          </div>
          <div class="sermon-field" style="border-bottom:none;">
            <div class="sermon-field-label">ğŸ’¬ ë‚´ìš© &amp; ë‚˜ëˆ” ì§ˆë¬¸</div>
            <div class="sermon-field-value empty-val" id="sfGroup">ë“±ë¡ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤</div>
          </div>
        </div>

        <!-- í¸ì§‘ ë²„íŠ¼ (ê´€ë¦¬ìë§Œ ë…¸ì¶œ) -->
        <button class="sermon-btn-edit" id="sermonEditBtn" onclick="toggleSermonEdit()" style="display:none;">
          âœï¸ ë‚´ìš© í¸ì§‘
        </button>

        <!-- í¸ì§‘ í¼ -->
        <div class="sermon-edit-form" id="sermonEditForm">
          <div>
            <div class="sermon-field-label" style="margin-bottom:5px;">ğŸ“– ë³¸ë¬¸</div>
            <input type="text" id="sePassage" placeholder="ì˜ˆ) ìš”í•œë³µìŒ 3:16">
          </div>
          <div>
            <div class="sermon-field-label" style="margin-bottom:5px;">ğŸ™ ì„¤êµ ì œëª©</div>
            <input type="text" id="seTitle" placeholder="ì˜ˆ) í•˜ë‚˜ë‹˜ì˜ ì‚¬ë‘">
          </div>
          <div>
            <div class="sermon-field-label" style="margin-bottom:5px;">ğŸ’¬ ë‚´ìš© &amp; ë‚˜ëˆ” ì§ˆë¬¸</div>
            <textarea id="seGroup" placeholder="ì„¤êµ ë‚´ìš© ìš”ì•½ ë° ì†Œê·¸ë£¹ ë‚˜ëˆ” ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”&#10;(ì¤„ë°”ê¿ˆ ê°€ëŠ¥)"></textarea>
          </div>
          <div class="inline-form-btns">
            <button class="btn-cancel-inline" onclick="toggleSermonEdit()">ì·¨ì†Œ</button>
            <button class="btn-save-inline" onclick="saveSermon()" style="background:#7C3AED;color:#fff;">ì €ì¥</button>
          </div>
        </div>

      </div>
    </div>

    <!-- ì‚¬ì—­ì¼ì • ì½œì•„ì›ƒ -->
    <div class="callout callout-schedule open" id="calloutSchedule">
      <div class="callout-header" onclick="toggleCallout('calloutSchedule')">
        <div class="callout-title">
          <span class="callout-icon">ğŸ“…</span>
          <span>ì‚¬ì—­ì¼ì •</span>
          <span class="badge badge-green" id="scheduleBadge" style="font-size:.65rem;">0</span>
        </div>
        <span class="callout-chevron">â–¼</span>
      </div>
      <div class="callout-body" style="padding-left:0;padding-right:0;">

        <!-- ì›” ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="cal-nav">
          <button class="cal-nav-btn" onclick="changeCalMonth(-1)">â€¹</button>
          <div class="cal-nav-title" id="calMonthTitle">-</div>
          <button class="cal-nav-btn" onclick="changeCalMonth(1)">â€º</button>
        </div>

        <!-- ìš”ì¼ í—¤ë” + ë‚ ì§œ ê·¸ë¦¬ë“œ -->
        <div class="cal-grid" id="calDowRow">
          <div class="cal-dow">ì¼</div><div class="cal-dow">ì›”</div>
          <div class="cal-dow">í™”</div><div class="cal-dow">ìˆ˜</div>
          <div class="cal-dow">ëª©</div><div class="cal-dow">ê¸ˆ</div>
          <div class="cal-dow">í† </div>
        </div>
        <div class="cal-grid" id="calDayGrid"></div>

        <!-- í´ë¦­í•œ ë‚  ì¼ì • ìƒì„¸ -->
        <div class="cal-detail" id="calDetail">
          <div class="cal-detail-title" id="calDetailTitle"></div>
          <div id="calDetailList"></div>
        </div>

        <!-- ì¼ì • ì¶”ê°€ ë²„íŠ¼ & ì¸ë¼ì¸ í¼ -->
        <div style="padding:6px 14px 0;">
          <button class="callout-add-btn" onclick="openInlineForm('scheduleForm')">ï¼‹ ì¼ì • ì¶”ê°€</button>
          <div class="inline-form" id="scheduleForm">
            <input type="text" id="scheduleInput" placeholder="ì¼ì • ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”">
            <input type="date" id="scheduleDate">
            <select id="scheduleCategory">
              <option value="ì˜ˆë°°">ì˜ˆë°°</option>
              <option value="í–‰ì‚¬">í–‰ì‚¬</option>
              <option value="êµì‚¬ëª¨ì„">êµì‚¬ëª¨ì„</option>
              <option value="íŠ¹ë³„í™œë™">íŠ¹ë³„í™œë™</option>
              <option value="ê¸°íƒ€">ê¸°íƒ€</option>
            </select>
            <div class="inline-form-btns">
              <button class="btn-cancel-inline" onclick="closeInlineForm('scheduleForm')">ì·¨ì†Œ</button>
              <button class="btn-save-inline" onclick="addSchedule()" style="background:#15803D;color:#fff;">ì €ì¥</button>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- ìƒì¼ ì›”ë³„ í•„í„° -->
    <div class="section-title section-title-birthday"
         onclick="toggleBirthdaySection()"
         style="cursor:pointer;display:flex;align-items:center;justify-content:space-between;">
      <span>ğŸ‚ ì´ë‹¬ì˜ ìƒì¼</span>
      <span id="birthdayChevron" style="font-size:.8rem;transition:transform .25s;">â–¼</span>
    </div>
    <div id="birthdayCollapsible" style="overflow:visible;transition:max-height .3s ease;max-height:3000px;" id="birthdayCollapsibleInner">
    <div class="month-filter" id="monthFilter">
      <button class="month-btn active" data-month="0">ì „ì²´</button>
      <button class="month-btn" data-month="1">1ì›”</button><button class="month-btn" data-month="2">2ì›”</button>
      <button class="month-btn" data-month="3">3ì›”</button><button class="month-btn" data-month="4">4ì›”</button>
      <button class="month-btn" data-month="5">5ì›”</button><button class="month-btn" data-month="6">6ì›”</button>
      <button class="month-btn" data-month="7">7ì›”</button><button class="month-btn" data-month="8">8ì›”</button>
      <button class="month-btn" data-month="9">9ì›”</button><button class="month-btn" data-month="10">10ì›”</button>
      <button class="month-btn" data-month="11">11ì›”</button><button class="month-btn" data-month="12">12ì›”</button>
    </div>
    <div id="studentList"></div>
    </div><!-- /birthdayCollapsible -->


  </section>

  <!-- ì •ê·œ ì¶œì„ -->
  <section class="view" id="view-attendance">
    <!-- êµì—­ììš© ì£¼ì°¨ë³„ ì¶œì„ í†µê³„ (adminë§Œ) -->
    <div id="attStatsPanel" style="display:none;margin-bottom:14px;">
      <div class="callout callout-notice" id="attStatsCallout">
        <div class="callout-header" onclick="toggleCallout('attStatsCallout')" style="padding:10px 14px;">
          <div class="callout-title" style="font-size:.85rem;"><span class="callout-icon">ğŸ“Š</span><span>ì£¼ì°¨ë³„ ì¶œì„ í˜„í™©</span></div>
          <span class="callout-chevron">â–¼</span>
        </div>
        <div class="callout-body" id="attStatsList" style="padding:0 0 8px;"></div>
      </div>
    </div>
    <div class="att-header">
      <select class="form-control" id="attClass" style="flex:1.2">
        <option value="">ë°˜ ì„ íƒ</option>
      </select>
      <select class="form-control" id="attDate" style="flex:1.5">
        <option value="">ë‚ ì§œ ì„ íƒ</option>
      </select>
    </div>
    <div id="attDateBanner" style="display:none;
         background:linear-gradient(135deg,var(--primary-lt),#E0F2FE);
         border:1.5px solid #BAE6FD;
         border-radius:var(--radius-sm);
         padding:10px 14px;margin-bottom:12px;
         display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.1rem;">ğŸ“…</span>
      <div>
        <div style="font-size:.72rem;font-weight:700;color:var(--primary);margin-bottom:1px;">ì¶œì„ ì¼ì ìë™ ì„ íƒë¨</div>
        <div style="font-size:.9rem;font-weight:700;color:var(--gray-800);" id="attDateLabel">-</div>
      </div>
      <div style="margin-left:auto;font-size:.72rem;color:var(--gray-600);">ë‚ ì§œ ë³€ê²½ ê°€ëŠ¥ â†‘</div>
    </div>
    <div id="attList"></div>
    <div id="attSaveArea" style="display:none;margin-top:12px;">
      <button class="btn btn-primary btn-full" onclick="saveAttendance()">ğŸ’¾ ì¶œì„ ì €ì¥</button>
    </div>
  </section>

  <!-- ìƒˆì¹œêµ¬ ê´€ë¦¬ -->
  <section class="view" id="view-newbie">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
      <div class="section-title" style="margin-bottom:0;">ğŸŒ± ìƒˆì¹œêµ¬ ì¶œì„</div>
      <div style="display:flex;gap:6px;">
        <button class="btn btn-outline btn-sm" onclick="syncFormNewbies()" id="syncBtn" title="ìƒˆì¹œêµ¬ ëª©ë¡ ìƒˆë¡œê³ ì¹¨">
          ğŸ”„ ìƒˆì¹œêµ¬ ìƒˆë¡œê³ ì¹¨
        </button>
        <button class="btn btn-primary btn-sm" onclick="openAddStudentModal(true)">+ ì§ì ‘ ë“±ë¡</button>
      </div>
    </div>

    <!-- ì •ë ¬ ë“œë¡­ë‹¤ìš´ -->
    <div class="sort-dropdown-wrap" id="sortDropdownWrap">
      <button class="sort-dropdown-btn" id="sortDropdownBtn" onclick="toggleSortMenu()">
        <span>ğŸ”ƒ ì •ë ¬</span>
        <span id="sortLabel" style="color:var(--primary);">ì´ë¦„ â†‘ ì˜¤ë¦„ì°¨ìˆœ</span>
        <span class="sort-arrow">â–¼</span>
      </button>
      <div class="sort-menu" id="sortMenu">
        <div class="sort-group-label">ì´ë¦„</div>
        <button class="sort-menu-item active" data-sort="name_asc" onclick="setNewbieSort('name_asc')">
          <span class="sort-dir-icon">â†‘</span> ì˜¤ë¦„ì°¨ìˆœ (ã„±â†’ã…)
          <span class="sort-check">âœ“</span>
        </button>
        <button class="sort-menu-item" data-sort="name_desc" onclick="setNewbieSort('name_desc')">
          <span class="sort-dir-icon">â†“</span> ë‚´ë¦¼ì°¨ìˆœ (ã…â†’ã„±)
          <span class="sort-check">âœ“</span>
        </button>
        <div class="sort-group-label">ë‚˜ì´</div>
        <button class="sort-menu-item" data-sort="age_asc" onclick="setNewbieSort('age_asc')">
          <span class="sort-dir-icon">â†‘</span> ì–´ë¦° ìˆœ
          <span class="sort-check">âœ“</span>
        </button>
        <button class="sort-menu-item" data-sort="age_desc" onclick="setNewbieSort('age_desc')">
          <span class="sort-dir-icon">â†“</span> ë§ì€ ìˆœ
          <span class="sort-check">âœ“</span>
        </button>
        <div class="sort-group-label">ì¶œì„ì£¼ì°¨</div>
        <button class="sort-menu-item" data-sort="weeks_asc" onclick="setNewbieSort('weeks_asc')">
          <span class="sort-dir-icon">â†‘</span> ì ì€ ìˆœ
          <span class="sort-check">âœ“</span>
        </button>
        <button class="sort-menu-item" data-sort="weeks_desc" onclick="setNewbieSort('weeks_desc')">
          <span class="sort-dir-icon">â†“</span> ë§ì€ ìˆœ
          <span class="sort-check">âœ“</span>
        </button>
        <div class="sort-group-label">ë“±ë¡ë‚ ì§œ</div>
        <button class="sort-menu-item" data-sort="date_desc" onclick="setNewbieSort('date_desc')">
          <span class="sort-dir-icon">â†“</span> ìµœì‹  ìˆœ (ê¸°ë³¸)
          <span class="sort-check" id="nbschk_date_desc">âœ“</span>
        </button>
        <button class="sort-menu-item" data-sort="date_asc" onclick="setNewbieSort('date_asc')">
          <span class="sort-dir-icon">â†‘</span> ì˜¤ë˜ëœ ìˆœ
          <span class="sort-check" id="nbschk_date_asc">âœ“</span>
        </button>
      </div>
    </div>

    <div id="newbieList"></div>
  </section>

  <!-- ì¶œì„í˜„í™© -->
  <section class="view" id="view-attstat">
    <!-- êµì—­ì: í•™ìƒ/êµì‚¬ íƒ­ ì„ íƒ -->
    <div id="attstatTabBar" style="display:none;margin-bottom:12px;background:var(--gray-100);padding:3px;border-radius:50px;display:flex;gap:4px;">
      <button class="sort-tab active" id="attstatTabStudent" onclick="setAttstatMode('student')" style="flex:1;border-radius:50px;font-size:.8rem;">ğŸ‘¨â€ğŸ“ í•™ìƒ ì¶œì„í˜„í™©</button>
      <button class="sort-tab" id="attstatTabTeacher" onclick="setAttstatMode('teacher')" style="flex:1;border-radius:50px;font-size:.8rem;">ğŸ‘¨â€ğŸ« êµì‚¬ ì¶œì„í˜„í™©</button>
    </div>
    <!-- ë°˜ ì„ íƒ (êµì—­ìÂ·êµì‚¬ìš©) -->
    <div id="attstatClassBar" style="display:none;margin-bottom:10px;">
      <select class="form-control" id="attstatClass" onchange="renderAttstatTable()" style="font-size:.85rem;">
        <option value="">ë°˜ ì„ íƒ</option>
      </select>
    </div>
    <!-- êµì—­ì ë¸Œë¦¬í•‘ íŒ¨ë„ (adminë§Œ) -->
    <div id="weeklyBriefingPanel" style="display:none;margin-bottom:12px;"></div>

    <!-- í…Œì´ë¸” ì˜ì—­ -->
    <div id="attstatContent" style="overflow-x:auto;">
      <div class="empty" style="padding:40px 0;"><div class="empty-icon">ğŸ“Š</div>ì¶œì„í˜„í™©ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
    </div>
  </section>

  <!-- ì¶œì„ ì¶”ì´ íŒì—… -->
  <div id="trendPopup" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:2000;align-items:flex-end;justify-content:center;">
    <div style="background:#fff;border-radius:20px 20px 0 0;width:100%;max-width:520px;max-height:90vh;overflow-y:auto;padding:22px 18px 32px;">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
        <div style="font-size:1rem;font-weight:800;color:var(--gray-800);">ğŸ“Š ì¶œì„ ì¶”ì´ ë¶„ì„</div>
        <button onclick="closeTrendPopup()" style="background:var(--gray-100);border:none;border-radius:50%;width:30px;height:30px;cursor:pointer;font-size:1rem;">âœ•</button>
      </div>
      <!-- ê¸°ê°„ ì„ íƒ -->
      <div style="display:flex;gap:6px;margin-bottom:14px;" id="trendPeriodBtns">
        <button class="trend-period-btn active" data-months="1" onclick="loadTrend(1)">1ê°œì›”</button>
        <button class="trend-period-btn" data-months="3" onclick="loadTrend(3)">3ê°œì›”</button>
        <button class="trend-period-btn" data-months="6" onclick="loadTrend(6)">6ê°œì›”</button>
        <button class="trend-period-btn" data-months="12" onclick="loadTrend(12)">1ë…„</button>
      </div>
      <div id="trendContent">
        <div class="loading"><div class="spinner"></div><span>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span></div>
      </div>
    </div>
  </div>

  <!-- êµì  ê´€ë¦¬ -->
  <section class="view" id="view-records">
    <div style="display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap;">
      <button class="btn btn-primary" onclick="openAddStudentModal(false)">+ í•™ìƒ ë“±ë¡</button>
      <button class="btn btn-outline" onclick="openAddTeacherModal()">+ êµì‚¬ ë“±ë¡</button>
    </div>
    <!-- íƒ­ ì „í™˜ -->
    <div style="display:flex;gap:4px;margin-bottom:12px;background:var(--gray-100);padding:3px;border-radius:50px;">
      <button class="sort-tab active" id="recTabStudents" onclick="switchRecordTab('students')" style="flex:1;border-radius:50px;">ğŸ“š í•™ìƒ êµì </button>
      <button class="sort-tab" id="recTabTeachers" onclick="switchRecordTab('teachers')" style="flex:1;border-radius:50px;">ğŸ‘¨â€ğŸ« êµì‚¬ êµì </button>
    </div>
    <!-- í•™ìƒ êµì  í•„í„° -->
    <div id="recFilterBar" style="margin-bottom:10px;">
      <!-- ë³´ê¸° ëª¨ë“œ ë²„íŠ¼ -->
      <div style="display:flex;gap:4px;margin-bottom:8px;">
        <button class="sort-tab active" id="recViewAll"    onclick="setRecViewMode('all')"    style="font-size:.75rem;padding:5px 12px;border-radius:50px;">ì „ì²´</button>
        <button class="sort-tab"        id="recViewGrade"  onclick="setRecViewMode('grade')"  style="font-size:.75rem;padding:5px 12px;border-radius:50px;">í•™ë…„ë³„</button>
        <button class="sort-tab"        id="recViewStatus" onclick="setRecViewMode('status')" style="font-size:.75rem;padding:5px 12px;border-radius:50px;">ìƒíƒœë³„</button>
      </div>
      <!-- í•™ë…„ ì„ íƒ (í•™ë…„ë³„ ëª¨ë“œì¼ ë•Œ) -->
      <div id="recGradeFilter" style="display:none;flex-wrap:wrap;gap:5px;margin-bottom:6px;">
        <span style="font-size:.72rem;color:var(--gray-400);align-self:center;margin-right:2px;">í•™ë…„</span>
        <button class="filter-tag" onclick="toggleGradeFilter('ì´ˆ6')" id="fg_ì´ˆ6">ì´ˆ6</button>
        <button class="filter-tag" onclick="toggleGradeFilter('ì¤‘1')" id="fg_ì¤‘1">ì¤‘1</button>
        <button class="filter-tag" onclick="toggleGradeFilter('ì¤‘2')" id="fg_ì¤‘2">ì¤‘2</button>
        <button class="filter-tag" onclick="toggleGradeFilter('ì¤‘3')" id="fg_ì¤‘3">ì¤‘3</button>
        <button class="filter-tag" onclick="toggleGradeFilter('ê³ 1')" id="fg_ê³ 1">ê³ 1</button>
        <button class="filter-tag" onclick="toggleGradeFilter('ê³ 2')" id="fg_ê³ 2">ê³ 2</button>
        <button class="filter-tag" onclick="toggleGradeFilter('ê³ 3')" id="fg_ê³ 3">ê³ 3</button>
        <button class="filter-tag" onclick="toggleGradeFilter('ì˜ì–´ë°˜')" id="fg_ì˜ì–´ë°˜">ì˜ì–´ë°˜</button>
      </div>
      <!-- ìƒíƒœ ì„ íƒ (ìƒíƒœë³„ ëª¨ë“œì¼ ë•Œ) -->
      <div id="recStatusFilter" style="display:none;flex-wrap:wrap;gap:5px;margin-bottom:6px;">
        <span style="font-size:.72rem;color:var(--gray-400);align-self:center;margin-right:2px;">ìƒíƒœ</span>
        <button class="filter-tag" onclick="toggleStatusFilter('ë“±ë¡')" id="fs_ë“±ë¡">ë“±ë¡</button>
        <button class="filter-tag" onclick="toggleStatusFilter('ìƒˆì¹œêµ¬')" id="fs_ìƒˆì¹œêµ¬">ìƒˆì¹œêµ¬</button>
        <button class="filter-tag" onclick="toggleStatusFilter('ì‹¬ë°©í•„ìš”')" id="fs_ì‹¬ë°©í•„ìš”">ì‹¬ë°©í•„ìš”</button>
        <button class="filter-tag" onclick="toggleStatusFilter('ì¥ê²°ì')" id="fs_ì¥ê²°ì">ì¥ê²°ì</button>
        <button class="filter-tag" onclick="toggleStatusFilter('ìœ í•™ì¤‘')" id="fs_ìœ í•™ì¤‘">ìœ í•™ì¤‘</button>
      </div>
    </div>
    <!-- í•™ìƒ êµì  ì •ë ¬ -->
    <div id="recSortBar" style="display:flex;align-items:center;gap:8px;margin-bottom:10px;">
      <span style="font-size:.75rem;color:var(--gray-400);flex-shrink:0;">ì •ë ¬</span>
      <div class="sort-dropdown-wrap" id="recSortWrap">
        <button class="sort-dropdown-btn" id="recSortBtn" onclick="toggleRecSortMenu()">
          ğŸ”ƒ <span id="recSortLabel">í•™ë…„-ë°˜ìˆœ</span> â–¼
        </button>
        <div class="sort-menu" id="recSortMenu" style="display:none;">
          <div class="sort-group-label">ì´ë¦„</div>
          <div class="sort-menu-item" onclick="setRecSort('name_asc')">â†‘ ì˜¤ë¦„ì°¨ìˆœ (ã„±â†’ã…) <span class="sort-check" id="rschk_name_asc">âœ“</span></div>
          <div class="sort-menu-item" onclick="setRecSort('name_desc')">â†“ ë‚´ë¦¼ì°¨ìˆœ (ã…â†’ã„±) <span class="sort-check" id="rschk_name_desc">âœ“</span></div>
          <div class="sort-group-label">ë‚˜ì´</div>
          <div class="sort-menu-item" onclick="setRecSort('age_asc')">â†‘ ì–´ë¦° ìˆœ <span class="sort-check" id="rschk_age_asc">âœ“</span></div>
          <div class="sort-menu-item" onclick="setRecSort('age_desc')">â†“ ë§ì€ ìˆœ <span class="sort-check" id="rschk_age_desc">âœ“</span></div>
          <div class="sort-group-label">ê¸°íƒ€</div>
          <div class="sort-menu-item" onclick="setRecSort('status')">ìƒíƒœë³„ <span class="sort-check" id="rschk_status">âœ“</span></div>
          <div class="sort-menu-item" onclick="setRecSort('class')">í•™ë…„-ë°˜ë³„ <span class="sort-check" id="rschk_class">âœ“</span></div>
        </div>
      </div>
    </div>
    <div id="recordStudentList"></div>
    <div id="recordTeacherList" style="display:none;"></div>
  </section>

</main>

<!-- â”€â”€â”€ í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ â”€â”€â”€ -->
<nav class="bottom-nav">
  <button class="nav-btn active" data-view="dashboard">
    <span class="icon">ğŸ </span>í™ˆ
  </button>
  <button class="nav-btn" data-view="attendance">
    <span class="icon">âœ…</span>ì¶œì„ì²´í¬
  </button>
  <button class="nav-btn" data-view="attstat">
    <span class="icon">ğŸ“Š</span>ì¶œì„í˜„í™©
  </button>
  <button class="nav-btn" data-view="newbie">
    <span class="icon">ğŸŒ±</span>ìƒˆì¹œêµ¬
  </button>
  <button class="nav-btn" data-view="records">
    <span class="icon">ğŸ“‹</span>êµì 
  </button>
</nav>

<!-- â”€â”€â”€ í•™ìƒ ë“±ë¡/ìˆ˜ì • ëª¨ë‹¬ â”€â”€â”€ -->
<div class="modal-backdrop" id="studentModal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" id="studentModalTitle">í•™ìƒ ë“±ë¡</div>
      <button class="modal-close" onclick="closeModal('studentModal')">âœ•</button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="sId">
      <div class="form-group">
        <label class="form-label">ì´ë¦„ *</label>
        <input class="form-control" id="sName" placeholder="í™ê¸¸ë™">
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
        <div class="form-group">
          <label class="form-label">ì„±ë³„</label>
          <select class="form-control" id="sGender">
            <option value="ë‚¨">ë‚¨</option><option value="ì—¬">ì—¬</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">ë‚˜ì´ (ë§Œ ë‚˜ì´)</label>
          <div style="display:flex;gap:8px;align-items:center;">
            <input class="form-control" id="sKorAge" type="text" placeholder="í•œêµ­ ë‚˜ì´" readonly
              style="background:var(--gray-50);color:var(--gray-800);cursor:default;font-weight:700;text-align:center;flex:1;">
            <span style="font-size:.75rem;color:var(--gray-400);flex-shrink:0;">ë§Œ</span>
            <input class="form-control" id="sAge" type="text" placeholder="ë§Œ ë‚˜ì´" readonly
              style="background:var(--gray-50);color:var(--gray-600);cursor:default;text-align:center;flex:1;">
          </div>
          <div id="ageHint" style="font-size:.72rem;color:var(--gray-400);margin-top:4px;display:none;">
            ğŸ‡°ğŸ‡· í•œêµ­ ë‚˜ì´ <strong id="ageKorDisplay"></strong>ì„¸ Â· ë§Œ <strong id="ageIntDisplay"></strong>ì„¸
          </div>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">ìƒë…„ì›”ì¼ (YYMMDD) <span style="font-size:.72rem;color:var(--primary);font-weight:400;">â†’ ì…ë ¥ ì‹œ ë‚˜ì´ ìë™ ê³„ì‚°</span></label>
        <input class="form-control" id="sBirth" placeholder="ì˜ˆ) 120315 (2012ë…„ 3ì›” 15ì¼)"
          oninput="calcAgeFromBirth(this.value)">
      </div>
      <div class="form-group">
        <label class="form-label">í•™ë…„-ë°˜</label>
        <input class="form-control" id="sClass" placeholder="ìƒˆì¹œêµ¬" value="ìƒˆì¹œêµ¬">
      </div>
      <div class="form-group">
        <label class="form-label">ë‹´ì„êµì‚¬</label>
        <input class="form-control" id="sTeacher" placeholder="ê¹€ì„ ìƒ">
      </div>
      <div class="form-group">
        <label class="form-label">ìƒíƒœ</label>
        <select class="form-control" id="sStatus">
          <option value="ìƒˆì¹œêµ¬">ìƒˆì¹œêµ¬</option>
          <option value="ë“±ë¡">ë“±ë¡</option>
          <option value="ì‹¬ë°©í•„ìš”">ì‹¬ë°©í•„ìš”</option>
          <option value="ì¥ê²°ì">ì¥ê²°ì</option>
          <option value="ìœ í•™ì¤‘">ìœ í•™ì¤‘</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">ë³¸ì¸ ì—°ë½ì²˜</label>
        <input class="form-control" id="sContact" placeholder="010-0000-0000">
      </div>
      <div class="form-group">
        <label class="form-label">í•™ë¶€ëª¨ ì—°ë½ì²˜ (ë¶€)</label>
        <input class="form-control" id="sParentFather" placeholder="010-0000-0000">
      </div>
      <div class="form-group">
        <label class="form-label">í•™ë¶€ëª¨ ì—°ë½ì²˜ (ëª¨)</label>
        <input class="form-control" id="sParentMother" placeholder="010-0000-0000">
      </div>
      <div class="form-group">
        <label class="form-label">í•™êµ</label>
        <input class="form-control" id="sSchool" placeholder="ì˜ˆ) OOì¤‘í•™êµ">
      </div>
      <div class="form-group">
        <label class="form-label">ì£¼ì†Œ</label>
        <input class="form-control" id="sAddress" placeholder="ì˜ˆ) ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™">
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" style="flex:1" onclick="closeModal('studentModal')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" style="flex:2" onclick="submitStudent()">ì €ì¥</button>
    </div>
  </div>
</div>

<!-- â”€â”€â”€ êµì‚¬ ë“±ë¡/ìˆ˜ì • ëª¨ë‹¬ â”€â”€â”€ -->
<div class="modal-backdrop" id="teacherModal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" id="teacherModalTitle">êµì‚¬ ë“±ë¡</div>
      <button class="modal-close" onclick="closeModal('teacherModal')">âœ•</button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="tId">
      <div class="form-group">
        <label class="form-label">ì´ë¦„ *</label>
        <input class="form-control" id="tName" placeholder="ê¹€ì„ ìƒ">
      </div>
      <div class="form-group">
        <label class="form-label">ì—°ë½ì²˜</label>
        <input class="form-control" id="tContact" placeholder="010-0000-0000">
      </div>
      <div class="form-group">
        <label class="form-label">ìƒë…„ì›”ì¼ (YYMMDD)</label>
        <input class="form-control" id="tBirth" placeholder="ì˜ˆ) 950315">
      </div>
      <div class="form-group">
        <label class="form-label">êµ¬ë¶„ <span style="font-size:.7rem;color:var(--gray-400);">ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥</span></label>
        <div id="tRoleCheckboxes" style="display:flex;flex-wrap:wrap;gap:10px;padding:8px 0;">
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="êµì—­ì"> êµì—­ì</label>
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="ëª©ì‚¬"> ëª©ì‚¬</label>
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="ì „ë„ì‚¬"> ì „ë„ì‚¬</label>
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="ë¦¬ë”ì‹­"> ë¦¬ë”ì‹­</label>
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="ë‹´ì„" onchange="toggleTeacherClassField()"> ë‹´ì„</label>
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="ë¶€ë‹´ì„" onchange="toggleTeacherClassField()"> ë¶€ë‹´ì„</label>
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="ìƒˆì¹œêµ¬"> ìƒˆì¹œêµ¬</label>
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="ë¯¸ë””ì–´"> ë¯¸ë””ì–´</label>
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="ì°¬ì–‘íŒ€"> ì°¬ì–‘íŒ€</label>
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="ì›Œì‹­íŒ€"> ì›Œì‹­íŒ€</label>
          <label style="display:flex;align-items:center;gap:5px;font-size:.85rem;cursor:pointer;"><input type="checkbox" value="ì‚¬ì—­íŒ€"> ì‚¬ì—­íŒ€</label>
        </div>
      </div>
      <div class="form-group" id="tClassGroup" style="display:none;">
        <label class="form-label">ë‹´ë‹¹ í•™ë…„-ë°˜ <span style="font-size:.7rem;color:var(--gray-400);">(ë‹´ì„Â·ë¶€ë‹´ì„ë§Œ)</span></label>
        <input class="form-control" id="tClass" placeholder="ì˜ˆ) ì¤‘1-1ë°˜">
      </div>
      <div class="form-group">
        <label class="form-label">ì£¼ì†Œ</label>
        <input class="form-control" id="tAddress" placeholder="ì˜ˆ) ì„œìš¸ì‹œ ê°•ë‚¨êµ¬">
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" style="flex:1" onclick="closeModal('teacherModal')">ì·¨ì†Œ</button>
      <button class="btn btn-primary" style="flex:2" onclick="submitTeacher()">ì €ì¥</button>
    </div>
  </div>
</div>

<!-- â”€â”€â”€ ìƒì„¸ ì •ë³´ ëª¨ë‹¬ â”€â”€â”€ -->
<div class="modal-backdrop" id="detailModal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" id="detailTitle">ìƒì„¸ ì •ë³´</div>
      <button class="modal-close" onclick="closeModal('detailModal')">âœ•</button>
    </div>
    <div class="modal-body" id="detailBody"></div>
    <div class="modal-footer" id="detailFooter"></div>
  </div>
</div>

<!-- â”€â”€â”€ ë°˜ ë°°ì • ëª¨ë‹¬ â”€â”€â”€ -->
<div class="modal-backdrop" id="assignModal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">ì •ê·œ ë°˜ ë°°ì •</div>
      <button class="modal-close" onclick="closeModal('assignModal')">âœ•</button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="assignStudentId">
      <p style="margin-bottom:14px;font-size:.9rem;color:var(--gray-600);">
        4ì£¼ ì¶œì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ë°°ì •í•  ë°˜ì„ ì„ íƒí•˜ì„¸ìš”.
      </p>
      <div class="form-group">
        <label class="form-label">í•™ë…„-ë°˜ ì„ íƒ</label>
        <select class="form-control" id="assignClass"></select>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" style="flex:1" onclick="closeModal('assignModal')">ì·¨ì†Œ</button>
      <button class="btn btn-success" style="flex:2" onclick="confirmAssign()">ğŸ‰ ë°˜ ë°°ì • ì™„ë£Œ</button>
    </div>
  </div>
</div>

<!-- â”€â”€â”€ í† ìŠ¤íŠ¸ â”€â”€â”€ -->
<div class="toast" id="toast"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ìƒíƒœ & ì„¤ì •
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const GAS_URL = 'https://script.google.com/macros/s/AKfycbyMa_Gk0KQNnyLugZJy9X9N0gEeyd3Hw2aD-SR05YLksm1h7b69DX8awWQcdBauI47VIg/exec'; // â† GAS ë°°í¬ í›„ ì›¹ì•± URL ë¶™ì—¬ë„£ê¸° (ì˜ˆ: https://script.google.com/macros/s/AKf.../exec)
let allStudents = [];
let allTeachers = [];
let allNewbies  = [];
let allSundays  = [];
let currentAttRecords = {};
let filterMonth = new Date().getMonth() + 1; // ì•± ì‹œì‘ ì‹œ ì´ë‹¬ë¡œ ê¸°ë³¸ ì„¤ì •
let searchQuery = '';

// â”€â”€ í˜„ì¬ ë¡œê·¸ì¸ ì‚¬ìš©ì â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// role: 'admin'(êµì—­ì/ì „ì²´ì—´ëŒ) | 'leadership'(ë¦¬ë”ì‹­) | 'teacher'(ë‹´ë‹¹ë°˜) | 'newbie_teacher'(ìƒˆì¹œêµ¬)
let currentUser = null; // { name, role, classGroup }

// êµì—­ì êµ¬ë¶„ ëª©ë¡ (ì´ êµ¬ë¶„ì— í•´ë‹¹í•˜ë©´ admin)
const ADMIN_ROLES = ['êµì—­ì', 'ëª©ì‚¬', 'ì „ë„ì‚¬', 'ë¶€ì¥'];

// â”€â”€ êµì—­ì(ê´€ë¦¬ì) ì´ë¦„ ëª©ë¡ â”€â”€ ì—¬ê¸°ì— ì´ë¦„ ì¶”ê°€/ìˆ˜ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ADMIN_NAMES = ['ë¬¸í˜„ì² ', 'ì¥ìˆ˜ì‚°ë‚˜', 'ë§ˆí˜ìˆ˜', 'ê¹€ì •ë¡œ', 'ìµœê´‘ì‹'];

// â”€â”€ ë¹„ë°€ë²ˆí˜¸ ê´€ë¦¬ (localStorageì— ì €ì¥) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// â”€â”€ ì„¸ì…˜ ë²„ì „ (ë³€ê²½ ì‹œ ëª¨ë“  ê¸°ì¡´ ì„¸ì…˜ ë¬´íš¨í™”) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const APP_SESSION_VERSION = 'v2.0';

// â”€â”€ ì‚¬ìš©ìë³„ ë¹„ë°€ë²ˆí˜¸ (localStorage: pw_ì´ë¦„) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// â”€â”€ ë¹„ë°€ë²ˆí˜¸ ê´€ë¦¬ (GAS ì„œë²„ ì €ì¥ â†’ localStorage í´ë°± â†’ ê¸°ë³¸ '1234') â”€â”€
// ì¸ë©”ëª¨ë¦¬ ìºì‹œ (ì„¸ì…˜ ì¤‘ GAS ì—†ì´ë„ ë™ì‘ / ë°ëª¨ ëª¨ë“œ)
const _pwCache = {};  // { name: pw }

function _localGetPw(name) {
  if (_pwCache[name]) return _pwCache[name];
  try { const v = localStorage.getItem('pw_' + name); if (v) return v; } catch(e) {}
  return '1234'; // ê¸°ë³¸ê°’
}
function _localSetPw(name, pw) {
  _pwCache[name] = pw;
  try { localStorage.setItem('pw_' + name, pw); } catch(e) {}
}
function _localClearPw(name) {
  delete _pwCache[name];
  try { localStorage.removeItem('pw_' + name); } catch(e) {}
}

/** GASì—ì„œ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ (localStorage ë§ˆì´ê·¸ë ˆì´ì…˜ í¬í•¨) */
/** GAS(êµ¬ê¸€ ì‹œíŠ¸)ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ í•­ìƒ ìš°ì„ ìœ¼ë¡œ ì‚¬ìš©
 * - GASì— ì €ì¥ëœ ë¹„ë°€ë²ˆí˜¸ ìˆìŒ â†’ GAS ë¹„ë°€ë²ˆí˜¸ë§Œ ìœ íš¨ (localStorage ë¬´ì‹œ)
 * - GASì— ì—†ìŒ(ê¸°ë³¸ê°’ 1234) â†’ 1234 ë˜ëŠ” localStorage ë¹„ë°€ë²ˆí˜¸ í—ˆìš© (ë§ˆì´ê·¸ë ˆì´ì…˜)
 * - GAS ì—°ê²° ì‹¤íŒ¨ â†’ localStorage í´ë°±
 */
async function verifyUserPasswordAsync(name, pw) {
  if (!GAS_URL) {
    // ë°ëª¨ ëª¨ë“œ: ë¡œì»¬ë§Œ ì‚¬ìš©
    return pw === _localGetPw(name);
  }
  try {
    const r = await callGAS('verifyPassword', { name, pw });
    if (r && r.success) {
      if (r.data.match) return true;
      // GASì— ì»¤ìŠ¤í…€ ë¹„ë°€ë²ˆí˜¸ê°€ ë“±ë¡ëœ ê²½ìš° â†’ ë¬´ì¡°ê±´ GAS ë¹„ë°€ë²ˆí˜¸ë§Œ í—ˆìš©
      if (r.data.hasCustomPw) return false;
      // GASì— ë¹„ë°€ë²ˆí˜¸ ì—†ìŒ(ê¸°ë³¸ 1234) â†’ localStorage ë§ˆì´ê·¸ë ˆì´ì…˜ í—ˆìš©
      const localPw = _localGetPw(name);
      if (localPw !== '1234' && pw === localPw) {
        // localStorage ë¹„ë°€ë²ˆí˜¸ê°€ ë§ìŒ â†’ GASì— ìë™ ë™ê¸°í™” í›„ ë¡œê·¸ì¸
        callGAS('setPassword', { name, pw }).catch(() => {});
        _localClearPw(name); // localStorage ì •ë¦¬
        return true;
      }
      return false;
    }
  } catch(e) {
    console.warn('verifyPassword GAS ì˜¤ë¥˜, ë¡œì»¬ í´ë°±:', e);
  }
  // GAS ì™„ì „ ì‹¤íŒ¨ â†’ ë¡œì»¬ë¡œë§Œ ê²€ì¦
  return pw === _localGetPw(name);
}

/** ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ (GAS + ë¡œì»¬ ë™ì‹œ ì €ì¥) */
async function setUserPasswordAsync(name, pw) {
  _localSetPw(name, pw); // ì¦‰ì‹œ ë¡œì»¬ ì €ì¥
  if (!GAS_URL) return true;
  try {
    const r = await callGAS('setPassword', { name, pw });
    return r && r.success;
  } catch(e) {
    console.warn('setPassword GAS ì˜¤ë¥˜ (ë¡œì»¬ë§Œ ì €ì¥ë¨):', e);
    return false;
  }
}

/** ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” (admin ì „ìš©) */
async function resetUserPasswordAsync(name) {
  _localClearPw(name);
  if (!GAS_URL) return true;
  try {
    const r = await callGAS('resetPassword', { name });
    return r && r.success;
  } catch(e) {
    console.warn('resetPassword GAS ì˜¤ë¥˜:', e);
    return false;
  }
}

// í•˜ìœ„ í˜¸í™˜ ë™ê¸° ë²„ì „ (ë¡œì»¬ í´ë°±)
function getUserPassword(name) { return _localGetPw(name); }
function setUserPassword(name, pw) { _localSetPw(name, pw); }
function verifyUserPassword(name, pw) { return pw === _localGetPw(name); }
function isAdminName(name) {
  return ADMIN_NAMES.includes(name);
}
const LEADERSHIP_ROLES = ['ë¦¬ë”ì‹­', 'ë¦¬ë”'];
const NEWBIE_TEACHER_ROLES = ['ìƒˆì¹œêµ¬', 'ìƒˆì¹œêµ¬êµì‚¬'];
const ATTENDANCE_TEACHER_ROLES = ['ë‹´ì„', 'ë¶€ë‹´ì„'];

// êµ¬ë¶„ í•„ë“œëŠ” ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ë³µìˆ˜ê°’ì¼ ìˆ˜ ìˆìŒ ("ë‹´ì„,ì°¬ì–‘íŒ€" ë“±)
function hasRole(teacher, roleList) {
  const roles = (teacher['êµ¬ë¶„'] || '').split(',').map(r => r.trim());
  return roles.some(r => roleList.includes(r));
}
function getTeacherRole(teacher) {
  if (hasRole(teacher, ADMIN_ROLES))        return 'admin';
  if (hasRole(teacher, LEADERSHIP_ROLES))   return 'leadership';
  if (hasRole(teacher, NEWBIE_TEACHER_ROLES)) return 'newbie_teacher';
  return 'teacher';
}

// ì—­í• ë³„ í—ˆìš© íƒ­
const ROLE_TABS = {
  admin:          ['dashboard','attendance','attstat','newbie','records'],
  leadership:     ['dashboard','attendance','attstat','records'],
  teacher:        ['dashboard','attendance','attstat'],
  newbie_teacher: ['dashboard','newbie','attstat'],
};

// ìƒˆì¹œêµ¬ ì •ë ¬ ìƒíƒœ
let newbieSortKey = 'date_desc'; // ê¸°ë³¸: ìµœì‹  ë“±ë¡ ìˆœ // 'name_asc'|'name_desc'|'age_asc'|'age_desc'|'weeks_asc'|'weeks_desc'
let _locallyModified = new Set(); // ì‚¬ìš©ìê°€ ì§ì ‘ ìˆ˜ì •í•œ í•™ìƒ ID (í´ë§ ì‹œ ë®ì–´ì“°ê¸° ë°©ì§€)
let _pollInterval = null;          // ì‹¤ì‹œê°„ í´ë§ interval í•¸ë“¤

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GAS í†µì‹ 
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function callGAS(action, payload = {}) {
  return new Promise((resolve) => {
    // GAS_URLì´ ì—†ìœ¼ë©´ ë°ëª¨ ë°ì´í„° ì‚¬ìš©
    if (!GAS_URL) {
      if (!window._gasWarnShown && action !== 'getSundays') {
        window._gasWarnShown = true;
        setTimeout(() => showToast('âš ï¸ ë°ëª¨ ëª¨ë“œ: êµ¬ê¸€ ì‹œíŠ¸ ë¯¸ì—°ê²°. GAS_URLì„ ì…ë ¥í•˜ì„¸ìš”.', 'error'), 1200);
      }
      resolve(getDemoData(action, payload));
      return;
    }
    // GAS ì›¹ì•± í˜¸ì¶œ
    fetch(GAS_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain' },
      body: JSON.stringify({ action, payload })
    })
    .then(r => {
      if (!r.ok) throw new Error('HTTP ' + r.status);
      return r.json();
    })
    .then(data => resolve(data))
    .catch(e => {
      console.error('GAS ì—°ê²° ì˜¤ë¥˜ (' + action + '):', e.message);
      // ë„¤íŠ¸ì›Œí¬/CORS ì˜¤ë¥˜ â†’ ì˜¤ë¥˜ ê²°ê³¼ ë°˜í™˜ (throwí•˜ì§€ ì•ŠìŒ)
      resolve({ success: false, message: 'GAS ì—°ê²° ì‹¤íŒ¨: ' + e.message });
    });
  });
}

// ë°ëª¨ ë°ì´í„° (GAS ì—°ê²° ì „ í…ŒìŠ¤íŠ¸ìš©)
// â”€â”€ ë°ëª¨ ìŠ¤í† ì–´ (ì„¸ì…˜ ì¤‘ ë³€ê²½ì‚¬í•­ ìœ ì§€) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const _demo = {
  students: [
    {í•™ìƒID:'S001',ì´ë¦„:'ê¹€ë¯¼ì¤€',['í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110220',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3001-4001',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S002',ì´ë¦„:'ì´ë„í˜„',['í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'111109',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3002-4002',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S003',ì´ë¦„:'ë°•ì§€í›„',['í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110322',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3003-4003',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S004',ì´ë¦„:'ìµœì¤€ì„œ',['í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110114',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3004-4004',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S005',ì´ë¦„:'ì •ìš°ì§„',['í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110403',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3005-4005',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S006',ì´ë¦„:'ë°•ì„œì—°',['í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'111102',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5006-6006',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S007',ì´ë¦„:'ìµœì˜ˆì§„',['í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'111226',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5007-6007',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S008',ì´ë¦„:'ì´ìˆ˜ì•„',['í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110517',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5008-6008',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S009',ì´ë¦„:'ì •í•˜ì€',['í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110225',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5009-6009',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S010',ì´ë¦„:'ê¹€ì§€ìœ ',['í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110518',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5010-6010',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S011',ì´ë¦„:'ê°•ë¯¼ì¬',['í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ë‹´ì„êµì‚¬:'í•œì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110519',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3011-4011',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S012',ì´ë¦„:'ìœ¤ì„œì¤€',['í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ë‹´ì„êµì‚¬:'í•œì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110510',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3012-4012',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S013',ì´ë¦„:'ì„í˜„ìš°',['í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ë‹´ì„êµì‚¬:'í•œì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110808',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3013-4013',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S014',ì´ë¦„:'í•œì¬ì›',['í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ë‹´ì„êµì‚¬:'í•œì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110902',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3014-4014',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S015',ì´ë¦„:'ì˜¤ìŠ¹í˜„',['í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ë‹´ì„êµì‚¬:'í•œì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110414',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3015-4015',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S016',ì´ë¦„:'ìœ¤ì±„ì›',['í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ë‹´ì„êµì‚¬:'í•œì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'111115',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5016-6016',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S017',ì´ë¦„:'ê°•í•˜ë¦°',['í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ë‹´ì„êµì‚¬:'í•œì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'111107',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5017-6017',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S018',ì´ë¦„:'ì„ìˆ˜ë¹ˆ',['í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ë‹´ì„êµì‚¬:'í•œì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110328',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5018-6018',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S019',ì´ë¦„:'í•œì§€ì•„',['í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ë‹´ì„êµì‚¬:'í•œì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'111028',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5019-6019',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S020',ì´ë¦„:'ì˜¤ì„¸ì—°',['í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ë‹´ì„êµì‚¬:'í•œì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110912',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5020-6020',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S021',ì´ë¦„:'ì‹ íƒœì–‘',['í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110714',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3021-4021',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S022',ì´ë¦„:'ê¶Œë„ìœ¤',['í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110815',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3022-4022',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S023',ì´ë¦„:'í™©ì„±ë¯¼',['í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110309',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3023-4023',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S024',ì´ë¦„:'ë¥˜ì¬í˜',['í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110602',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3024-4024',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S025',ì´ë¦„:'ë…¸ì¤€í˜',['í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110921',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3025-4025',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S026',ì´ë¦„:'ì‹ ìœ ì§„',['í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110205',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5026-6026',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S027',ì´ë¦„:'ê¶Œë‚˜ì˜',['í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'111125',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5027-6027',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S028',ì´ë¦„:'í™©ìˆ˜ë¹ˆ',['í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'111111',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5028-6028',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S029',ì´ë¦„:'ë¥˜ì§€ì›',['í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110813',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5029-6029',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S030',ì´ë¦„:'ë…¸ì€ì„œ',['í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:12,ìƒë…„ì›”ì¼:'110318',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5030-6030',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S031',ì´ë¦„:'ë¬¸ì„±í˜¸',['í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120612',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3031-4031',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S032',ì´ë¦„:'ë°±ë¯¼ì„±',['í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120911',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3032-4032',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S033',ì´ë¦„:'ì†¡ì¬í˜„',['í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'121212',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3033-4033',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S034',ì´ë¦„:'ì•ˆì¬í˜„',['í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120920',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3034-4034',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S035',ì´ë¦„:'ì—„íƒœì¤€',['í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'121117',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3035-4035',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S036',ì´ë¦„:'ë¬¸í•˜ì—°',['í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'121023',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5036-6036',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S037',ì´ë¦„:'ë°±ì§€ìˆ˜',['í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120320',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5037-6037',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S038',ì´ë¦„:'ì†¡ì•„ë¦„',['í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120723',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5038-6038',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S039',ì´ë¦„:'ì•ˆì†Œì´',['í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'121120',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5039-6039',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S040',ì´ë¦„:'ì—„ì§€ìœ¤',['í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120120',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5040-6040',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S041',ì´ë¦„:'ê¹€ë¯¼ì¤€',['í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ë‹´ì„êµì‚¬:'ì˜¤ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120504',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3041-4041',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S042',ì´ë¦„:'ì´ë„í˜„',['í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ë‹´ì„êµì‚¬:'ì˜¤ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120712',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3042-4042',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S043',ì´ë¦„:'ë°•ì§€í›„',['í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ë‹´ì„êµì‚¬:'ì˜¤ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120806',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3043-4043',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S044',ì´ë¦„:'ìµœì¤€ì„œ',['í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ë‹´ì„êµì‚¬:'ì˜¤ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120705',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3044-4044',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S045',ì´ë¦„:'ì •ìš°ì§„',['í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ë‹´ì„êµì‚¬:'ì˜¤ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120507',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3045-4045',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S046',ì´ë¦„:'ë°•ì„œì—°',['í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ë‹´ì„êµì‚¬:'ì˜¤ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'121007',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5046-6046',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S047',ì´ë¦„:'ìµœì˜ˆì§„',['í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ë‹´ì„êµì‚¬:'ì˜¤ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'121224',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5047-6047',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S048',ì´ë¦„:'ì´ìˆ˜ì•„',['í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ë‹´ì„êµì‚¬:'ì˜¤ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120423',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5048-6048',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S049',ì´ë¦„:'ì •í•˜ì€',['í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ë‹´ì„êµì‚¬:'ì˜¤ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120115',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5049-6049',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S050',ì´ë¦„:'ê¹€ì§€ìœ ',['í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ë‹´ì„êµì‚¬:'ì˜¤ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120309',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5050-6050',ìƒíƒœ:'ì¥ê²°ì',ì£¼ì†Œ:''},
    {í•™ìƒID:'S051',ì´ë¦„:'ê°•ë¯¼ì¬',['í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120713',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3051-4051',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S052',ì´ë¦„:'ìœ¤ì„œì¤€',['í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'121022',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3052-4052',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S053',ì´ë¦„:'ì„í˜„ìš°',['í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120612',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3053-4053',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S054',ì´ë¦„:'í•œì¬ì›',['í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120211',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3054-4054',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S055',ì´ë¦„:'ì˜¤ìŠ¹í˜„',['í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120314',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3055-4055',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S056',ì´ë¦„:'ìœ¤ì±„ì›',['í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'121023',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5056-6056',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S057',ì´ë¦„:'ê°•í•˜ë¦°',['í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120725',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5057-6057',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S058',ì´ë¦„:'ì„ìˆ˜ë¹ˆ',['í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120202',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5058-6058',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S059',ì´ë¦„:'í•œì§€ì•„',['í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120219',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5059-6059',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S060',ì´ë¦„:'ì˜¤ì„¸ì—°',['í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:13,ìƒë…„ì›”ì¼:'120228',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5060-6060',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S061',ì´ë¦„:'ì‹ íƒœì–‘',['í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130627',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3061-4061',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S062',ì´ë¦„:'ê¶Œë„ìœ¤',['í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130912',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3062-4062',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S063',ì´ë¦„:'í™©ì„±ë¯¼',['í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130207',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3063-4063',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S064',ì´ë¦„:'ë¥˜ì¬í˜',['í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'131212',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3064-4064',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S065',ì´ë¦„:'ë…¸ì¤€í˜',['í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130611',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3065-4065',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S066',ì´ë¦„:'ì‹ ìœ ì§„',['í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130714',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5066-6066',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S067',ì´ë¦„:'ê¶Œë‚˜ì˜',['í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130317',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5067-6067',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S068',ì´ë¦„:'í™©ìˆ˜ë¹ˆ',['í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130917',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5068-6068',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S069',ì´ë¦„:'ë¥˜ì§€ì›',['í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130201',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5069-6069',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S070',ì´ë¦„:'ë…¸ì€ì„œ',['í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130205',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5070-6070',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S071',ì´ë¦„:'ë¬¸ì„±í˜¸',['í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ë‹´ì„êµì‚¬:'ì‹ ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130915',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3071-4071',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S072',ì´ë¦„:'ë°±ë¯¼ì„±',['í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ë‹´ì„êµì‚¬:'ì‹ ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'131205',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3072-4072',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S073',ì´ë¦„:'ì†¡ì¬í˜„',['í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ë‹´ì„êµì‚¬:'ì‹ ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130325',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3073-4073',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S074',ì´ë¦„:'ì•ˆì¬í˜„',['í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ë‹´ì„êµì‚¬:'ì‹ ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130220',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3074-4074',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S075',ì´ë¦„:'ì—„íƒœì¤€',['í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ë‹´ì„êµì‚¬:'ì‹ ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'131024',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3075-4075',ìƒíƒœ:'ìœ í•™',ì£¼ì†Œ:''},
    {í•™ìƒID:'S076',ì´ë¦„:'ë¬¸í•˜ì—°',['í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ë‹´ì„êµì‚¬:'ì‹ ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130104',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5076-6076',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S077',ì´ë¦„:'ë°±ì§€ìˆ˜',['í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ë‹´ì„êµì‚¬:'ì‹ ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130218',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5077-6077',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S078',ì´ë¦„:'ì†¡ì•„ë¦„',['í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ë‹´ì„êµì‚¬:'ì‹ ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130218',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5078-6078',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S079',ì´ë¦„:'ì•ˆì†Œì´',['í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ë‹´ì„êµì‚¬:'ì‹ ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130412',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5079-6079',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S080',ì´ë¦„:'ì—„ì§€ìœ¤',['í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ë‹´ì„êµì‚¬:'ì‹ ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'131009',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5080-6080',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S081',ì´ë¦„:'ê¹€ë¯¼ì¤€',['í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130321',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3081-4081',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S082',ì´ë¦„:'ì´ë„í˜„',['í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'131207',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3082-4082',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S083',ì´ë¦„:'ë°•ì§€í›„',['í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130812',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3083-4083',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S084',ì´ë¦„:'ìµœì¤€ì„œ',['í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130202',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3084-4084',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S085',ì´ë¦„:'ì •ìš°ì§„',['í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'131201',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3085-4085',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S086',ì´ë¦„:'ë°•ì„œì—°',['í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'131226',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5086-6086',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S087',ì´ë¦„:'ìµœì˜ˆì§„',['í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'131107',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5087-6087',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S088',ì´ë¦„:'ì´ìˆ˜ì•„',['í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'131217',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5088-6088',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S089',ì´ë¦„:'ì •í•˜ì€',['í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130205',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5089-6089',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S090',ì´ë¦„:'ê¹€ì§€ìœ ',['í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:14,ìƒë…„ì›”ì¼:'130914',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5090-6090',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S091',ì´ë¦„:'ê°•ë¯¼ì¬',['í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ë‹´ì„êµì‚¬:'ìœ¤ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141205',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3091-4091',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S092',ì´ë¦„:'ìœ¤ì„œì¤€',['í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ë‹´ì„êµì‚¬:'ìœ¤ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140102',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3092-4092',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S093',ì´ë¦„:'ì„í˜„ìš°',['í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ë‹´ì„êµì‚¬:'ìœ¤ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140122',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3093-4093',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S094',ì´ë¦„:'í•œì¬ì›',['í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ë‹´ì„êµì‚¬:'ìœ¤ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141108',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3094-4094',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S095',ì´ë¦„:'ì˜¤ìŠ¹í˜„',['í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ë‹´ì„êµì‚¬:'ìœ¤ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140404',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3095-4095',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S096',ì´ë¦„:'ìœ¤ì±„ì›',['í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ë‹´ì„êµì‚¬:'ìœ¤ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140724',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5096-6096',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S097',ì´ë¦„:'ê°•í•˜ë¦°',['í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ë‹´ì„êµì‚¬:'ìœ¤ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141215',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5097-6097',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S098',ì´ë¦„:'ì„ìˆ˜ë¹ˆ',['í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ë‹´ì„êµì‚¬:'ìœ¤ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141112',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5098-6098',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S099',ì´ë¦„:'í•œì§€ì•„',['í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ë‹´ì„êµì‚¬:'ìœ¤ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140813',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5099-6099',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S100',ì´ë¦„:'ì˜¤ì„¸ì—°',['í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ë‹´ì„êµì‚¬:'ìœ¤ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141027',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5100-6100',ìƒíƒœ:'ì¥ê²°ì',ì£¼ì†Œ:''},
    {í•™ìƒID:'S101',ì´ë¦„:'ì‹ íƒœì–‘',['í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ë‹´ì„êµì‚¬:'ê¶Œì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140117',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3101-4101',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S102',ì´ë¦„:'ê¶Œë„ìœ¤',['í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ë‹´ì„êµì‚¬:'ê¶Œì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141007',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3102-4102',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S103',ì´ë¦„:'í™©ì„±ë¯¼',['í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ë‹´ì„êµì‚¬:'ê¶Œì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140219',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3103-4103',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S104',ì´ë¦„:'ë¥˜ì¬í˜',['í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ë‹´ì„êµì‚¬:'ê¶Œì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140622',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3104-4104',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S105',ì´ë¦„:'ë…¸ì¤€í˜',['í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ë‹´ì„êµì‚¬:'ê¶Œì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140122',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3105-4105',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S106',ì´ë¦„:'ì‹ ìœ ì§„',['í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ë‹´ì„êµì‚¬:'ê¶Œì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141012',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5106-6106',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S107',ì´ë¦„:'ê¶Œë‚˜ì˜',['í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ë‹´ì„êµì‚¬:'ê¶Œì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141116',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5107-6107',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S108',ì´ë¦„:'í™©ìˆ˜ë¹ˆ',['í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ë‹´ì„êµì‚¬:'ê¶Œì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140306',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5108-6108',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S109',ì´ë¦„:'ë¥˜ì§€ì›',['í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ë‹´ì„êµì‚¬:'ê¶Œì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140512',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5109-6109',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S110',ì´ë¦„:'ë…¸ì€ì„œ',['í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ë‹´ì„êµì‚¬:'ê¶Œì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140201',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5110-6110',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S111',ì´ë¦„:'ë¬¸ì„±í˜¸',['í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ë‹´ì„êµì‚¬:'ì„ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141126',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3111-4111',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S112',ì´ë¦„:'ë°±ë¯¼ì„±',['í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ë‹´ì„êµì‚¬:'ì„ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141021',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3112-4112',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S113',ì´ë¦„:'ì†¡ì¬í˜„',['í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ë‹´ì„êµì‚¬:'ì„ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140509',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3113-4113',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S114',ì´ë¦„:'ì•ˆì¬í˜„',['í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ë‹´ì„êµì‚¬:'ì„ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141201',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3114-4114',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S115',ì´ë¦„:'ì—„íƒœì¤€',['í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ë‹´ì„êµì‚¬:'ì„ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140911',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3115-4115',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S116',ì´ë¦„:'ë¬¸í•˜ì—°',['í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ë‹´ì„êµì‚¬:'ì„ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140820',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5116-6116',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S117',ì´ë¦„:'ë°±ì§€ìˆ˜',['í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ë‹´ì„êµì‚¬:'ì„ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141101',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5117-6117',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S118',ì´ë¦„:'ì†¡ì•„ë¦„',['í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ë‹´ì„êµì‚¬:'ì„ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'141115',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5118-6118',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S119',ì´ë¦„:'ì•ˆì†Œì´',['í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ë‹´ì„êµì‚¬:'ì„ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140427',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5119-6119',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S120',ì´ë¦„:'ì—„ì§€ìœ¤',['í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ë‹´ì„êµì‚¬:'ì„ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:15,ìƒë…„ì›”ì¼:'140109',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5120-6120',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S121',ì´ë¦„:'ê¹€ë¯¼ì¤€',['í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150225',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3121-4121',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S122',ì´ë¦„:'ì´ë„í˜„',['í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'151025',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3122-4122',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S123',ì´ë¦„:'ë°•ì§€í›„',['í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150805',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3123-4123',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S124',ì´ë¦„:'ìµœì¤€ì„œ',['í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150528',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3124-4124',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S125',ì´ë¦„:'ì •ìš°ì§„',['í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150816',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3125-4125',ìƒíƒœ:'ìœ í•™',ì£¼ì†Œ:''},
    {í•™ìƒID:'S126',ì´ë¦„:'ë°•ì„œì—°',['í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150817',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5126-6126',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S127',ì´ë¦„:'ìµœì˜ˆì§„',['í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150108',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5127-6127',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S128',ì´ë¦„:'ì´ìˆ˜ì•„',['í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150214',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5128-6128',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S129',ì´ë¦„:'ì •í•˜ì€',['í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'151011',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5129-6129',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S130',ì´ë¦„:'ê¹€ì§€ìœ ',['í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ë‹´ì„êµì‚¬:'ê¹€ëª©ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150917',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5130-6130',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S131',ì´ë¦„:'ê°•ë¯¼ì¬',['í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ë‹´ì„êµì‚¬:'í™©ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150505',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3131-4131',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S132',ì´ë¦„:'ìœ¤ì„œì¤€',['í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ë‹´ì„êµì‚¬:'í™©ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150506',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3132-4132',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S133',ì´ë¦„:'ì„í˜„ìš°',['í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ë‹´ì„êµì‚¬:'í™©ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150627',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3133-4133',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S134',ì´ë¦„:'í•œì¬ì›',['í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ë‹´ì„êµì‚¬:'í™©ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150103',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3134-4134',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S135',ì´ë¦„:'ì˜¤ìŠ¹í˜„',['í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ë‹´ì„êµì‚¬:'í™©ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150926',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3135-4135',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S136',ì´ë¦„:'ìœ¤ì±„ì›',['í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ë‹´ì„êµì‚¬:'í™©ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150210',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5136-6136',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S137',ì´ë¦„:'ê°•í•˜ë¦°',['í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ë‹´ì„êµì‚¬:'í™©ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150125',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5137-6137',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S138',ì´ë¦„:'ì„ìˆ˜ë¹ˆ',['í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ë‹´ì„êµì‚¬:'í™©ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'151111',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5138-6138',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S139',ì´ë¦„:'í•œì§€ì•„',['í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ë‹´ì„êµì‚¬:'í™©ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'151207',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5139-6139',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S140',ì´ë¦„:'ì˜¤ì„¸ì—°',['í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ë‹´ì„êµì‚¬:'í™©ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150225',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5140-6140',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S141',ì´ë¦„:'ì‹ íƒœì–‘',['í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150705',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3141-4141',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S142',ì´ë¦„:'ê¶Œë„ìœ¤',['í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'151225',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3142-4142',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S143',ì´ë¦„:'í™©ì„±ë¯¼',['í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150214',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3143-4143',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S144',ì´ë¦„:'ë¥˜ì¬í˜',['í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150201',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3144-4144',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S145',ì´ë¦„:'ë…¸ì¤€í˜',['í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150123',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3145-4145',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S146',ì´ë¦„:'ì‹ ìœ ì§„',['í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150305',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5146-6146',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S147',ì´ë¦„:'ê¶Œë‚˜ì˜',['í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'151106',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5147-6147',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S148',ì´ë¦„:'í™©ìˆ˜ë¹ˆ',['í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150317',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5148-6148',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S149',ì´ë¦„:'ë¥˜ì§€ì›',['í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'150602',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5149-6149',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S150',ì´ë¦„:'ë…¸ì€ì„œ',['í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ë‹´ì„êµì‚¬:'ì´ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:16,ìƒë…„ì›”ì¼:'151227',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5150-6150',ìƒíƒœ:'ì¥ê²°ì',ì£¼ì†Œ:''},
    {í•™ìƒID:'S151',ì´ë¦„:'ë¬¸ì„±í˜¸',['í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160111',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3151-4151',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S152',ì´ë¦„:'ë°±ë¯¼ì„±',['í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160319',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3152-4152',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S153',ì´ë¦„:'ì†¡ì¬í˜„',['í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'161216',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3153-4153',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S154',ì´ë¦„:'ì•ˆì¬í˜„',['í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160321',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3154-4154',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S155',ì´ë¦„:'ì—„íƒœì¤€',['í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'161117',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3155-4155',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S156',ì´ë¦„:'ë¬¸í•˜ì—°',['í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160110',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5156-6156',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S157',ì´ë¦„:'ë°±ì§€ìˆ˜',['í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160302',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5157-6157',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S158',ì´ë¦„:'ì†¡ì•„ë¦„',['í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160925',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5158-6158',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S159',ì´ë¦„:'ì•ˆì†Œì´',['í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'161019',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5159-6159',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S160',ì´ë¦„:'ì—„ì§€ìœ¤',['í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ë‹´ì„êµì‚¬:'ë°•ì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160412',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5160-6160',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S161',ì´ë¦„:'ê¹€ë¯¼ì¤€',['í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ë‹´ì„êµì‚¬:'ë¥˜ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160527',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3161-4161',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S162',ì´ë¦„:'ì´ë„í˜„',['í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ë‹´ì„êµì‚¬:'ë¥˜ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160202',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3162-4162',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S163',ì´ë¦„:'ë°•ì§€í›„',['í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ë‹´ì„êµì‚¬:'ë¥˜ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160605',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3163-4163',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S164',ì´ë¦„:'ìµœì¤€ì„œ',['í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ë‹´ì„êµì‚¬:'ë¥˜ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'161227',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3164-4164',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S165',ì´ë¦„:'ì •ìš°ì§„',['í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ë‹´ì„êµì‚¬:'ë¥˜ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160503',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3165-4165',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S166',ì´ë¦„:'ë°•ì„œì—°',['í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ë‹´ì„êµì‚¬:'ë¥˜ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160409',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5166-6166',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S167',ì´ë¦„:'ìµœì˜ˆì§„',['í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ë‹´ì„êµì‚¬:'ë¥˜ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'161001',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5167-6167',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S168',ì´ë¦„:'ì´ìˆ˜ì•„',['í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ë‹´ì„êµì‚¬:'ë¥˜ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160507',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5168-6168',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S169',ì´ë¦„:'ì •í•˜ì€',['í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ë‹´ì„êµì‚¬:'ë¥˜ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'161025',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5169-6169',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S170',ì´ë¦„:'ê¹€ì§€ìœ ',['í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ë‹´ì„êµì‚¬:'ë¥˜ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'161109',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5170-6170',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S171',ì´ë¦„:'ê°•ë¯¼ì¬',['í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160914',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3171-4171',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S172',ì´ë¦„:'ìœ¤ì„œì¤€',['í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160422',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3172-4172',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S173',ì´ë¦„:'ì„í˜„ìš°',['í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160401',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3173-4173',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S174',ì´ë¦„:'í•œì¬ì›',['í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160903',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3174-4174',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S175',ì´ë¦„:'ì˜¤ìŠ¹í˜„',['í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ë‚¨',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160813',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3175-4175',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S176',ì´ë¦„:'ìœ¤ì±„ì›',['í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160420',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5176-6176',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S177',ì´ë¦„:'ê°•í•˜ë¦°',['í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'161128',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5177-6177',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S178',ì´ë¦„:'ì„ìˆ˜ë¹ˆ',['í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160904',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5178-6178',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S179',ì´ë¦„:'í•œì§€ì•„',['í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160825',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5179-6179',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S180',ì´ë¦„:'ì˜¤ì„¸ì—°',['í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ë‹´ì„êµì‚¬:'ìµœì „ë„ì‚¬',ì„±ë³„:'ì—¬',ë‚˜ì´:17,ìƒë…„ì›”ì¼:'160208',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5180-6180',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S181',ì´ë¦„:'ì‹ íƒœì–‘',['í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'171210',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3181-4181',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S182',ì´ë¦„:'ê¶Œë„ìœ¤',['í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170618',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3182-4182',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S183',ì´ë¦„:'í™©ì„±ë¯¼',['í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170307',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3183-4183',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S184',ì´ë¦„:'ë¥˜ì¬í˜',['í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170617',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3184-4184',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S185',ì´ë¦„:'ë…¸ì¤€í˜',['í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'171202',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3185-4185',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S186',ì´ë¦„:'ì‹ ìœ ì§„',['í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170501',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5186-6186',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S187',ì´ë¦„:'ê¶Œë‚˜ì˜',['í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170814',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5187-6187',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S188',ì´ë¦„:'í™©ìˆ˜ë¹ˆ',['í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170716',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5188-6188',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S189',ì´ë¦„:'ë¥˜ì§€ì›',['í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170522',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5189-6189',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S190',ì´ë¦„:'ë…¸ì€ì„œ',['í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ë‹´ì„êµì‚¬:'ì •ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170306',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5190-6190',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S191',ì´ë¦„:'ë¬¸ì„±í˜¸',['í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ë‹´ì„êµì‚¬:'ë…¸ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'171027',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3191-4191',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S192',ì´ë¦„:'ë°±ë¯¼ì„±',['í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ë‹´ì„êµì‚¬:'ë…¸ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'171120',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3192-4192',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S193',ì´ë¦„:'ì†¡ì¬í˜„',['í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ë‹´ì„êµì‚¬:'ë…¸ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170717',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3193-4193',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S194',ì´ë¦„:'ì•ˆì¬í˜„',['í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ë‹´ì„êµì‚¬:'ë…¸ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170108',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3194-4194',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S195',ì´ë¦„:'ì—„íƒœì¤€',['í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ë‹´ì„êµì‚¬:'ë…¸ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170419',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3195-4195',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S196',ì´ë¦„:'ë¬¸í•˜ì—°',['í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ë‹´ì„êµì‚¬:'ë…¸ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170116',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5196-6196',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S197',ì´ë¦„:'ë°±ì§€ìˆ˜',['í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ë‹´ì„êµì‚¬:'ë…¸ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170112',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5197-6197',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S198',ì´ë¦„:'ì†¡ì•„ë¦„',['í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ë‹´ì„êµì‚¬:'ë…¸ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170521',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5198-6198',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S199',ì´ë¦„:'ì•ˆì†Œì´',['í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ë‹´ì„êµì‚¬:'ë…¸ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170909',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5199-6199',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S200',ì´ë¦„:'ì—„ì§€ìœ¤',['í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ë‹´ì„êµì‚¬:'ë…¸ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170424',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5200-6200',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S201',ì´ë¦„:'ê¹€ë¯¼ì¤€',['í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170110',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3201-4201',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S202',ì´ë¦„:'ì´ë„í˜„',['í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170709',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3202-4202',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S203',ì´ë¦„:'ë°•ì§€í›„',['í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170126',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3203-4203',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S204',ì´ë¦„:'ìµœì¤€ì„œ',['í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'171005',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3204-4204',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S205',ì´ë¦„:'ì •ìš°ì§„',['í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ë‚¨',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170515',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-3205-4205',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S206',ì´ë¦„:'ë°•ì„œì—°',['í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170511',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5206-6206',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S207',ì´ë¦„:'ìµœì˜ˆì§„',['í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170716',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5207-6207',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S208',ì´ë¦„:'ì´ìˆ˜ì•„',['í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170823',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5208-6208',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S209',ì´ë¦„:'ì •í•˜ì€',['í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170804',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5209-6209',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''},
    {í•™ìƒID:'S210',ì´ë¦„:'ê¹€ì§€ìœ ',['í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ë‹´ì„êµì‚¬:'ê°•ì„ ìƒ',ì„±ë³„:'ì—¬',ë‚˜ì´:18,ìƒë…„ì›”ì¼:'170626',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'010-5210-6210',ìƒíƒœ:'ë“±ë¡',ì£¼ì†Œ:''}
  ],
  teachers: [
    {êµì‚¬ID:'T001',ì´ë¦„:'ë¬¸í˜„ì² ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'',ì—°ë½ì²˜:'010-0001-0001',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'êµì—­ì',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T002',ì´ë¦„:'ì¥ìˆ˜ì‚°ë‚˜',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'',ì—°ë½ì²˜:'010-0002-0002',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'êµì—­ì',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T003',ì´ë¦„:'ë§ˆí˜ìˆ˜',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'',ì—°ë½ì²˜:'010-0003-0003',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'êµì—­ì',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T004',ì´ë¦„:'ê¹€ì •ë¡œ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'',ì—°ë½ì²˜:'010-0004-0004',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'êµì—­ì',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T005',ì´ë¦„:'ìµœê´‘ì‹',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'',ì—°ë½ì²˜:'010-0005-0005',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'êµì—­ì',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T006',ì´ë¦„:'ê¹€ëª©ì‚¬',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì´ˆ6-1ë°˜',ì—°ë½ì²˜:'010-1001-2001',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T007',ì´ë¦„:'í•œì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì´ˆ6-2ë°˜',ì—°ë½ì²˜:'010-1002-2002',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T008',ì´ë¦„:'ì´ì „ë„ì‚¬',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì´ˆ6-3ë°˜',ì—°ë½ì²˜:'010-1003-2003',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T009',ì´ë¦„:'ë°•ì „ë„ì‚¬',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì¤‘1-1ë°˜',ì—°ë½ì²˜:'010-1004-2004',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T010',ì´ë¦„:'ì˜¤ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì¤‘1-2ë°˜',ì—°ë½ì²˜:'010-1005-2005',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T011',ì´ë¦„:'ìµœì „ë„ì‚¬',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì¤‘1-3ë°˜',ì—°ë½ì²˜:'010-1006-2006',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T012',ì´ë¦„:'ì •ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì¤‘2-1ë°˜',ì—°ë½ì²˜:'010-1007-2007',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T013',ì´ë¦„:'ì‹ ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì¤‘2-2ë°˜',ì—°ë½ì²˜:'010-1008-2008',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T014',ì´ë¦„:'ê°•ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì¤‘2-3ë°˜',ì—°ë½ì²˜:'010-1009-2009',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T015',ì´ë¦„:'ìœ¤ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì¤‘3-1ë°˜',ì—°ë½ì²˜:'010-1010-2010',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T016',ì´ë¦„:'ê¶Œì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì¤‘3-2ë°˜',ì—°ë½ì²˜:'010-1011-2011',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T017',ì´ë¦„:'ì„ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ì¤‘3-3ë°˜',ì—°ë½ì²˜:'010-1012-2012',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T018',ì´ë¦„:'í™ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ê³ 1-1ë°˜',ì—°ë½ì²˜:'010-1013-2013',ìƒë…„ì›”ì¼:'',êµ¬ë¶„:'ë‹´ì„',ì£¼ì†Œ:''},
    {êµì‚¬ID:'T014',ì´ë¦„:'í™©ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ê³ 1-2ë°˜',ì—°ë½ì²˜:'010-1014-2014',êµ¬ë¶„:'ë‹´ì„'},
    {êµì‚¬ID:'T015',ì´ë¦„:'ì´ì „ë„ì‚¬',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ê³ 1-3ë°˜',ì—°ë½ì²˜:'010-1015-2015',êµ¬ë¶„:'ë‹´ì„'},
    {êµì‚¬ID:'T016',ì´ë¦„:'ë°•ì „ë„ì‚¬',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ê³ 2-1ë°˜',ì—°ë½ì²˜:'010-1016-2016',êµ¬ë¶„:'ë‹´ì„'},
    {êµì‚¬ID:'T017',ì´ë¦„:'ë¥˜ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ê³ 2-2ë°˜',ì—°ë½ì²˜:'010-1017-2017',êµ¬ë¶„:'ë‹´ì„'},
    {êµì‚¬ID:'T018',ì´ë¦„:'ìµœì „ë„ì‚¬',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ê³ 2-3ë°˜',ì—°ë½ì²˜:'010-1018-2018',êµ¬ë¶„:'ë‹´ì„'},
    {êµì‚¬ID:'T019',ì´ë¦„:'ì •ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ê³ 3-1ë°˜',ì—°ë½ì²˜:'010-1019-2019',êµ¬ë¶„:'ë‹´ì„'},
    {êµì‚¬ID:'T020',ì´ë¦„:'ë…¸ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ê³ 3-2ë°˜',ì—°ë½ì²˜:'010-1020-2020',êµ¬ë¶„:'ë‹´ì„'},
    {êµì‚¬ID:'T021',ì´ë¦„:'ê°•ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'ê³ 3-3ë°˜',ì—°ë½ì²˜:'010-1021-2021',êµ¬ë¶„:'ë‹´ì„'},
    {êµì‚¬ID:'T022',ì´ë¦„:'ê¹€ëª©ì‚¬ë‹˜',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'',ì—°ë½ì²˜:'010-0001-0001',êµ¬ë¶„:'êµì—­ì'},
    {êµì‚¬ID:'T023',ì´ë¦„:'ì´ì „ë„ì‚¬ë‹˜',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'',ì—°ë½ì²˜:'010-0001-0002',êµ¬ë¶„:'ì „ë„ì‚¬'},
    {êµì‚¬ID:'T024',ì´ë¦„:'ìƒˆì¹œêµ¬ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'',ì—°ë½ì²˜:'010-0001-0003',êµ¬ë¶„:'ìƒˆì¹œêµ¬'},
    {êµì‚¬ID:'T025',ì´ë¦„:'ë¦¬ë”ì‹­ì„ ìƒ',['ë‹´ë‹¹ í•™ë…„-ë°˜']:'',ì—°ë½ì²˜:'010-0001-0004',êµ¬ë¶„:'ë¦¬ë”ì‹­'}
  ],
  newbies: [],  // ìƒˆì¹œêµ¬ ì—†ìŒ
  // newbie cross-ref in students (auto-synced)
  _newbieStudents: [
    {í•™ìƒID:'NB001',ì´ë¦„:'í™ê¸¸ë™',['í•™ë…„-ë°˜']:'ìƒˆì¹œêµ¬',ë‹´ì„êµì‚¬:'',ì„±ë³„:'',ë‚˜ì´:'',ìƒë…„ì›”ì¼:'',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'',ìƒíƒœ:'ìƒˆì¹œêµ¬',ì£¼ì†Œ:''},
    {í•™ìƒID:'NB002',ì´ë¦„:'ì´ì˜í¬',['í•™ë…„-ë°˜']:'ìƒˆì¹œêµ¬',ë‹´ì„êµì‚¬:'',ì„±ë³„:'',ë‚˜ì´:'',ìƒë…„ì›”ì¼:'',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'',ìƒíƒœ:'ìƒˆì¹œêµ¬',ì£¼ì†Œ:''},
  ],
  attendance: {}, // { 'YYYY-MM-DD_classGroup': [{studentId, name, status, reason}] }
  _nextId: 221,
};

function _demoGenId(prefix) {
  return prefix + String(_demo._nextId++).padStart(3,'0');
}

function _demoNewbieRow(id, name) {
  return {
    í•™ìƒID:id, ì´ë¦„:name,
    '1ì£¼ì°¨ë‚ ì§œ':'','1ì£¼ì°¨ì¶œê²°':'',
    '2ì£¼ì°¨ë‚ ì§œ':'','2ì£¼ì°¨ì¶œê²°':'',
    '3ì£¼ì°¨ë‚ ì§œ':'','3ì£¼ì°¨ì¶œê²°':'',
    '4ì£¼ì°¨ë‚ ì§œ':'','4ì£¼ì°¨ì¶œê²°':'',
    ë°˜ë°°ì •ì™„ë£Œì—¬ë¶€:'FALSE'
  };
}

function getDemoData(action, payload) {
  switch(action) {
    case 'getStudents': return {success:true, data: _demo.students.map(s=>({...s}))};
    case 'getTeachers': return {success:true, data: _demo.teachers.map(t=>({...t}))};
    case 'getNewbies':  return {success:true, data: _demo.newbies.map(n=>({...n}))};
    case 'getSundays':  return {success:true, data: getSundays2026()};

    case 'getAttendance': {
      const cls  = payload.classGroup;
      const date = payload.date;
      const key  = `${date}_${cls}`;

      if (cls === '__teachers__') {
        const saved = _demo.attendance[key] || [];
        const result = _demo.teachers.map(t => {
          const prev = saved.find(r => r.studentId === t['êµì‚¬ID']);
          return { studentId: t['êµì‚¬ID'], name: t['ì´ë¦„'], classGroup: '__teachers__',
                   status: prev ? prev.status : 'ë¯¸ì²´í¬', reason: prev ? prev.reason : '',
                   _isTeacher: true, _role: t['êµ¬ë¶„'], _class: t['ë‹´ë‹¹ í•™ë…„-ë°˜'] || '' };
        });
        return { success: true, data: { students: result, sundays: getSundays2026() } };
      }

      const validStatuses = ['ë“±ë¡','ì‹¬ë°©í•„ìš”']; // ì¥ê²°ìÂ·ìœ í•™ì¤‘Â·ìƒˆì¹œêµ¬ ì¶œì„ëª©ë¡ ì œì™¸
      const studs = _demo.students
        .filter(s => s['í•™ë…„-ë°˜'] === cls && validStatuses.includes(s['ìƒíƒœ']))
        .sort((a,b) => a['ì´ë¦„'].localeCompare(b['ì´ë¦„'],'ko'));
      const saved = _demo.attendance[key] || [];
      const result = studs.map(s => {
        const prev = saved.find(r => r.studentId === s['í•™ìƒID']);
        return { studentId: s['í•™ìƒID'], name: s['ì´ë¦„'], classGroup: cls,
                 status: prev ? prev.status : 'ë¯¸ì²´í¬', reason: prev ? prev.reason : '' };
      });
      return { success: true, data: { students: result, sundays: getSundays2026() } };
    }

    case 'saveAttendance': {
      const key = `${payload.date}_${payload.classGroup}`;
      _demo.attendance[key] = payload.records;
      return { success: true, data: null, message: 'ì¶œì„ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.' };
    }

    case 'getAttendanceHistory': {
      const sid = payload.studentId;
      const beforeDate = payload.beforeDate;
      const weeks = payload.weeks || 12;
      const history = [];
      Object.keys(_demo.attendance)
        .filter(k => k.slice(0,10) <= beforeDate)
        .sort((a,b) => b.localeCompare(a))
        .forEach(k => {
          (_demo.attendance[k] || []).filter(r => r.studentId === sid)
            .forEach(r => history.push({ date: k.slice(0,10), status: r.status, reason: r.reason||'' }));
        });
      return { success: true, data: history.slice(0, weeks) };
    }

    case 'getAttendanceTable': {
      const mode   = payload.mode || 'student';
      const filter = payload.classFilter || '';
      const sundays = getSundays2026().slice(0, 10); // ìµœê·¼ 10ì£¼

      if (mode === 'teacher') {
        const rows = _demo.teachers.map(t => ({
          id: t['êµì‚¬ID'], name: t['ì´ë¦„'], cls: t['ë‹´ë‹¹ í•™ë…„-ë°˜']||'',
          values: {}
        }));
        // ì €ì¥ëœ ì¶œì„ ë°ì´í„° ì ìš©
        sundays.forEach(d => {
          const key = `${d}___teachers__`;
          const saved = _demo.attendance[`${d}___teachers__`] || [];
          rows.forEach(row => {
            const rec = saved.find(r => r.studentId === row.id);
            if (rec) row.values[d] = rec.status === 'ì¶œì„' ? 'o' : (rec.status === 'ê²°ì„' ? ('ê²°ì„'+(rec.reason?`(${rec.reason})`:'')) : '');
          });
        });
        return { success: true, data: { dates: sundays, rows } };
      }

      // í•™ìƒ ëª¨ë“œ
      let students = _demo.students.filter(s => ['ë“±ë¡','ì‹¬ë°©í•„ìš”'].includes(s['ìƒíƒœ']));
      if (filter) students = students.filter(s => s['í•™ë…„-ë°˜'] === filter);
      const rows = students.map(s => ({
        id: s['í•™ìƒID'], name: s['ì´ë¦„'], cls: filter ? '' : s['í•™ë…„-ë°˜'],
        values: {}
      }));
      sundays.forEach(d => {
        const cls = filter || '__all__';
        const key = `${d}_${filter}`;
        (_demo.attendance[key] || []).forEach(rec => {
          const row = rows.find(r => r.id === rec.studentId);
          if (row) row.values[d] = rec.status === 'ì¶œì„' ? 'o' : (rec.status === 'ê²°ì„' ? ('ê²°ì„'+(rec.reason?`(${rec.reason})`:'')) : '');
        });
      });
      return { success: true, data: { dates: sundays, rows } };
    }

    case 'getAttendanceStats': {
      const stats = [];
      const allSundayList = getSundays2026();
      // ë“±ë¡ ê¸°ì¤€ ì´ ì¬ì  (ë“±ë¡+ì‹¬ë°©í•„ìš”, ì¥ê²°ìÂ·ìœ í•™ì¤‘ ì œì™¸)
      const registered = _demo.students.filter(s => s['ìƒíƒœ']==='ë“±ë¡' || s['ìƒíƒœ']==='ì‹¬ë°©í•„ìš”');
      const totalReg = registered.length;
      allSundayList.forEach(date => {
        const allKeys = Object.keys(_demo.attendance).filter(k => k.startsWith(date + '_'));
        if (!allKeys.length) return;
        let present = 0;
        allKeys.forEach(key => {
          const cls = key.slice(11);
          if (cls === '__teachers__') return;
          (_demo.attendance[key] || []).forEach(r => {
            if (r.status === 'ì¶œì„') present++;
          });
        });
        stats.push({ date, total: totalReg, present, rate: totalReg ? Math.round(present/totalReg*100) : 0 });
      });
      // ì¶œì„ ê¸°ë¡ì´ ìˆëŠ” ë‚ ì§œë§Œ ë°˜í™˜
      return { success: true, data: stats.filter(s => s.present > 0 || Object.keys(_demo.attendance).some(k=>k.startsWith(s.date+'_'))) };
    }

    case 'updateNewbieAtt': {
      const n = _demo.newbies.find(n=>n['í•™ìƒID']===payload.studentId);
      if (!n) return {success:false, message:'í•™ìƒì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'};
      n[`${payload.weekNum}ì£¼ì°¨ë‚ ì§œ`] = payload.date;
      n[`${payload.weekNum}ì£¼ì°¨ì¶œê²°`] = payload.status;
      return {success:true, data:null, message:'ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.'};
    }

    case 'assignToClass': {
      // ìƒˆì¹œêµ¬ëŠ” _newbieStudents ë˜ëŠ” students ì–´ë””ì„œë“  ì°¾ê¸°
      let s = _demo.students.find(s=>s['í•™ìƒID']===payload.studentId);
      if (!s) s = (_demo._newbieStudents||[]).find(s=>s['í•™ìƒID']===payload.studentId);
      if (!s) {
        // ì´ë¦„ìœ¼ë¡œ fallback ê²€ìƒ‰
        const n = _demo.newbies.find(n=>n['í•™ìƒID']===payload.studentId);
        if (n) {
          s = {í•™ìƒID:payload.studentId,ì´ë¦„:n['ì´ë¦„'],['í•™ë…„-ë°˜']:'ìƒˆì¹œêµ¬',ë‹´ì„êµì‚¬:'',ì„±ë³„:'',ë‚˜ì´:'',ìƒë…„ì›”ì¼:'',ë³¸ì¸ì—°ë½ì²˜:'',í•™ë¶€ëª¨ì—°ë½ì²˜:'',ìƒíƒœ:'ìƒˆì¹œêµ¬',ì£¼ì†Œ:''};
          _demo.students.push(s);
        }
      }
      if (!s) return {success:false, message:'í•™ìƒì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'};
      s['í•™ë…„-ë°˜'] = payload.targetClass;
      s['ìƒíƒœ'] = 'ë“±ë¡';
      // students ë°°ì—´ì— ì—†ì—ˆìœ¼ë©´ ì¶”ê°€
      if (!_demo.students.find(st=>st['í•™ìƒID']===payload.studentId)) _demo.students.push(s);
      // ìƒˆì¹œêµ¬ ëª©ë¡ì—ì„œ ì™„ì „ ì œê±°
      _demo.newbies = _demo.newbies.filter(n => n['í•™ìƒID'] !== payload.studentId);
      if (_demo._newbieStudents) _demo._newbieStudents = _demo._newbieStudents.filter(st=>st['í•™ìƒID']!==payload.studentId);
      return {success:true, data:{studentName:s['ì´ë¦„'],targetClass:payload.targetClass}, message:`${s['ì´ë¦„']} í•™ìƒì´ ${payload.targetClass}ë°˜ì— ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`};
    }

    case 'addStudent': {
      const id = _demoGenId('S');
      const s = {
        í•™ìƒID:id, ì´ë¦„:payload.name,
        ['í•™ë…„-ë°˜']:payload.classGroup||'ìƒˆì¹œêµ¬',
        ë‹´ì„êµì‚¬:payload.teacher||'', ì„±ë³„:payload.gender||'',
        ë‚˜ì´:payload.age||'', ìƒë…„ì›”ì¼:payload.birthdate||'',
        ë³¸ì¸ì—°ë½ì²˜:payload.contact||'', í•™ë¶€ëª¨ì—°ë½ì²˜:payload.parentContact||'',
        ìƒíƒœ:payload.status||'ìƒˆì¹œêµ¬', ì£¼ì†Œ:payload.address||''
      };
      _demo.students.push(s);
      if (s['ìƒíƒœ']==='ìƒˆì¹œêµ¬') {
        _demo.newbies.push({í•™ìƒID:id,ì´ë¦„:s['ì´ë¦„'],
          '1ì£¼ì°¨ë‚ ì§œ':'','1ì£¼ì°¨ì¶œê²°':'','2ì£¼ì°¨ë‚ ì§œ':'','2ì£¼ì°¨ì¶œê²°':'',
          '3ì£¼ì°¨ë‚ ì§œ':'','3ì£¼ì°¨ì¶œê²°':'','4ì£¼ì°¨ë‚ ì§œ':'','4ì£¼ì°¨ì¶œê²°':'',
          ë°˜ë°°ì •ì™„ë£Œì—¬ë¶€:'FALSE'});
      }
      return {success:true, data:{id}, message:'í•™ìƒì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.'};
    }

    case 'updateStudent': {
      const idx = _demo.students.findIndex(s=>s['í•™ìƒID']===payload.id);
      if (idx<0) return {success:false, message:'í•™ìƒì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'};
      _demo.students[idx] = {
        í•™ìƒID:payload.id, ì´ë¦„:payload.name,
        ['í•™ë…„-ë°˜']:payload.classGroup, ë‹´ì„êµì‚¬:payload.teacher,
        ì„±ë³„:payload.gender, ë‚˜ì´:payload.age, ìƒë…„ì›”ì¼:payload.birthdate,
        ë³¸ì¸ì—°ë½ì²˜:payload.contact,
        'í•™ë¶€ëª¨ì—°ë½ì²˜(ë¶€)':payload.parentContactFather||payload.parentContact||'',
        'í•™ë¶€ëª¨ì—°ë½ì²˜(ëª¨)':payload.parentContactMother||'',
        í•™ë¶€ëª¨ì—°ë½ì²˜:payload.parentContactFather||payload.parentContact||'',
        ìƒíƒœ:payload.status, ì£¼ì†Œ:payload.address||''
      };
      return {success:true, data:null, message:'ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.'};
    }

    case 'deleteStudent': {
      const before = _demo.students.length;
      _demo.students = _demo.students.filter(s=>s['í•™ìƒID']!==payload.id);
      _demo.newbies  = _demo.newbies.filter(n=>n['í•™ìƒID']!==payload.id);
      return _demo.students.length<before
        ? {success:true, data:null, message:'ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.'}
        : {success:false, message:'í•™ìƒì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'};
    }

    case 'addTeacher': {
      const id = _demoGenId('T');
      _demo.teachers.push({êµì‚¬ID:id,ì´ë¦„:payload.name,['ë‹´ë‹¹ í•™ë…„-ë°˜']:payload.classGroup||'',ì—°ë½ì²˜:payload.contact||'',êµ¬ë¶„:payload.role||'ë‹´ì„',ìƒë…„ì›”ì¼:payload.birthdate||'',ì£¼ì†Œ:payload.address||''});
      return {success:true, data:{id}, message:'êµì‚¬ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.'};
    }

    case 'updateTeacher': {
      const idx = _demo.teachers.findIndex(t=>t['êµì‚¬ID']===payload.id);
      if (idx<0) return {success:false, message:'êµì‚¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'};
      _demo.teachers[idx] = {êµì‚¬ID:payload.id,ì´ë¦„:payload.name,['ë‹´ë‹¹ í•™ë…„-ë°˜']:payload.classGroup||'',ì—°ë½ì²˜:payload.contact||'',êµ¬ë¶„:payload.role||'ë‹´ì„',ìƒë…„ì›”ì¼:payload.birthdate||'',ì£¼ì†Œ:payload.address||''};
      return {success:true, data:null, message:'ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.'};
    }

    case 'deleteTeacher': {
      _demo.teachers = _demo.teachers.filter(t=>t['êµì‚¬ID']!==payload.id);
      return {success:true, data:null, message:'ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.'};
    }

    // êµ¬ê¸€ í¼ ì—°ë™ (ë°ëª¨: ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ ì‹œë®¬ë ˆì´ì…˜)
    case 'getFormNewbies': return {success:true, data:[], message:'ë°ëª¨ ëª¨ë“œ'};
    case 'syncFormResponses': return {success:true, data:{added:0}, message:'ë°ëª¨ ëª¨ë“œ - ì‹¤ì œ GAS ì—°ê²° í›„ ë™ì‘í•©ë‹ˆë‹¤.'};

    default: return {success:false, message:'ì•Œ ìˆ˜ ì—†ëŠ” ì•¡ì…˜: '+action};
  }
}

// 2026 ì¼ìš”ì¼ ê³„ì‚° (í´ë¼ì´ì–¸íŠ¸ì¸¡)
// íƒ€ì„ì¡´ ì˜¤í”„ì…‹ ì—†ì´ ë¡œì»¬ ë‚ ì§œë¥¼ 'YYYY-MM-DD' í˜•ì‹ìœ¼ë¡œ ë°˜í™˜
function toLocalDateStr(d) {
  return d.getFullYear() + '-' +
    String(d.getMonth() + 1).padStart(2, '0') + '-' +
    String(d.getDate()).padStart(2, '0');
}

// ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ë¡œì»¬ ê¸°ì¤€ 'YYYY-MM-DD'ë¡œ ë°˜í™˜
function todayLocalStr() {
  return toLocalDateStr(new Date());
}

function getSundays2026() {
  const sundays = [];
  // 2026ë…„ 3ì›” 1ì¼(ì¼ìš”ì¼) ì‹œì‘ ~ 2027ë…„ 2ì›” 28ì¼(ì¼ìš”ì¼) ì¢…ë£Œ
  const d     = new Date(2026, 2, 1);  // 2026-03-01
  const end   = new Date(2027, 1, 28); // 2027-02-28
  while (d <= end) {
    if (d.getDay() === 0) sundays.push(toLocalDateStr(d));
    d.setDate(d.getDate() + (d.getDay() === 0 ? 7 : 7 - d.getDay()));
  }
  return sundays;
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ë¡œê·¸ì¸ / ì¸ì¦
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// êµì‚¬ ì´ë¦„ìœ¼ë¡œ ë¡œê·¸ì¸
// â”€â”€ STEP 1: ì´ë¦„ í™•ì¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// â”€â”€ STEP 1: ì´ë¦„(ì•„ì´ë””) í™•ì¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function checkLoginName() {
  if (!allTeachers.length) {
    try { await loadTeachers(); } catch(e) { console.warn('checkLoginName loadTeachers:', e); }
  }
  clearLoginError();

  const name = document.getElementById('loginName').value.trim();
  if (!name) { showLoginError('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }

  // êµì—­ì ë˜ëŠ” êµì‚¬ëª…ë‹¨ì— ìˆëŠ”ì§€ í™•ì¸
  const isAdmin   = isAdminName(name);
  // ì´ë¦„ ì •ê·œí™” ë¹„êµ (ê³µë°± ì œê±°)
  const normName  = name.replace(/\s/g, '');
  const teacher   = allTeachers.find(t => {
    const tn = String(t['ì´ë¦„'] || '').replace(/\s/g, '');
    return tn === normName;
  });
  const isAdminByRole = teacher && hasRole(teacher, ADMIN_ROLES);

  if (!isAdmin && !isAdminByRole && !teacher) {
    // GAS ì—°ê²° ì‹¤íŒ¨ë¡œ allTeachersê°€ ë¹„ì–´ìˆìœ¼ë©´ êµì—­ìì—ê²Œ íŒíŠ¸ ì œê³µ
    const hint = !allTeachers.length ? '\n(GAS ì—°ê²° í™•ì¸ í•„ìš”. êµì—­ìëŠ” ADMIN_NAMESì— ì´ë¦„ í™•ì¸)' : '';
    showLoginError(`"${name}" ì„ ìƒë‹˜ì„ ëª…ë‹¨ì—ì„œ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nì´ë¦„ì„ ë‹¤ì‹œ í™•ì¸í•´ ì£¼ì„¸ìš”.${hint}`);
    return;
  }

  // ì—­í•  íŒíŠ¸ í…ìŠ¤íŠ¸
  let roleHint = 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”  (ì´ˆê¸°: 1234)';
  if (isAdmin) roleHint = 'ğŸ”‘ êµì—­ì Â· ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”';
  else if (teacher) {
    const r = getTeacherRole(teacher);
    roleHint = r === 'leadership' ? 'â­ ë¦¬ë”ì‹­' :
               r === 'newbie_teacher' ? 'ğŸŒ± ìƒˆì¹œêµ¬êµì‚¬' : 'ğŸ“‹ ë‹´ì„êµì‚¬';
    roleHint += ' Â· ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”  (ì´ˆê¸°: 1234)';
  }

  document.getElementById('loginStep1').style.display = 'none';
  document.getElementById('loginStep2').style.display = 'block';
  document.getElementById('loginNameDisplay').textContent = name;
  document.getElementById('loginAvatar').textContent = name.charAt(0);
  document.getElementById('loginRoleHint').textContent = roleHint;
  document.getElementById('loginSubtitle').textContent = 'ë¹„ë°€ë²ˆí˜¸ ì…ë ¥';
  setTimeout(() => document.getElementById('loginPw').focus(), 100);
}

// â”€â”€ STEP 2: ë¹„ë°€ë²ˆí˜¸ í™•ì¸ (ì „ì²´ ì‚¬ìš©ì ê³µí†µ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function doLoginWithPw() {
  clearLoginError();
  const name = document.getElementById('loginName').value.trim();
  const pw   = document.getElementById('loginPw').value;

  if (!pw) { showLoginError('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }

  // ë¡œê·¸ì¸ ë²„íŠ¼ ë¹„í™œì„±í™” (ì¤‘ë³µ í´ë¦­ ë°©ì§€)
  const loginBtn = document.querySelector('#loginStep2 .btn-primary');
  if (loginBtn) { loginBtn.disabled = true; loginBtn.textContent = 'í™•ì¸ ì¤‘â€¦'; }

  const match = await verifyUserPasswordAsync(name, pw);

  if (loginBtn) { loginBtn.disabled = false; loginBtn.textContent = 'ë¡œê·¸ì¸ â†’'; }

  if (!match) {
    showLoginError('ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
    document.getElementById('loginPw').value = '';
    document.getElementById('loginPw').focus();
    return;
  }

  // ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ â†’ ì—­í•  ê²°ì • í›„ ë¡œê·¸ì¸
  const isAdmin = isAdminName(name);
  const normName = name.replace(/\s/g,'');
  const teacher = allTeachers.find(t => String(t['ì´ë¦„']||'').replace(/\s/g,'') === normName);
  const isAdminByRole = teacher && hasRole(teacher, ADMIN_ROLES);

  if (isAdmin || isAdminByRole) {
    currentUser = {
      name, role: 'admin',
      classGroup: teacher ? (teacher['ë‹´ë‹¹ í•™ë…„-ë°˜'] || '') : '',
      teacherObj: teacher || null
    };
  } else {
    currentUser = {
      name: teacher['ì´ë¦„'],
      role: getTeacherRole(teacher),
      classGroup: teacher['ë‹´ë‹¹ í•™ë…„-ë°˜'] || '',
      teacherObj: teacher
    };
  }
  completeLogin();
}

function backToStep1() {
  clearLoginError();
  document.getElementById('loginStep2').style.display = 'none';
  document.getElementById('loginStep1').style.display = 'block';
  document.getElementById('loginPw').value = '';
  document.getElementById('loginSubtitle').textContent = 'ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”';
  setTimeout(() => document.getElementById('loginName').focus(), 100);
}

function togglePwVisible() {
  const inp = document.getElementById('loginPw');
  const btn = document.getElementById('pwToggleBtn');
  if (inp.type === 'password') { inp.type = 'text'; btn.textContent = 'ğŸ™ˆ'; }
  else { inp.type = 'password'; btn.textContent = 'ğŸ‘'; }
}

// â”€â”€ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ëª¨ë‹¬ (ì „ì²´ ì‚¬ìš©ì) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openChangePwModal() {
  let modal = document.getElementById('changePwModal');
  if (!modal) {
    const div = document.createElement('div');
    div.className = 'modal-backdrop';
    div.id = 'changePwModal';
    div.innerHTML = `
      <div class="modal" style="max-width:340px;">
        <div class="modal-header">
          <div class="modal-title">ğŸ”‘ ë‚´ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</div>
          <button class="modal-close" onclick="closeModal('changePwModal')">âœ•</button>
        </div>
        <div class="modal-body" style="display:grid;gap:12px;">
          <div style="font-size:.82rem;color:var(--gray-500);padding:8px 10px;background:var(--gray-50);border-radius:8px;">
            ğŸ‘¤ <b id="pwModalName"></b> ë‹˜ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•©ë‹ˆë‹¤.
          </div>
          <div class="form-group">
            <label class="form-label">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
            <input class="form-control" id="pwCurrent" type="password" placeholder="í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ (ì´ˆê¸°: 1234)">
          </div>
          <div class="form-group">
            <label class="form-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
            <input class="form-control" id="pwNew" type="password" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ (4ì ì´ìƒ)">
          </div>
          <div class="form-group">
            <label class="form-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
            <input class="form-control" id="pwConfirm" type="password" placeholder="ë‹¤ì‹œ ì…ë ¥">
          </div>
          <div id="pwChangeError" style="display:none;color:var(--danger);font-size:.8rem;padding:6px 10px;background:#FEE2E2;border-radius:6px;"></div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-outline" style="flex:1" onclick="closeModal('changePwModal')">ì·¨ì†Œ</button>
          <button class="btn btn-primary" style="flex:2" onclick="submitChangePw()">ë³€ê²½í•˜ê¸°</button>
        </div>
      </div>`;
    document.body.appendChild(div);
    modal = div;
  }
  document.getElementById('pwModalName').textContent = currentUser ? currentUser.name : '';
  document.getElementById('pwCurrent').value = '';
  document.getElementById('pwNew').value = '';
  document.getElementById('pwConfirm').value = '';
  document.getElementById('pwChangeError').style.display = 'none';
  openModal('changePwModal');
}

async function submitChangePw() {
  const name    = currentUser ? currentUser.name : '';
  const cur     = document.getElementById('pwCurrent').value;
  const nw      = document.getElementById('pwNew').value;
  const confirm = document.getElementById('pwConfirm').value;
  const errEl   = document.getElementById('pwChangeError');
  const showErr = (msg) => { errEl.textContent = msg; errEl.style.display = 'block'; };

  if (nw.length < 4)  { showErr('ìƒˆ ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.'); return; }
  if (nw !== confirm) { showErr('ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'); return; }

  // í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ (async)
  const match = await verifyUserPasswordAsync(name, cur);
  if (!match) { showErr('í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.'); return; }

  // ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì €ì¥ (GAS + ë¡œì»¬)
  const saveBtn = document.querySelector('#changePwModal .btn-primary');
  if (saveBtn) { saveBtn.disabled = true; saveBtn.textContent = 'ì €ì¥ ì¤‘â€¦'; }
  await setUserPasswordAsync(name, nw);
  if (saveBtn) { saveBtn.disabled = false; saveBtn.textContent = 'ë³€ê²½í•˜ê¸°'; }

  closeModal('changePwModal');
  showToast('âœ… ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤! (ëª¨ë“  ê¸°ê¸°ì— ì ìš©)', 'success');
}

function showLoginError(msg) {
  const el = document.getElementById('loginError');
  el.textContent = msg; el.style.display = 'block';
}
function clearLoginError() {
  const el = document.getElementById('loginError');
  if (el) el.style.display = 'none';
}

function completeLogin() {
  // localStorageì— ë¡œê·¸ì¸ ì •ë³´ ì €ì¥ (ìë™ ë¡œê·¸ì¸ìš©)
  try {
    localStorage.setItem('churchUser', JSON.stringify({
      _version:   APP_SESSION_VERSION,
      name:       currentUser.name,
      role:       currentUser.role,
      classGroup: currentUser.classGroup
    }));
  } catch(e) {}

  // ë¡œê·¸ì¸ í™”ë©´ ìˆ¨ê¹€
  document.getElementById('loginScreen').style.display = 'none';

  // í—¤ë” ìœ ì € ì¹© ì—…ë°ì´íŠ¸
  updateUserChip();

  // ì—­í• ë³„ íƒ­ ì ìš©
  applyRoleNav();

  // ì•± ì´ˆê¸°í™”
  init();
}

// ì—­í• ì— ë”°ë¼ í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ íƒ­ í‘œì‹œ/ìˆ¨ê¹€
function applyRoleNav() {
  if (!currentUser) return;
  const allowed = ROLE_TABS[currentUser.role] || ROLE_TABS.teacher;
  document.querySelectorAll('.nav-btn').forEach(btn => {
    const view = btn.dataset.view;
    btn.style.display = allowed.includes(view) ? '' : 'none';
  });
  // ì²« ë²ˆì§¸ í—ˆìš© íƒ­ì„ í™œì„±í™”
  const firstAllowed = allowed[0];
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  const firstBtn = document.querySelector(`.nav-btn[data-view="${firstAllowed}"]`);
  if (firstBtn) firstBtn.classList.add('active');
  const firstView = document.getElementById(`view-${firstAllowed}`);
  if (firstView) firstView.classList.add('active');
}

function updateUserChip() {
  if (!currentUser) return;
  const isAdmin    = currentUser.role === 'admin';
  const isNewbie   = currentUser.role === 'newbie_teacher';
  const isLeader   = currentUser.role === 'leadership';
  document.getElementById('userAvatar').textContent    = currentUser.name.charAt(0);
  document.getElementById('userName').textContent      = currentUser.name;
  document.getElementById('userRoleBadge').textContent =
    isAdmin  ? 'ğŸ”‘ êµì—­ì' :
    isNewbie ? 'ğŸŒ± ìƒˆì¹œêµ¬êµì‚¬' :
    isLeader ? 'â­ ë¦¬ë”ì‹­' : (() => {
      const role = currentUser.teacherObj ? (currentUser.teacherObj['êµ¬ë¶„'] || '') : '';
      const emoji = role.includes('ë¶€ë‹´ì„') ? 'ğŸ“‹ ë¶€ë‹´ì„' : 'ğŸ“‹ ë‹´ì„';
      const cls   = currentUser.classGroup || '';
      return cls ? `${emoji} Â· ${cls}` : emoji;
    })();

  // ëª¨ë“  ë¡œê·¸ì¸ ì‚¬ìš©ìì—ê²Œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ë²„íŠ¼ í‘œì‹œ
  const pwBtn = document.getElementById('changePwBtn');
  if (pwBtn) pwBtn.style.display = 'flex';
}

function doLogout() {
  if (!confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
  try { localStorage.removeItem('churchUser'); } catch(e) {}
  // adminPwëŠ” ìœ ì§€ (ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ë‚´ìš© ë³´ì¡´)
  currentUser = null;
  allStudents = []; allTeachers = []; allNewbies = [];
  document.getElementById('loginName').value = '';
  document.getElementById('loginError').style.display = 'none';
  document.getElementById('loginScreen').style.display = 'flex';
  // íƒ­ ì „ë¶€ ë³µì› (ë‹¤ìŒ ë¡œê·¸ì¸ ì „ê¹Œì§€ ë³´ì´ê²Œ)
  document.querySelectorAll('.nav-btn').forEach(b => b.style.display = '');
  // ì¶œì„ í™”ë©´ ì´ˆê¸°í™”
  document.getElementById('attList').innerHTML = '';
  document.getElementById('attSaveArea').style.display = 'none';
  document.getElementById('attDateBanner').style.display = 'none';
  const lb = document.getElementById('attLockBanner');
  if (lb) lb.remove();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì´ˆê¸°í™”
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function init() {
  allSundays = getSundays2026();
  filterMonth = new Date().getMonth() + 1;
  sermonWeekIdx = findNearestSundayIdx();
  // í•™ìƒ/êµì‚¬/ìƒˆì¹œêµ¬ + ê³µì§€/ì‚¬ì—­ì¼ì •/ì„¤êµë¥¼ ë™ì‹œì— ë¡œë“œ
  await Promise.all([
    loadStudents(), loadTeachers(), loadNewbies(),
    _preloadCalloutData()  // ê³µì§€Â·ì‚¬ì—­ì¼ì • GASì—ì„œ ë¯¸ë¦¬ ë¡œë“œ
  ]);
  setupAttendanceDateSelect();
  renderDashboard();
  renderRecords();
  renderNewbieList();
  loadAttendanceStats();
  // í˜„ì¬ ì£¼ ì„¤êµ ë°ì´í„° GASì—ì„œ ë¹„ë™ê¸° ë¡œë“œ (UI í›„ì— ì—…ë°ì´íŠ¸)
  _loadSermonFromGAS();
}

// ê³µì§€Â·ì‚¬ì—­ì¼ì • GAS ë¯¸ë¦¬ ë¡œë“œ (ìºì‹œì— ì €ì¥)
async function _preloadCalloutData() {
  if (!GAS_URL) return;
  try {
    const keys = ['notices', 'schedules'];
    await Promise.all(keys.map(async k => {
      const r = await callGAS('getAppData', { key: k });
      if (r && r.success && Array.isArray(r.data)) {
        _calloutCache[k] = r.data;
        try { sessionStorage.setItem('callout_' + k, JSON.stringify(r.data)); } catch(e) {}
      }
    }));
  } catch(e) { console.warn('_preloadCalloutData ì˜¤ë¥˜:', e); }
}

// í˜„ì¬ ì£¼ ì„¤êµ GASì—ì„œ ë¡œë“œ í›„ ë Œë”ë§
async function _loadSermonFromGAS() {
  if (!GAS_URL) return;
  try {
    const dateStr = allSundays[sermonWeekIdx];
    if (!dateStr) return;
    const r = await callGAS('getAppData', { key: 'sermon_' + dateStr });
    if (r && r.success && r.data && typeof r.data === 'object' && Object.keys(r.data).length > 0) {
      try { localStorage.setItem('sermon_' + dateStr, JSON.stringify(r.data)); } catch(e) {}
      renderSermon(); // GAS ë°ì´í„°ë¡œ ì¬ë Œë”ë§
    }
  } catch(e) { console.warn('_loadSermonFromGAS ì˜¤ë¥˜:', e); }
}

// â”€â”€ GAS ì—°ê²° ì—¬ë¶€ì™€ ìƒê´€ì—†ì´ ë°ì´í„° ë¡œë“œ (ì‹¤íŒ¨ ì‹œ ë°ëª¨ í´ë°±) â”€
async function _loadWithFallback(action, globalVar, setter) {
  try {
    const r = await callGAS(action);
    if (r && r.success && Array.isArray(r.data) && r.data.length > 0) {
      setter(r.data);
      return;
    }
    // GAS ì‘ë‹µì€ ì™”ì§€ë§Œ success:false ë˜ëŠ” ë¹ˆ ë°°ì—´ â†’ ë°ëª¨ í´ë°±
    console.warn(action + ' ì‘ë‹µ ì‹¤íŒ¨/ë¹ˆ ë°°ì—´, ë°ëª¨ ë°ì´í„°ë¡œ í´ë°±:', r && r.message);
  } catch(e) {
    console.warn(action + ' ì˜ˆì™¸ ë°œìƒ, ë°ëª¨ ë°ì´í„°ë¡œ í´ë°±:', e);
  }
  // í´ë°±: ë°ëª¨ ë°ì´í„° ì‚¬ìš©
  if (globalVar.length === 0) {
    const d = getDemoData(action, {});
    if (d.success) setter(d.data);
  }
}
async function loadStudents() { await _loadWithFallback('getStudents', allStudents, d => { allStudents = d; }); }
async function loadTeachers() { await _loadWithFallback('getTeachers', allTeachers, d => { allTeachers = d; }); }
async function loadNewbies()  { await _loadWithFallback('getNewbies',  allNewbies,  d => { allNewbies  = d; }); }


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ê³µì§€ì‚¬í•­ & ì‚¬ì—­ì¼ì • ì½œì•„ì›ƒ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// ë°ì´í„° ì €ì¥ì†Œ (sessionStorage í™œìš©)
// â”€â”€ ê³µì§€Â·ì‚¬ì—­ì¼ì • ë°ì´í„° ë¡œë“œ (GAS ì•±ë°ì´í„° â†’ sessionStorage ìºì‹œ) â”€â”€
const _calloutCache = {}; // { key: data } ì„¸ì…˜ ë‚´ ìºì‹œ

async function loadCalloutDataAsync(key) {
  if (_calloutCache[key] !== undefined) return _calloutCache[key];
  // sessionStorage ìºì‹œ ìš°ì„ 
  try {
    const cached = sessionStorage.getItem('callout_' + key);
    if (cached) { _calloutCache[key] = JSON.parse(cached); return _calloutCache[key]; }
  } catch(e) {}
  // GASì—ì„œ ë¡œë“œ
  if (GAS_URL) {
    try {
      const r = await callGAS('getAppData', { key });
      if (r && r.success && Array.isArray(r.data)) {
        _calloutCache[key] = r.data;
        try { sessionStorage.setItem('callout_' + key, JSON.stringify(r.data)); } catch(e) {}
        return r.data;
      }
    } catch(e) { console.warn('loadCalloutDataAsync GAS ì˜¤ë¥˜:', e); }
  }
  // ë¡œì»¬ í´ë°±
  try {
    const local = sessionStorage.getItem(key) || sessionStorage.getItem('callout_' + key);
    if (local) return JSON.parse(local);
  } catch(e) {}
  return [];
}

function loadCalloutData(key) {
  // ë™ê¸° í´ë°±: ìºì‹œ ë˜ëŠ” sessionStorage
  if (_calloutCache[key] !== undefined) return _calloutCache[key];
  try { return JSON.parse(sessionStorage.getItem('callout_' + key) || sessionStorage.getItem(key) || '[]'); } catch(e) { return []; }
}
function saveCalloutData(key, arr) {
  // ì¦‰ì‹œ ìºì‹œ ì—…ë°ì´íŠ¸
  _calloutCache[key] = arr;
  try { sessionStorage.setItem('callout_' + key, JSON.stringify(arr)); } catch(e) {}
  // GASì— ë¹„ë™ê¸° ì €ì¥
  if (GAS_URL) {
    callGAS('setAppData', { key, value: arr }).catch(e => console.warn('saveCalloutData GAS ì˜¤ë¥˜:', e));
  }
}

// ì½œì•„ì›ƒ ì—´ê¸°/ë‹«ê¸° í† ê¸€

// â”€â”€ êµì—­ì ì „ìš©: íƒ€ì¸ ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function adminResetPassword(targetName) {
  if (!currentUser || currentUser.role !== 'admin') {
    showToast('êµì—­ìë§Œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì´ˆê¸°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'error');
    return;
  }
  if (!confirm(`"${targetName}" ë‹˜ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ 1234ë¡œ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;

  const ok = await resetUserPasswordAsync(targetName);
  if (ok) {
    showToast(`âœ… "${targetName}" ë¹„ë°€ë²ˆí˜¸ê°€ 1234ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
  } else {
    showToast('ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
  }
}

// êµì—­ì í™ˆ â†’ ì„¤ì •ì—ì„œ ì „ì²´ ì´ˆê¸°í™” ëª©ë¡
function openPwResetPanel() {
  if (!currentUser || currentUser.role !== 'admin') return;
  let modal = document.getElementById('pwResetPanel');
  if (!modal) {
    modal = document.createElement('div');
    modal.className = 'modal-backdrop';
    modal.id = 'pwResetPanel';
    document.body.appendChild(modal);
    modal.addEventListener('click', e => { if (e.target === modal) closeModal('pwResetPanel'); });
  }
  const list = allTeachers.map(t => `
    <div style="display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid var(--gray-100);">
      <span style="flex:1;font-size:.88rem;font-weight:600;">${t['ì´ë¦„']}</span>
      <span style="font-size:.72rem;color:var(--gray-400);">${t['êµ¬ë¶„']||''}</span>
      <button class="btn btn-outline btn-sm" style="color:var(--danger);border-color:var(--danger);"
        onclick="adminResetPassword('${t['ì´ë¦„']}')">ì´ˆê¸°í™”</button>
    </div>`).join('');

  modal.innerHTML = `
    <div class="modal" style="max-width:380px;max-height:80vh;display:flex;flex-direction:column;">
      <div class="modal-header">
        <div class="modal-title">ğŸ”‘ ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” (êµì—­ì ì „ìš©)</div>
        <button class="modal-close" onclick="closeModal('pwResetPanel')">âœ•</button>
      </div>
      <div style="padding:10px 16px;background:#FEF9C3;font-size:.78rem;color:#92400E;border-bottom:1px solid var(--gray-100);">
        âš ï¸ ì´ˆê¸°í™”í•˜ë©´ í•´ë‹¹ ì„ ìƒë‹˜ì˜ ë¹„ë°€ë²ˆí˜¸ê°€ <b>1234</b>ë¡œ ë³€ê²½ë©ë‹ˆë‹¤.
      </div>
      <div class="modal-body" style="overflow-y:auto;flex:1;">${list}</div>
      <div class="modal-footer">
        <button class="btn btn-outline" style="flex:1" onclick="closeModal('pwResetPanel')">ë‹«ê¸°</button>
      </div>
    </div>`;
  openModal('pwResetPanel');
}

// â”€â”€ í™ˆ íƒ­ ìƒì¼ ì„¹ì…˜ ì ‘ê¸°/í¼ì¹˜ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let _birthdayOpen = true;
function toggleBirthdaySection() {
  const outer = document.getElementById('birthdayCollapsible');
  const inner  = document.getElementById('birthdayCollapsibleInner');
  const chevron = document.getElementById('birthdayChevron');
  const el = inner || outer;
  if (!el) return;
  _birthdayOpen = !_birthdayOpen;
  el.style.maxHeight = _birthdayOpen ? '3000px' : '0';
  el.style.overflow  = _birthdayOpen ? 'visible' : 'hidden';
  if (chevron) chevron.style.transform = _birthdayOpen ? '' : 'rotate(-90deg)';
}
function toggleCallout(id) {
  document.getElementById(id).classList.toggle('open');
}

// ì¸ë¼ì¸ í¼ ì—´ê¸°/ë‹«ê¸°
function openInlineForm(formId) {
  document.querySelectorAll('.inline-form').forEach(f => f.classList.remove('show'));
  const form = document.getElementById(formId);
  form.classList.add('show');
  // ì˜¤ëŠ˜ ë‚ ì§œ ê¸°ë³¸ê°’
  const dateInput = form.querySelector('input[type=date]');
  if (dateInput && !dateInput.value) dateInput.value = todayLocalStr();
  form.querySelector('input[type=text]').focus();
}
function closeInlineForm(formId) {
  document.getElementById(formId).classList.remove('show');
}

// â”€â”€â”€ ê³µì§€ì‚¬í•­ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function addNotice() {
  if (!currentUser || currentUser.role !== 'admin') { showToast('êµì—­ìë§Œ ê³µì§€ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'error'); return; }
  const text = document.getElementById('noticeInput').value.trim();
  const date = document.getElementById('noticeDate').value;
  if (!text) { document.getElementById('noticeInput').focus(); return; }
  const notices = loadCalloutData('notices');
  notices.unshift({ id: Date.now(), text, date, createdAt: new Date().toISOString() });
  saveCalloutData('notices', notices);
  document.getElementById('noticeInput').value = '';
  closeInlineForm('noticeForm');
  renderNotices();
}

function deleteNotice(id) {
  if (!currentUser || currentUser.role !== 'admin') { showToast('êµì—­ìë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'error'); return; }
  const notices = loadCalloutData('notices').filter(n => n.id !== id);
  saveCalloutData('notices', notices);
  renderNotices();
}

function renderNotices() {
  const notices = loadCalloutData('notices');
  const el = document.getElementById('noticeList');
  const isAdmin = currentUser && currentUser.role === 'admin';
  document.getElementById('noticeBadge').textContent = notices.length;
  if (!notices.length) {
    el.innerHTML = `<div style="padding:10px 0;font-size:.82rem;color:#93C5FD;text-align:center;">ë“±ë¡ëœ ê³µì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
    return;
  }
  el.innerHTML = notices.map(n => `
    <div class="notice-item">
      <div class="notice-dot notice-dot-blue" style="margin-top:6px;"></div>
      <div style="flex:1">
        <div class="notice-text">${escapeHtml(n.text)}</div>
        ${n.date ? `<div class="notice-meta">${formatDateFull(n.date)}</div>` : ''}
      </div>
      ${isAdmin ? `<button onclick="deleteNotice(${n.id})" style="background:none;border:none;cursor:pointer;font-size:.85rem;opacity:.4;padding:2px 4px;flex-shrink:0;" title="ì‚­ì œ">âœ•</button>` : ''}
    </div>`).join('');
}

// â”€â”€â”€ ì‚¬ì—­ì¼ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SCHEDULE_CAT_COLOR = {
  'ì˜ˆë°°':'#16A34A','í–‰ì‚¬':'#D97706','êµì‚¬ëª¨ì„':'#7C3AED','íŠ¹ë³„í™œë™':'#0891B2','ê¸°íƒ€':'#6B7280'
};

// í˜„ì¬ ìº˜ë¦°ë”ê°€ ë³´ì—¬ì£¼ëŠ” ì—°/ì›” ìƒíƒœ
let calYear  = new Date().getFullYear();
let calMonth = new Date().getMonth(); // 0-based

function addSchedule() {
  if (!currentUser || currentUser.role !== 'admin') { showToast('êµì—­ìë§Œ ì¼ì •ì„ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'error'); return; }
  const text = document.getElementById('scheduleInput').value.trim();
  const date = document.getElementById('scheduleDate').value;
  const cat  = document.getElementById('scheduleCategory').value;
  if (!text) { document.getElementById('scheduleInput').focus(); return; }

  // â”€â”€ ì§€ë‚œ ì¼ì • ìë™ ì‚­ì œ: ì €ì¥ ì‹œ ì˜¤ëŠ˜ ì´ì „ í•­ëª© ì œê±° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  purgePastSchedules();

  const schedules = loadCalloutData('schedules');
  schedules.push({ id: Date.now(), text, date, category: cat });
  schedules.sort((a,b) => (a.date||'').localeCompare(b.date||''));
  saveCalloutData('schedules', schedules);
  document.getElementById('scheduleInput').value = '';
  closeInlineForm('scheduleForm');

  // ì¶”ê°€í•œ ì¼ì •ì˜ ë‹¬ë¡œ ìº˜ë¦°ë” ì´ë™
  if (date) {
    const d = new Date(date + 'T00:00:00');
    calYear = d.getFullYear(); calMonth = d.getMonth();
  }
  renderSchedules();
}

// ì˜¤ëŠ˜ ì´ì „ ì¼ì • ìë™ ì‚­ì œ
function purgePastSchedules() {
  const today = new Date();
  today.setHours(0,0,0,0);
  const todayStr = toLocalDateStr(today);
  const schedules = loadCalloutData('schedules').filter(s => !s.date || s.date >= todayStr);
  saveCalloutData('schedules', schedules);
}

function deleteSchedule(id) {
  if (!currentUser || currentUser.role !== 'admin') { showToast('êµì—­ìë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'error'); return; }
  const schedules = loadCalloutData('schedules').filter(s => s.id !== id);
  saveCalloutData('schedules', schedules);
  renderSchedules();
}

function changeCalMonth(delta) {
  calMonth += delta;
  if (calMonth > 11) { calMonth = 0;  calYear++; }
  if (calMonth < 0)  { calMonth = 11; calYear--; }
  // ìƒì„¸ íŒ¨ë„ ë‹«ê¸°
  document.getElementById('calDetail').classList.remove('show');
  renderSchedules();
}

function renderSchedules() {
  // ë Œë” ì „ì— ì§€ë‚œ ì¼ì • ìë™ ì •ë¦¬
  purgePastSchedules();

  const schedules = loadCalloutData('schedules');
  document.getElementById('scheduleBadge').textContent = schedules.length;

  // â”€â”€ ì›” ì œëª© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  document.getElementById('calMonthTitle').textContent =
    `${calYear}ë…„ ${calMonth + 1}ì›”`;

  // â”€â”€ í•´ë‹¹ ì›” ì¼ì • ë§µ { 'YYYY-MM-DD': [items...] } â”€â”€â”€â”€â”€â”€
  const monthStr = `${calYear}-${String(calMonth+1).padStart(2,'0')}`;
  const dayMap = {};
  schedules.forEach(s => {
    if (s.date && s.date.startsWith(monthStr)) {
      if (!dayMap[s.date]) dayMap[s.date] = [];
      dayMap[s.date].push(s);
    }
  });

  // â”€â”€ ê·¸ë¦¬ë“œ ìƒì„± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const firstDay = new Date(calYear, calMonth, 1).getDay(); // 0=ì¼
  const lastDate = new Date(calYear, calMonth + 1, 0).getDate();
  const todayStr = todayLocalStr();

  let cells = '';
  // ì• ë¹ˆì¹¸
  for (let i = 0; i < firstDay; i++) {
    cells += `<div class="cal-day other-month"><div class="cal-day-num"></div></div>`;
  }
  // ë‚ ì§œ ì…€
  for (let d = 1; d <= lastDate; d++) {
    const dateStr = `${calYear}-${String(calMonth+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const isToday = dateStr === todayStr;
    const events  = dayMap[dateStr] || [];
    const dots    = events.slice(0,4).map(e =>
      `<div class="cal-dot" style="background:${SCHEDULE_CAT_COLOR[e.category]||'#6B7280'}"></div>`
    ).join('');
    cells += `
      <div class="cal-day${isToday?' today':''}${events.length?' has-event':''}"
           onclick="${events.length?`showCalDetail('${dateStr}')`:''}"
           title="${events.map(e=>e.text).join(' / ')||''}">
        <div class="cal-day-num">${d}</div>
        ${dots?`<div class="cal-dots">${dots}</div>`:''}
      </div>`;
  }
  // ë’¤ ë¹ˆì¹¸ (6í–‰ ê³ ì •)
  const total = firstDay + lastDate;
  const remainder = total % 7 === 0 ? 0 : 7 - (total % 7);
  for (let i = 0; i < remainder; i++) {
    cells += `<div class="cal-day other-month"><div class="cal-day-num"></div></div>`;
  }
  document.getElementById('calDayGrid').innerHTML = cells;
}

// ë‚ ì§œ í´ë¦­ ì‹œ ì¼ì • ìƒì„¸ í‘œì‹œ
function showCalDetail(dateStr) {
  const schedules = loadCalloutData('schedules').filter(s => s.date === dateStr);
  const detail   = document.getElementById('calDetail');
  const title    = document.getElementById('calDetailTitle');
  const list     = document.getElementById('calDetailList');

  // ê°™ì€ ë‚  ë‹¤ì‹œ í´ë¦­í•˜ë©´ ë‹«ê¸°
  if (detail.classList.contains('show') && title.dataset.date === dateStr) {
    detail.classList.remove('show'); return;
  }
  title.dataset.date = dateStr;
  title.textContent  = formatDateFull(dateStr);

  list.innerHTML = schedules.map(s => {
    const color = SCHEDULE_CAT_COLOR[s.category] || '#6B7280';
    const isAdmin = currentUser && currentUser.role === 'admin';
    return `
    <div class="notice-item">
      <div class="notice-dot" style="background:${color};margin-top:6px;"></div>
      <div style="flex:1">
        <div class="notice-text">${escapeHtml(s.text)}</div>
        <div class="notice-meta" style="display:flex;gap:6px;align-items:center;">
          <span style="background:${color}22;color:${color};padding:1px 7px;border-radius:50px;font-size:.68rem;font-weight:700;">${s.category||''}</span>
        </div>
      </div>
      ${isAdmin ? `<button onclick="deleteSchedule(${s.id})" style="background:none;border:none;cursor:pointer;font-size:.85rem;opacity:.4;padding:2px 4px;" title="ì‚­ì œ">âœ•</button>` : ''}
    </div>`;
  }).join('');

  detail.classList.add('show');
}

function escapeHtml(str) {
  return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

// ìƒíƒœ â†’ ë°°ì§€ í´ë˜ìŠ¤
function statusBadgeClass(status) {
  if (status === 'ë“±ë¡')     return 'badge-green';
  if (status === 'ìƒˆì¹œêµ¬')   return 'badge-amber';
  if (status === 'ì‹¬ë°©í•„ìš”') return 'badge-red';
  if (status === 'ì¥ê²°ì')   return 'badge-red';
  if (status === 'ìœ í•™ì¤‘')   return 'badge-blue';
  return 'badge-gray';
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì„¤êµ Â· ì†Œê·¸ë£¹ ì½œì•„ì›ƒ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// í˜„ì¬ ë³´ê³  ìˆëŠ” ì£¼ì¼ ì¸ë±ìŠ¤ (allSundays ë°°ì—´ ê¸°ì¤€)
let sermonWeekIdx = 0;

// ì„¤êµ ë°ì´í„° í‚¤ ìƒì„± (ë‚ ì§œë³„ë¡œ ì €ì¥)
function sermonKey(dateStr) { return 'sermon_' + dateStr; }

// "ì´ë²ˆ ì£¼ ë§ì”€" ê¸°ì¤€ ì£¼ì¼ ì¸ë±ìŠ¤
// - ì˜¤ëŠ˜ì´ ì£¼ì¼ì´ë©´ ì˜¤ëŠ˜
// - ì˜¤ëŠ˜ì´ ì£¼ì¼ì´ ì•„ë‹ˆë©´ â†’ ì´ë²ˆ ì£¼ ì£¼ì¼ (ì›”~í† : ë‹¤ê°€ì˜¤ëŠ” ì£¼ì¼, ì£¼ì¼ì´ ì§€ë‚˜ë©´ ë‹¤ìŒ ì£¼ì¼)
function findNearestSundayIdx() {
  const today = new Date(); today.setHours(0,0,0,0);
  const todayStr = toLocalDateStr(today);

  // ì˜¤ëŠ˜ ì´í›„(ì˜¤ëŠ˜ í¬í•¨) ì²« ë²ˆì§¸ ì£¼ì¼ ì°¾ê¸°
  for (let i = 0; i < allSundays.length; i++) {
    if (allSundays[i] >= todayStr) return i;
  }
  // 2026ë…„ì„ ë„˜ì–´ê°”ì„ ê²½ìš° ë§ˆì§€ë§‰ ì£¼ì¼ ë°˜í™˜
  return allSundays.length - 1;
}

function changeSermonWeek(delta) {
  const next = sermonWeekIdx + delta;
  if (next < 0 || next >= allSundays.length) return;
  sermonWeekIdx = next;
  renderSermon();
}

function renderSermon() {
  if (!allSundays.length) return;
  const dateStr = allSundays[sermonWeekIdx];
  const data = loadSermonData(dateStr);

  // ì£¼ì¼ ë‚ ì§œ í‘œì‹œ + ì´ë²ˆ ì£¼ / ì§€ë‚œ ì£¼ / ë‹¤ìŒ ì£¼ ë¼ë²¨
  const today = new Date(); today.setHours(0,0,0,0);
  const todayStr = toLocalDateStr(today);
  const nearestIdx = findNearestSundayIdx();
  let weekLabel = '';
  if (sermonWeekIdx === nearestIdx) {
    weekLabel = ' âœ¦ ì´ë²ˆ ì£¼';
  } else if (sermonWeekIdx < nearestIdx) {
    weekLabel = ' Â· ì§€ë‚œ ì£¼ì¼';
  } else {
    weekLabel = ' Â· ë‹¤ìŒ ì£¼ì¼';
  }
  document.getElementById('sermonWeekTitle').textContent = formatDateFull(dateStr) + weekLabel;

  // í•„ë“œ ë Œë”
  const fields = [
    { id: 'sfPassage', key: 'passage' },
    { id: 'sfTitle',   key: 'title'   },
    { id: 'sfGroup',   key: 'group'   },
  ];
  fields.forEach(({ id, key }) => {
    const el = document.getElementById(id);
    const val = data[key] || '';
    if (val) {
      el.textContent = val;
      el.classList.remove('empty-val');
    } else {
      el.textContent = 'ë“±ë¡ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤';
      el.classList.add('empty-val');
    }
  });

  // í¸ì§‘ í¼ ë‹«ê¸°
  document.getElementById('sermonEditForm').classList.remove('show');
}

function toggleSermonEdit() {
  if (!currentUser || currentUser.role !== 'admin') { showToast('êµì—­ìë§Œ í¸ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'error'); return; }
  const form = document.getElementById('sermonEditForm');
  const isOpen = form.classList.contains('show');
  if (isOpen) {
    form.classList.remove('show');
    return;
  }
  // í˜„ì¬ ê°’ì„ í¼ì— ì±„ì›Œë„£ê¸°
  const dateStr = allSundays[sermonWeekIdx];
  const data = loadSermonData(dateStr);
  document.getElementById('sePassage').value = data.passage || '';
  document.getElementById('seTitle').value   = data.title   || '';
  document.getElementById('seGroup').value   = data.group   || '';
  form.classList.add('show');
  document.getElementById('seTitle').focus();
}

function saveSermon() {
  if (!currentUser || currentUser.role !== 'admin') { showToast('êµì—­ìë§Œ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'error'); return; }
  const dateStr = allSundays[sermonWeekIdx];
  const data = {
    passage:  document.getElementById('sePassage').value.trim(),
    title:    document.getElementById('seTitle').value.trim(),
    group:    document.getElementById('seGroup').value.trim(),
    updatedAt: new Date().toISOString(),
  };
  // localStorageì— ì£¼ì¼ë³„ë¡œ ì˜êµ¬ ì €ì¥ (íƒ­ ë‹«ì•„ë„ ìœ ì§€)
  try { localStorage.setItem('sermon_' + dateStr, JSON.stringify(data)); } catch(e) {}
  // GASì—ë„ ì €ì¥ (ê³µìœ )
  if (GAS_URL) callGAS('setAppData', { key: 'sermon_' + dateStr, value: data }).catch(()=>{});
  renderSermon();
  showToast('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
}

// loadCalloutData ê°€ ë°°ì—´ë§Œ ì²˜ë¦¬í•˜ë¯€ë¡œ ì„¤êµìš© override
function loadSermonData(dateStr) {
  try { return JSON.parse(localStorage.getItem('sermon_' + dateStr) || 'null') || {}; }
  catch(e) { return {}; }
}

// GASì—ì„œ ì„¤êµ ë°ì´í„° ë¡œë“œ (ë¹„ë™ê¸°)
async function loadSermonDataAsync(dateStr) {
  // localStorage ìš°ì„  (ë¹ ë¦„)
  let local = {};
  try { local = JSON.parse(localStorage.getItem('sermon_' + dateStr) || 'null') || {}; } catch(e) {}
  if (local && Object.keys(local).length > 0) return local;
  // GASì—ì„œ ë¡œë“œ
  if (GAS_URL) {
    try {
      const r = await callGAS('getAppData', { key: 'sermon_' + dateStr });
      if (r && r.success && r.data && typeof r.data === 'object' && Object.keys(r.data).length > 0) {
        try { localStorage.setItem('sermon_' + dateStr, JSON.stringify(r.data)); } catch(e) {}
        return r.data;
      }
    } catch(e) { console.warn('loadSermonDataAsync GAS ì˜¤ë¥˜:', e); }
  }
  return {};
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ëŒ€ì‹œë³´ë“œ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// â”€â”€ í™ˆ í†µê³„ ì¹´ë“œ í´ë¦­ â†’ í•´ë‹¹ ìƒíƒœ í•™ìƒ ëª…ë‹¨ ëª¨ë‹¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showStatusList(status) {
  let students;
  let title;
  if (status === 'ë“±ë¡') {
    students = allStudents.filter(s => s['ìƒíƒœ'] === 'ë“±ë¡');
    title = 'âœ… ë“±ë¡ í•™ìƒ';
  } else if (status === 'ìƒˆì¹œêµ¬') {
    students = allStudents.filter(s => s['ìƒíƒœ'] === 'ìƒˆì¹œêµ¬' || s['ìƒíƒœ'] === 'ìƒˆ ì¹œêµ¬');
    title = 'ğŸŒ± ìƒˆì¹œêµ¬';
  } else if (status === 'ì¥ê²°ì') {
    students = allStudents.filter(s => s['ìƒíƒœ'] === 'ì¥ê²°ì');
    title = 'âš ï¸ ì¥ê²°ì';
  } else if (status === 'ìœ í•™ìƒ') {
    students = allStudents.filter(s => s['ìƒíƒœ'] === 'ìœ í•™ì¤‘' || s['ìƒíƒœ'] === 'ìœ í•™');
    title = 'âœˆï¸ ìœ í•™ìƒ';
  } else {
    students = allStudents.filter(s => s['ìƒíƒœ'] === status);
    title = status;
  }

  // ê¸°ì¡´ ëª¨ë‹¬ ì¬í™œìš© ë˜ëŠ” ë™ì  ìƒì„±
  let modal = document.getElementById('statusListModal');
  if (!modal) {
    modal = document.createElement('div');
    modal.className = 'modal-backdrop';
    modal.id = 'statusListModal';
    modal.innerHTML = `
      <div class="modal" style="max-width:420px;max-height:80vh;display:flex;flex-direction:column;">
        <div class="modal-header">
          <div class="modal-title" id="statusListTitle"></div>
          <button class="modal-close" onclick="closeModal('statusListModal')">âœ•</button>
        </div>
        <div class="modal-body" id="statusListBody" style="overflow-y:auto;flex:1;"></div>
        <div class="modal-footer">
          <button class="btn btn-outline" style="flex:1" onclick="closeModal('statusListModal')">ë‹«ê¸°</button>
        </div>
      </div>`;
    document.body.appendChild(modal);
    modal.addEventListener('click', e => { if (e.target === modal) closeModal('statusListModal'); });
  }

  const GRADE_ORDER_STATUS = ['ì´ˆ6','ì¤‘1','ì¤‘2','ì¤‘3','ê³ 1','ê³ 2','ê³ 3','ì˜ì–´ë°˜'];
  function gradeKey(cls) {
    if (!cls) return '99_ê¸°íƒ€';
    for (let i = 0; i < GRADE_ORDER_STATUS.length; i++) {
      if (cls.startsWith(GRADE_ORDER_STATUS[i])) return String(i).padStart(2,'0') + '_' + cls;
    }
    return '99_' + cls;
  }
  const sorted = [...students].sort((a,b) => gradeKey(a['í•™ë…„-ë°˜']).localeCompare(gradeKey(b['í•™ë…„-ë°˜'])));

  function _renderStatusList(list) {
    const body = document.getElementById('statusListBody');
    if (!list.length) {
      body.innerHTML = '<div class="empty"><div class="empty-icon">ğŸ˜Š</div>í•´ë‹¹ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.</div>';
      return;
    }
    body.innerHTML = list.map(s => {
      // ë‚˜ì´ ê³„ì‚°
      let age = s['ë‚˜ì´'] || '';
      if (!age && s['ìƒë…„ì›”ì¼']) {
        const bd = String(s['ìƒë…„ì›”ì¼']).replace(/\s/g,'');
        if (/^\d{6}$/.test(bd)) {
          const yy=parseInt(bd.slice(0,2)),mm=parseInt(bd.slice(2,4)),dd=parseInt(bd.slice(4,6));
          const fy=yy<=(new Date().getFullYear()%100)?2000+yy:1900+yy;
          let a=new Date().getFullYear()-fy;
          if(new Date()<new Date(new Date().getFullYear(),mm-1,dd))a--;
          age=a;
        }
      }
      return `
      <div style="display:flex;align-items:center;gap:10px;padding:10px 0;border-bottom:1px solid var(--gray-100);">
        <div style="width:34px;height:34px;border-radius:50%;background:var(--primary-lt);display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--primary);font-size:.85rem;">${s['ì´ë¦„'].charAt(0)}</div>
        <div style="flex:1;">
          <div style="font-weight:700;font-size:.88rem;">${s['ì´ë¦„']}
            <span class="badge ${statusBadgeClass(s['ìƒíƒœ'])}" style="font-size:.62rem;margin-left:4px;">${s['ìƒíƒœ']}</span>
          </div>
          <div style="font-size:.75rem;color:var(--gray-500);">${s['í•™ë…„-ë°˜']||'-'} Â· ${s['ì„±ë³„']||'-'} Â· ë§Œ${age||'-'}ì„¸</div>
        </div>
        <button class="btn btn-outline btn-sm" onclick="closeModal('statusListModal');showStudentDetail('${s['í•™ìƒID']}')">ìƒì„¸</button>
      </div>`;
    }).join('');
  }

  let statusModal = document.getElementById('statusListModal');
  if (!statusModal) {
    statusModal = document.createElement('div');
    statusModal.className = 'modal-backdrop';
    statusModal.id = 'statusListModal';
    document.body.appendChild(statusModal);
    statusModal.addEventListener('click', e => { if (e.target === statusModal) closeModal('statusListModal'); });
  }
  statusModal.innerHTML = `
    <div class="modal" style="max-width:420px;max-height:85vh;display:flex;flex-direction:column;">
      <div class="modal-header">
        <div class="modal-title" id="statusListTitle">${title} Â· ${sorted.length}ëª…</div>
        <button class="modal-close" onclick="closeModal('statusListModal')">âœ•</button>
      </div>
      <div style="padding:10px 16px 4px;">
        <div class="header-search" style="background:var(--gray-50);border:1.5px solid var(--gray-200);border-radius:50px;padding:7px 14px;">
          <span>ğŸ”</span>
          <input type="text" id="statusSearchInput" placeholder="ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰..."
            style="background:none;border:none;outline:none;font-size:.88rem;width:100%;"
            oninput="_filterStatusList(this.value)">
        </div>
      </div>
      <div class="modal-body" id="statusListBody" style="overflow-y:auto;flex:1;"></div>
      <div class="modal-footer">
        <button class="btn btn-outline" style="flex:1" onclick="closeModal('statusListModal')">ë‹«ê¸°</button>
      </div>
    </div>`;

  // ê²€ìƒ‰ í•„í„°
  window._statusListStudents = sorted;
  window._filterStatusList = function(q) {
    const fil = q.trim() ? sorted.filter(s => s['ì´ë¦„'].includes(q.trim())) : sorted;
    _renderStatusList(fil);
  };
  _renderStatusList(sorted);
  openModal('statusListModal');
}

function renderDashboard() {
  const isAdmin   = currentUser && currentUser.role === 'admin';
  const dashboard = document.getElementById('view-dashboard');

  if (isAdmin) {
    // â”€â”€ êµì—­ì(ê´€ë¦¬ì) í™ˆ: ê¸°ì¡´ í’€ ëŒ€ì‹œë³´ë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    dashboard.classList.remove('teacher-home');

    const active  = allStudents.filter(s => s['ìƒíƒœ'] === 'ë“±ë¡' || s['ìƒíƒœ'] === 'ì‹¬ë°©í•„ìš”');
    const newbie  = allNewbies.filter(n => n['ë°˜ë°°ì •ì™„ë£Œì—¬ë¶€'] !== 'TRUE');
    const absent  = allStudents.filter(s => s['ìƒíƒœ'] === 'ì¥ê²°ì');
    const study   = allStudents.filter(s => ['ìœ í•™ì¤‘','ìœ í•™'].includes(s['ìƒíƒœ']));
    document.getElementById('statTotal').textContent  = allStudents.length;
    document.getElementById('statActive').textContent = active.length;
    document.getElementById('statNewbie').textContent = newbie.length;
    const tEl = document.getElementById('statTeacher'); if (tEl) tEl.textContent = allTeachers.length;
    const absentStatEl = document.getElementById('statAbsent');
    if (absentStatEl) absentStatEl.textContent = absent.length;
    const studyEl = document.getElementById('statStudy');
    if (studyEl) studyEl.textContent = study.length;

    // ê³µì§€Â·ì¼ì • ì¶”ê°€ ë²„íŠ¼ ë…¸ì¶œ (êµì—­ìë§Œ)
    document.querySelectorAll('.callout-add-btn').forEach(b => b.style.removeProperty('display'));

    // ì„¤êµ í¸ì§‘ ë²„íŠ¼ ë…¸ì¶œ, ì„¤êµ ì½œì•„ì›ƒ í‘œì‹œ
    document.getElementById('calloutSermon').style.display = 'block';
    document.getElementById('sermonEditBtn').style.display = 'inline-flex';

    // ìƒì¼ í•„í„°: ì´ë‹¬ íƒ­ì´ active ë˜ë„ë¡ ê°±ì‹ 
    const thisMonth = new Date().getMonth() + 1;
    filterMonth = filterMonth || thisMonth;
    document.querySelectorAll('.month-btn').forEach(b => {
      b.classList.toggle('active', parseInt(b.dataset.month) === filterMonth);
    });
    renderStudentList();

  } else {
    // â”€â”€ êµì‚¬ í™ˆ (ë‹´ì„Â·ë¶€ë‹´ì„Â·ìƒˆì¹œêµ¬): ê³µì§€Â·ë§ì”€Â·ì‚¬ì—­ì¼ì • ì½ê¸° ì „ìš© â”€
    dashboard.classList.add('teacher-home');

    document.querySelectorAll('.callout-add-btn').forEach(b => b.style.display = 'none');
    document.getElementById('sermonEditBtn').style.display = 'none';
    document.getElementById('calloutSermon').style.display = 'block';
    sermonWeekIdx = findNearestSundayIdx();

    // â”€â”€ êµì‚¬ìš© ìƒì¼ ì„¹ì…˜ ë Œë”ë§ (ë‹´ë‹¹ ë°˜ í•™ìƒ) â”€â”€
    _renderTeacherBirthday();
  }

  // ê³µí†µ: ê³µì§€Â·ì‚¬ì—­ì¼ì •ì€ í•­ìƒ ë Œë”
  renderNotices();
  renderSchedules();
  renderSermon();
}


// â”€â”€ êµì‚¬ìš© ì´ë‹¬ì˜ ìƒì¼ (ë‹´ë‹¹ ë°˜ í•™ìƒ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function _renderTeacherBirthday() {
  // êµì‚¬/ë¦¬ë”ì‹­ í™ˆì— ìƒì¼ ì„¹ì…˜ ì‚½ì… (ê³µì§€ì‚¬í•­ ìœ„)
  let bdSection = document.getElementById('teacherBirthdaySection');
  if (!bdSection) {
    bdSection = document.createElement('div');
    bdSection.id = 'teacherBirthdaySection';
    bdSection.style.cssText = 'margin-bottom:14px;';
    // calloutNotice ì•ì— ì‚½ì… (ê³µì§€ì‚¬í•­ ìœ„)
    const notice = document.getElementById('calloutNotice');
    if (notice && notice.parentNode) {
      notice.parentNode.insertBefore(bdSection, notice);
    } else {
      const sermon = document.getElementById('calloutSermon');
      if (sermon && sermon.parentNode) {
        sermon.parentNode.insertBefore(bdSection, sermon.nextSibling);
      } else {
        document.getElementById('view-dashboard').appendChild(bdSection);
      }
    }
  }

  const isLeader = currentUser && (currentUser.role === 'leadership');

  const now = new Date();
  const m = now.getMonth() + 1;

  function getBdMonth(bd) {
    const s = String(bd||'').replace(/[\s]/g,'');
    if (!s) return 0;
    const ymatch = s.match(/^\d{4}-(\d{2})-\d{2}$/);
    if (ymatch) return parseInt(ymatch[1]);
    if (s.length >= 4) return parseInt(s.slice(2,4));
    return 0;
  }

  function getBdDay(bd) {
    const s = String(bd||'').replace(/[\s]/g,'');
    if (!s) return 0;
    const ymatch = s.match(/^\d{4}-\d{2}-(\d{2})$/);
    if (ymatch) return parseInt(ymatch[1]);
    if (s.length >= 6) return parseInt(s.slice(4,6));
    return 0;
  }

  function fmtDay(bd) {
    const s = String(bd||'').replace(/[\s]/g,'');
    if (!s) return '';
    const ymatch = s.match(/^\d{4}-(\d{2})-(\d{2})$/);
    if (ymatch) return parseInt(ymatch[1]) + '/' + parseInt(ymatch[2]);
    if (s.length >= 6) return parseInt(s.slice(2,4)) + '/' + parseInt(s.slice(4,6));
    return '';
  }

  let birthdayPeople = [];
  let sectionLabel = '';

  const myClass = currentUser ? (currentUser.classGroup || '') : '';
  const myClasses_bd = myClass.split(',').map(c=>c.trim()).filter(c=>c);
  // ë¦¬ë”ì‹­ ê²¸ ë‹´ì„ ì—¬ë¶€
  const isLeaderAndTeacher = isLeader && myClasses_bd.length > 0;

  if (isLeader) {
    // ë¦¬ë”ì‹­: êµì—­ìÂ·ë¦¬ë”ì‹­Â·êµì‚¬ ìƒì¼ í‘œì‹œ
    birthdayPeople = allTeachers.filter(t => getBdMonth(t['ìƒë…„ì›”ì¼']) === m)
      .map(t => ({ name: t['ì´ë¦„'], bd: t['ìƒë…„ì›”ì¼'], type: 'teacher' }));

    // ë¦¬ë”ì‹­ ê²¸ ë‹´ì„: ë‹´ë‹¹ ë°˜ í•™ìƒ ìƒì¼ë„ ì¶”ê°€
    if (isLeaderAndTeacher) {
      const myStudents = allStudents.filter(s => myClasses_bd.some(c => s['í•™ë…„-ë°˜'] === c));
      const stuBd = myStudents.filter(s => getBdMonth(s['ìƒë…„ì›”ì¼']) === m)
        .map(s => ({ name: s['ì´ë¦„'], bd: s['ìƒë…„ì›”ì¼'], type: 'student', cls: s['í•™ë…„-ë°˜'] }));
      birthdayPeople = [...birthdayPeople, ...stuBd];
    }

    sectionLabel = isLeaderAndTeacher ? `êµì‚¬ì§„ + ${myClasses_bd.join(',')} í•™ìƒ` : 'êµì—­ìÂ·êµì‚¬ì§„';
  } else {
    // ì¼ë°˜ êµì‚¬: ë‹´ë‹¹ ë°˜ í•™ìƒ ìƒì¼
    let myStudents = [];
    if (myClasses.length > 0) {
      myStudents = allStudents.filter(s => myClasses.some(c => s['í•™ë…„-ë°˜'] === c));
    }
    birthdayPeople = myStudents.filter(s => getBdMonth(s['ìƒë…„ì›”ì¼']) === m)
      .map(s => ({ name: s['ì´ë¦„'], bd: s['ìƒë…„ì›”ì¼'] }));
    sectionLabel = myClasses.join(', ') || 'ë‹´ë‹¹ ë°˜ ì—†ìŒ';
  }
  birthdayPeople.sort((a,b) => getBdDay(a.bd) - getBdDay(b.bd));
  const birthdayStudents = birthdayPeople; // í•˜ìœ„ í˜¸í™˜ ë³€ìˆ˜

  if (!birthdayStudents.length) {
    bdSection.innerHTML = `
      <div style="font-size:.9rem;font-weight:700;color:var(--gray-500);margin-bottom:6px;">
        ğŸ‚ ì´ë‹¬(${m}ì›”)ì˜ ìƒì¼
        <span style="font-size:.75rem;color:var(--gray-400);margin-left:4px;">(${sectionLabel})</span>
      </div>
      <div style="font-size:.82rem;color:var(--gray-400);padding:8px 0;">ì´ë‹¬ ìƒì¼ì¸ ë¶„ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
    return;
  }

  const listHtml = birthdayStudents.map(p => {
    const dayStr = fmtDay(p.bd);
    const bg  = p.type === 'student' ? '#F0FDF4' : 'var(--primary-lt)';
    const col = p.type === 'student' ? '#16A34A' : 'var(--primary)';
    const clsTag = p.cls ? `<span style="font-size:.65rem;color:#888;margin-left:2px;">${p.cls}</span>` : '';
    return `<span style="display:inline-flex;align-items:center;gap:4px;background:${bg};border-radius:20px;padding:5px 12px;font-size:.85rem;font-weight:600;color:${col};margin:3px;border:1px solid rgba(0,0,0,.07);">
      ${p.name}${clsTag}${dayStr ? `<span style="color:#888;font-size:.75rem;margin-left:2px;">(${dayStr})</span>` : ''}
    </span>`;
  }).join('');

  bdSection.innerHTML = `
    <div style="font-size:.9rem;font-weight:800;color:var(--gray-700);margin-bottom:8px;cursor:pointer;display:flex;align-items:center;justify-content:space-between;"
         onclick="this.nextSibling.style.display=this.nextSibling.style.display==='none'?'flex':'none'">
      <span>ğŸ‚ ì´ë‹¬(${m}ì›”)ì˜ ìƒì¼ Â· <span style="color:var(--primary);">${birthdayStudents.length}ëª…</span>
        <span style="font-size:.72rem;color:var(--gray-400);margin-left:4px;">(${sectionLabel})</span></span>
      <span style="font-size:.72rem;color:var(--gray-400);">â–¼</span>
    </div>
    <div style="display:flex;flex-wrap:wrap;gap:2px;">${listHtml}</div>`;
}
function renderStudentList() {
  const el = document.getElementById('studentList');
  const m = (filterMonth > 0) ? filterMonth : new Date().getMonth() + 1;

  function getBdMonth(bd) {
    const s = String(bd || '').replace(/\s/g, '');
    if (!s) return 0;
    // YYYY-MM-DD í˜•ì‹
    const ymatch = s.match(/^\d{4}-(\d{2})-\d{2}$/);
    if (ymatch) return parseInt(ymatch[1]);
    // YYMMDD í˜•ì‹ (6ìë¦¬)
    if (s.length >= 4) return parseInt(s.slice(2,4));
    return 0;
  }

  // í•™ìƒ (ì¥ê²°ì í¬í•¨)
  const birthdayStudents = allStudents.filter(s => getBdMonth(s['ìƒë…„ì›”ì¼']) === m);
  // êµì‚¬
  const birthdayTeachers = allTeachers.filter(t => getBdMonth(t['ìƒë…„ì›”ì¼']) === m);

  if (!birthdayStudents.length && !birthdayTeachers.length) {
    el.innerHTML = `<div class="empty" style="padding:16px 0;"><div class="empty-icon">ğŸ‚</div><div style="font-size:.82rem;color:var(--gray-400);">${m}ì›” ìƒì¼ì¸ í•™ìƒ/êµì‚¬ê°€ ì—†ìŠµë‹ˆë‹¤.</div></div>`;
    return;
  }

  // í•™ë…„ ê·¸ë£¹í•‘ (í•™ìƒ)
  const gradeGroups = {};
  birthdayStudents.forEach(s => {
    const cls = s['í•™ë…„-ë°˜'] || 'ê¸°íƒ€';
    const gradeKey = cls.replace(/-\dë°˜$/, '').replace(/-\d+ë°˜$/, '') || 'ê¸°íƒ€';
    if (!gradeGroups[gradeKey]) gradeGroups[gradeKey] = [];
    // ì¥ê²°ìë©´ ë¹¨ê°„ìƒ‰
    const isAbsent = s['ìƒíƒœ'] === 'ì¥ê²°ì';
    gradeGroups[gradeKey].push({ name: s['ì´ë¦„'], absent: isAbsent });
  });

  const gradeOrder = ['ì´ˆ6','ì¤‘1','ì¤‘2','ì¤‘3','ê³ 1','ê³ 2','ê³ 3','ì˜ì–´ë°˜'];
  const sortedGrades = Object.keys(gradeGroups).sort((a,b) => {
    const ai = gradeOrder.indexOf(a); const bi = gradeOrder.indexOf(b);
    return (ai<0?99:ai)-(bi<0?99:bi);
  });

  let html = sortedGrades.map(grade => {
    const persons = gradeGroups[grade];
    const rows = [];
    for (let i = 0; i < persons.length; i += 5) rows.push(persons.slice(i, i+5));
    return `
      <div style="background:var(--primary-lt);border-left:3px solid var(--primary);border-radius:var(--radius-sm);padding:10px 12px;margin-bottom:8px;">
        <div style="font-size:.72rem;font-weight:800;color:var(--primary);margin-bottom:7px;">ğŸ‚ ${grade}</div>
        ${rows.map(row => `
          <div style="display:flex;flex-wrap:wrap;gap:5px;margin-bottom:4px;">
            ${row.map(p => {
              const style = p.absent
                ? 'background:#FEE2E2;color:#DC2626;border:1px solid #FCA5A5;'
                : 'background:#fff;color:var(--primary);border:1px solid rgba(59,130,246,.2);';
              const label = p.absent ? p.name + ' âš ï¸' : p.name;
              return `<span style="font-size:.8rem;font-weight:600;padding:3px 9px;border-radius:50px;${style}">${label}</span>`;
            }).join('')}
          </div>`).join('')}
      </div>`;
  }).join('');

  // êµì‚¬ ì„¹ì…˜
  if (birthdayTeachers.length) {
    const tRows = [];
    for (let i = 0; i < birthdayTeachers.length; i += 5) tRows.push(birthdayTeachers.slice(i, i+5));
    html += `
      <div style="background:#F3E8FF;border-left:3px solid #7C3AED;border-radius:var(--radius-sm);padding:10px 12px;margin-bottom:8px;">
        <div style="font-size:.72rem;font-weight:800;color:#7C3AED;margin-bottom:7px;">ğŸ‚ êµì‚¬</div>
        ${tRows.map(row => `
          <div style="display:flex;flex-wrap:wrap;gap:5px;margin-bottom:4px;">
            ${row.map(t => `<span style="font-size:.8rem;font-weight:600;background:#fff;color:#7C3AED;padding:3px 9px;border-radius:50px;border:1px solid rgba(124,58,237,.2);">${t['ì´ë¦„']}</span>`).join('')}
          </div>`).join('')}
      </div>`;
  }

  el.innerHTML = html;
}

function getBirthdayBadge(bd) {
  if (!bd || String(bd).length < 4) return '';
  const today = new Date();
  const mo = parseInt(String(bd).slice(2,4));
  if (mo === today.getMonth()+1) return `<span class="badge badge-red">ğŸ‚ ì´ë‹¬ ìƒì¼</span>`;
  return '';
}

function renderTeacherList() {
  const q = searchQuery.toLowerCase();
  const filtered = allTeachers.filter(t => !q || t['ì´ë¦„'].includes(q));
  const el = document.getElementById('teacherList');
  if (!filtered.length) { el.innerHTML = `<div class="empty"><div class="empty-icon">ğŸ‘©â€ğŸ«</div>êµì‚¬ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`; return; }
  el.innerHTML = filtered.map(t => `
    <div class="person-card" onclick="showTeacherDetail('${t['êµì‚¬ID']}')">
      <div class="avatar teacher">${t['ì´ë¦„'].charAt(0)}</div>
      <div class="person-info" style="flex:1">
        <div class="name">${t['ì´ë¦„']} <small style="color:var(--gray-400);font-size:.75rem;">${t['êµì‚¬ID']}</small></div>
        <div class="sub">${t['ë‹´ë‹¹ í•™ë…„-ë°˜']||'ë¯¸ë°°ì •'} Â· ${t['ì—°ë½ì²˜']||'-'}</div>
        <div class="tags">
          <span class="badge badge-amber">${t['êµ¬ë¶„']}</span>
        </div>
      </div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì¶œì„ ì²´í¬
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setupAttendanceDateSelect() {
  const dateEl = document.getElementById('attDate');
  dateEl.innerHTML = '<option value="">ë‚ ì§œ ì„ íƒ</option>' +
    allSundays.map(d => `<option value="${d}">${formatDate(d)}</option>`).join('');

  // â”€â”€ ë°˜ ì •ë ¬: ì´ˆ6 > ì¤‘1 > ì¤‘2 > ì¤‘3 > ê³ 1 > ê³ 2 > ê³ 3 ìˆœ â”€â”€â”€â”€â”€â”€â”€â”€
  function classOrder(c) {
    if (c.startsWith('ì´ˆ6')) return '1_' + c;
    if (c.startsWith('ì¤‘1')) return '2_' + c;
    if (c.startsWith('ì¤‘2')) return '3_' + c;
    if (c.startsWith('ì¤‘3')) return '4_' + c;
    if (c.startsWith('ê³ 1')) return '5_' + c;
    if (c.startsWith('ê³ 2')) return '6_' + c;
    if (c.startsWith('ê³ 3')) return '7_' + c;
    return '9_' + c;
  }
  const validSt = ['ë“±ë¡','ì‹¬ë°©í•„ìš”'];  // ì¥ê²°ìÂ·ìœ í•™ì¤‘ ì¶œì„ëª©ë¡ ì œì™¸
  const allClasses = [...new Set(allStudents.filter(s=>validSt.includes(s['ìƒíƒœ'])).map(s=>s['í•™ë…„-ë°˜']))]
    .sort((a,b)=>classOrder(a).localeCompare(classOrder(b)));

  const isAdmin      = currentUser && currentUser.role === 'admin';
  const isLeadership = currentUser && currentUser.role === 'leadership';

  const classEl = document.getElementById('attClass');

  // ë¦¬ë”ì‹­ ê²¸ ë‹´ì„ ì—¬ë¶€ í™•ì¸ (êµ¬ë¶„ í•„ë“œì— 'ë¦¬ë”ì‹­'ê³¼ 'ë‹´ì„' ë‘˜ ë‹¤ ìˆëŠ” ê²½ìš°)
  const isLeadershipAndTeacher = isLeadership &&
    currentUser.teacherObj && hasRole(currentUser.teacherObj, ATTENDANCE_TEACHER_ROLES);

  if (isLeadership && !isLeadershipAndTeacher) {
    // ìˆœìˆ˜ ë¦¬ë”ì‹­: êµì‚¬ ì¶œì„ë§Œ
    classEl.innerHTML = `<option value="__teachers__">ğŸ‘¥ êµì‚¬ ì¶œì„ì²´í¬</option>`;
    classEl.value = '__teachers__';
    classEl.setAttribute('disabled', 'disabled');
    renderAttLockBanner('êµì‚¬ ì „ì²´');
    autoSelectNearestSunday();
    loadAttendance();
  } else if (isLeadershipAndTeacher) {
    // ë¦¬ë”ì‹­ ê²¸ ë‹´ì„: êµì‚¬ ì¶œì„ + ë‹´ë‹¹ ë°˜ ëª¨ë‘ ì„ íƒ ê°€ëŠ¥
    const rawClass = currentUser.classGroup || '';
    const myClasses = rawClass ? rawClass.split(',').map(c=>c.trim()).filter(c=>c) : [];
    classEl.innerHTML =
      '<option value="__teachers__">ğŸ‘¥ êµì‚¬ ì¶œì„ì²´í¬</option>' +
      myClasses.filter(c=>allClasses.includes(c)).map(c=>`<option value="${c}">${c}</option>`).join('');
    classEl.value = '__teachers__';
    classEl.removeAttribute('disabled');
    renderAttLockBanner('ì„ íƒí•˜ì„¸ìš”');
    autoSelectNearestSunday();
    loadAttendance();
  } else if (isAdmin) {
    // êµì‚¬ ì¶œì„ì²´í¬ê°€ ë§¨ ìœ„, ê·¸ ë‹¤ìŒ ì •ë ¬ëœ ë°˜ ëª©ë¡
    classEl.innerHTML =
      '<option value="">ë°˜ ì„ íƒ (ì „ì²´)</option>' +
      '<option value="__teachers__">ğŸ‘¥ êµì‚¬ ì¶œì„ì²´í¬</option>' +
      allClasses.map(c=>`<option value="${c}">${c}</option>`).join('');
    classEl.removeAttribute('disabled');
  } else {
    // êµì‚¬(ë‹´ì„Â·ë¶€ë‹´ì„ í¬í•¨): ë‹´ë‹¹ í•™ë…„-ë°˜ ëª©ë¡ êµ¬ì„±
    // ì‰¼í‘œ êµ¬ë¶„ ë‹¤ë°˜ ì§€ì› (ì˜ˆ: "ì¤‘1-1ë°˜,ì¤‘1-2ë°˜")
    const rawClass = currentUser ? (currentUser.classGroup || '') : '';
    const myClasses = rawClass
      ? rawClass.split(',').map(c => c.trim()).filter(c => c && allClasses.includes(c))
      : [];
    const fallback  = rawClass || 'ë‹´ë‹¹ë°˜ ì—†ìŒ';

    if (!myClasses.length) {
      classEl.innerHTML = `<option value="${fallback}">${fallback}</option>`;
      classEl.value = fallback;
    } else if (myClasses.length === 1) {
      classEl.innerHTML = `<option value="${myClasses[0]}">${myClasses[0]}</option>`;
      classEl.value = myClasses[0];
    } else {
      // ë³µìˆ˜ ë°˜ ë‹´ë‹¹ì¸ ê²½ìš° ì„ íƒ ê°€ëŠ¥í•˜ê²Œ
      classEl.innerHTML = myClasses.map(c=>`<option value="${c}">${c}</option>`).join('');
      classEl.value = myClasses[0];
      classEl.removeAttribute('disabled');
    }
    if (myClasses.length <= 1) classEl.setAttribute('disabled', 'disabled');
    renderAttLockBanner(myClasses.length ? myClasses.join(', ') : fallback);
  }

  // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•´ ìƒˆ ì—˜ë¦¬ë¨¼íŠ¸ë¡œ êµì²´)
  const newClassEl = classEl.cloneNode(true);
  classEl.parentNode.replaceChild(newClassEl, classEl);

  newClassEl.addEventListener('change', () => {
    if (newClassEl.value) autoSelectNearestSunday();
    loadAttendance();
  });
  dateEl.addEventListener('change', () => {
    if (dateEl.value) showDateBanner(dateEl.value);
    loadAttendance();
  });

  // êµì‚¬(ë‹´ì„Â·ë¶€ë‹´ì„)ì¸ ê²½ìš° ë‹´ë‹¹ ë°˜ ìë™ ë¡œë“œ
  if (!isAdmin && !isLeadership && currentUser && currentUser.classGroup) {
    autoSelectNearestSunday();
    loadAttendance();
  } else if (isLeadership) {
    autoSelectNearestSunday();
    loadAttendance();
  }
}

function renderAttLockBanner(myClass) {
  // ê¸°ì¡´ ë°°ë„ˆê°€ ìˆìœ¼ë©´ ì œê±°
  const existing = document.getElementById('attLockBanner');
  if (existing) existing.remove();

  if (!myClass) return;
  const attSection = document.getElementById('view-attendance');
  const lockBanner = document.createElement('div');
  lockBanner.id = 'attLockBanner';
  lockBanner.className = 'locked-banner';
  lockBanner.innerHTML = `
    <span style="font-size:1.1rem;">ğŸ”’</span>
    <span>ë‹´ë‹¹ ë°˜ <strong>${myClass}</strong>ì˜ ì¶œì„ë¶€ë§Œ ì—´ëŒÂ·í¸ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>`;
  // att-header ì•ì— ì‚½ì…
  const attHeader = attSection.querySelector('.att-header');
  attSection.insertBefore(lockBanner, attHeader);
}

// ì˜¤ëŠ˜ ë‚ ì§œì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ì¼ìš”ì¼(ê³¼ê±° ìš°ì„ ) ìë™ ì„ íƒ
function autoSelectNearestSunday() {
  const dateEl = document.getElementById('attDate');
  const today  = new Date();
  today.setHours(0, 0, 0, 0);

  // ì˜¤ëŠ˜ ì´í•˜ì¸ ì¼ìš”ì¼ ì¤‘ ê°€ì¥ ë§ˆì§€ë§‰(ìµœê·¼) ê²ƒ ì„ íƒ, ì—†ìœ¼ë©´ ì²« ë²ˆì§¸ ë¯¸ë˜ ì¼ìš”ì¼
  let best = allSundays[0];
  for (const s of allSundays) {
    const d = new Date(s);
    if (d <= today) best = s;
    else break;
  }

  dateEl.value = best;
  showDateBanner(best);
}

function showDateBanner(dateStr) {
  const banner = document.getElementById('attDateBanner');
  const label  = document.getElementById('attDateLabel');
  if (!banner || !label) return;
  banner.style.display = 'flex';
  label.textContent = formatDateFull(dateStr);
}

function formatDateFull(d) {
  if (!d) return '';
  // 'YYYY-MM-DD' íŒŒì‹±: UTC ì˜¤í”„ì…‹ ì—†ì´ ë¡œì»¬ ë‚ ì§œë¡œ ë¶„í•´
  const [y, m, day] = d.split('-').map(Number);
  const dt = new Date(y, m - 1, day);          // ë¡œì»¬ ìì • â†’ ìš”ì¼ ì •í™•
  const days = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
  return y + 'ë…„ ' + m + 'ì›” ' + day + 'ì¼ (' + days[dt.getDay()] + ')';
}

async function loadAttendance(silentMerge = false) {
  const cls  = document.getElementById('attClass').value;
  const date = document.getElementById('attDate').value;
  if (!cls || !date) { document.getElementById('attList').innerHTML=''; return; }

  if (!silentMerge) {
    // ë°˜/ë‚ ì§œ ë°”ë€ ê²½ìš°: ë¡œì»¬ ìˆ˜ì • ì´ë ¥ ì´ˆê¸°í™” + ë¡œë”© í‘œì‹œ
    _locallyModified.clear();
    document.getElementById('attList').innerHTML = `<div class="loading"><div class="spinner"></div><span>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span></div>`;
  }

  // ë¦¬ë”ì‹­ ëª¨ë“œ: êµì‚¬ ëª©ë¡ìœ¼ë¡œ ì¶œì„ì²´í¬ (ì´ì „ ì €ì¥ê°’ í¬í•¨)
  if (cls === '__teachers__') {
    const r2 = await callGAS('getAttendance', {classGroup:'__teachers__', date});
    currentAttRecords = {};
    const attMap = {};
    if (r2.success && r2.data && r2.data.students) {
      r2.data.students.forEach(s => { attMap[s.studentId] = s; });
    }
    allTeachers.forEach(t => {
      const prev = attMap[t['êµì‚¬ID']];
      currentAttRecords[t['êµì‚¬ID']] = {
        studentId: t['êµì‚¬ID'],
        name: t['ì´ë¦„'],
        classGroup: '__teachers__',
        status: prev ? prev.status : 'ë¯¸ì²´í¬',
        reason: prev ? prev.reason : '',
        _isTeacher: true,
        _role: t['êµ¬ë¶„'],
        _class: t['ë‹´ë‹¹ í•™ë…„-ë°˜'] || '',
      };
    });
    renderAttList();
    return;
  }

  const r = await callGAS('getAttendance', {classGroup:cls, date});
  if (!r.success) { showToast(r.message,'error'); return; }

  const excluded = ['ì¥ê²°ì','ìœ í•™ì¤‘','ìœ í•™'];

  if (!silentMerge) {
    // ìµœì´ˆ ë¡œë“œ: ì „ë¶€ êµì²´
    currentAttRecords = {};
    r.data.students.forEach(s => {
      const stu = allStudents.find(st => st['í•™ìƒID'] === s.studentId);
      const status = stu ? stu['ìƒíƒœ'] : (s.status || '');
      if (excluded.includes(status)) return;
      currentAttRecords[s.studentId] = { ...s };
    });
  } else {
    // ì‹¤ì‹œê°„ í´ë§ ë¨¸ì§€: ë¡œì»¬ì—ì„œ ìˆ˜ì •í•˜ì§€ ì•Šì€ í•­ëª©ë§Œ ê°±ì‹ 
    r.data.students.forEach(s => {
      const stu = allStudents.find(st => st['í•™ìƒID'] === s.studentId);
      const status = stu ? stu['ìƒíƒœ'] : (s.status || '');
      if (excluded.includes(status)) return;
      if (_locallyModified.has(s.studentId)) return; // ë¡œì»¬ ìˆ˜ì • ìš°ì„ 
      currentAttRecords[s.studentId] = { ...s };
    });
  }
  renderAttList();
}

function renderAttList() {
  const el = document.getElementById('attList');
  const records = Object.values(currentAttRecords);
  if (!records.length) { el.innerHTML = `<div class="empty"><div class="empty-icon">ğŸ“‹</div>ëª…ë‹¨ì´ ì—†ìŠµë‹ˆë‹¤.</div>`; return; }

  document.getElementById('attSaveArea').style.display = 'block';
  el.innerHTML = records.map(r => {
    const subLabel = r._isTeacher
      ? `<span style="font-size:.72rem;color:var(--gray-500);">${r._role}${r._class ? ' Â· ' + r._class : ''}</span>`
      : '';
    const noteVal = r.note || '';
    return `
    <div class="att-row ${r.status==='ê²°ì„'?'absent':''}" id="att-${r.studentId}">
      <div class="att-name">${r.name} ${subLabel}</div>
      <div class="att-toggle">
        <button class="att-on ${r.status==='ì¶œì„'?'active':''}" onclick="setAtt('${r.studentId}','ì¶œì„')">ì¶œì„</button>
        <button class="att-off ${r.status==='ê²°ì„'?'active':''}" onclick="setAtt('${r.studentId}','ê²°ì„')">ê²°ì„</button>
        <button class="att-note-btn ${noteVal?'has-note':''}" onclick="toggleNoteInput('${r.studentId}')" title="íŠ¹ì´ì‚¬í•­">ğŸ“</button>
      </div>
    </div>
    ${r.status==='ê²°ì„'?`
    <div class="absence-reason" id="reason-${r.studentId}">
      <select class="form-control" id="sel-${r.studentId}" onchange="setReason('${r.studentId}',this.value)" style="font-size:.82rem;">
        <option value="">ê²°ì„ ì‚¬ìœ  ì„ íƒ</option>
        <option ${r.reason==='ë³‘ê°€'?'selected':''}>ë³‘ê°€</option>
        <option ${r.reason==='ê°œì¸ì‚¬ì •'?'selected':''}>ê°œì¸ì‚¬ì •</option>
        <option ${r.reason==='ê°€ì¡±ì¼ì •'?'selected':''}>ê°€ì¡±ì¼ì •</option>
        <option ${r.reason==='ìœ í•™'?'selected':''}>ìœ í•™</option>
        <option ${r.reason==='ê¸°íƒ€'?'selected':''}>ê¸°íƒ€</option>
      </select>
    </div>`:''}
    <div class="att-note-wrap" id="note-${r.studentId}" style="display:${noteVal?'block':'none'};">
      <input class="form-control att-note-input" id="noteinput-${r.studentId}"
        placeholder="íŠ¹ì´ì‚¬í•­ ì…ë ¥..." value="${noteVal.replace(/"/g,'&quot;')}"
        oninput="setNote('${r.studentId}',this.value)"
        style="font-size:.82rem;margin-top:4px;">
    </div>
  `}).join('');
}

function setAtt(id, status) {
  currentAttRecords[id].status = status;
  if (status === 'ì¶œì„') currentAttRecords[id].reason = '';
  _locallyModified.add(id); // ì‹¤ì‹œê°„ í´ë§ ì‹œ ë®ì–´ì“°ê¸° ë°©ì§€
  renderAttList();
}
function setReason(id, reason) {
  currentAttRecords[id].reason = reason;
  _locallyModified.add(id);
}

// â”€â”€ ì‹¤ì‹œê°„ ì¶œì„ í´ë§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function startAttPoll() {
  // ìë™ í´ë§ ë¹„í™œì„±í™” - ì‘ì—… ì¤‘ ë‚´ìš© ë¦¬ì…‹ ë°©ì§€
  // ì¶œì„ ë°ì´í„°ëŠ” ìˆ˜ë™ìœ¼ë¡œ ì €ì¥ ë²„íŠ¼ì„ í†µí•´ì„œë§Œ ê°±ì‹ ë¨
  stopAttPoll();
}
function stopAttPoll() {
  if (_pollInterval) { clearInterval(_pollInterval); _pollInterval = null; }
}
function toggleNoteInput(id) {
  const wrap = document.getElementById('note-' + id);
  if (!wrap) return;
  const isVisible = wrap.style.display !== 'none';
  wrap.style.display = isVisible ? 'none' : 'block';
  if (!isVisible) {
    const inp = document.getElementById('noteinput-' + id);
    if (inp) inp.focus();
  }
}
function setNote(id, val) {
  if (currentAttRecords[id]) {
    currentAttRecords[id].note = val;
    // ë²„íŠ¼ has-note í‘œì‹œ
    const rows = document.querySelectorAll(`[onclick*="toggleNoteInput('${id}')"]`);
    rows.forEach(btn => btn.classList.toggle('has-note', !!val));
  }
}

async function saveAttendance() {
  const cls  = document.getElementById('attClass').value;
  const date = document.getElementById('attDate').value;
  if (!cls || !date) return;

  const records = Object.values(currentAttRecords).map(r => ({
    studentId: r.studentId, name: r.name, status: r.status, reason: r.reason||'', note: r.note||''
  }));

  const r = await callGAS('saveAttendance', {classGroup:cls, date, records});
  if (!r.success) { showToast(r.message || 'ì €ì¥ ì˜¤ë¥˜', 'error'); return; }

  // êµì‚¬ ì¶œì„ì²´í¬ëŠ” ìƒíƒœ ìë™ë³€ê²½ ì—†ìŒ
  if (cls === '__teachers__') {
    showToast('âœ… êµì‚¬ ì¶œì„ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
    _locallyModified.clear();
    await loadStudents();
    renderDashboard();
    await loadAttendanceStats();
    return;
  }

  // â”€â”€ ìë™ ìƒíƒœ íŒì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const statusChanges = [];

  for (const rec of records) {
    // 1ìˆœìœ„: ìœ í•™ ì‚¬ìœ  â†’ ì¦‰ì‹œ ìœ í•™ì¤‘ (ë‹¤ë¥¸ íŒì •ë³´ë‹¤ ìš°ì„ )
    if (rec.reason === 'ìœ í•™' || rec.reason === 'í•´ì™¸ìœ í•™') {
      const changed = await applyStatusChange(rec.studentId, 'ìœ í•™ì¤‘');
      if (changed) statusChanges.push({ name: rec.name, newStatus: 'ìœ í•™ì¤‘' });
      continue;
    }

    // ìœ í•™ì¤‘ì´ì—ˆë‹¤ê°€ ì¶œì„í•˜ë©´ ë“±ë¡ìœ¼ë¡œ ë³µêµ¬
    const stu = allStudents.find(s=>s['í•™ìƒID']===rec.studentId);
    if (stu && stu['ìƒíƒœ']==='ìœ í•™ì¤‘' && rec.status==='ì¶œì„') {
      const changed = await applyStatusChange(rec.studentId, 'ë“±ë¡');
      if (changed) statusChanges.push({ name: rec.name, newStatus: 'ë“±ë¡ (ë³µêµ¬)' });
      continue;
    }
    if (stu && stu['ìƒíƒœ']==='ìœ í•™ì¤‘') continue; // ìœ í•™ì¤‘ì´ë©´ ë‹¤ë¥¸ íŒì • ê±´ë„ˆëœ€

    const history = await getConsecutiveAbsentCount(rec.studentId, date);

    if (history >= 12) {
      const changed = await applyStatusChange(rec.studentId, 'ì¥ê²°ì');
      if (changed) statusChanges.push({ name: rec.name, newStatus: 'ì¥ê²°ì' });
    } else if (history >= 2) {
      // ì´ë¯¸ ì¥ê²°ìë©´ ì‹¬ë°©í•„ìš”ë¡œ ë‚®ì¶”ì§€ ì•ŠìŒ
      if (stu && stu['ìƒíƒœ'] !== 'ì¥ê²°ì') {
        const changed = await applyStatusChange(rec.studentId, 'ì‹¬ë°©í•„ìš”');
        if (changed) { statusChanges.push({ name: rec.name, newStatus: 'ì‹¬ë°©í•„ìš”' }); showVisitAlert(rec.name); }
      }
    } else {
      // ì¶œì„ ë³µêµ¬
      if (stu && (stu['ìƒíƒœ']==='ì‹¬ë°©í•„ìš”' || stu['ìƒíƒœ']==='ì¥ê²°ì') && rec.status==='ì¶œì„') {
        const changed = await applyStatusChange(rec.studentId, 'ë“±ë¡');
        if (changed) statusChanges.push({ name: rec.name, newStatus: 'ë“±ë¡ (ë³µêµ¬)' });
      }
    }
  }

  // â”€â”€ ìƒˆì¹œêµ¬ 4ì£¼ ì™„ë£Œ ì•Œë¦¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  checkNewbieCompletion();

  // â”€â”€ ê²°ê³¼ ì•Œë¦¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (statusChanges.length > 0) {
    const msg = statusChanges.map(c=>`${c.name} â†’ ${c.newStatus}`).join(', ');
    showToast(`âœ… ì¶œì„ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. (ìƒíƒœ ë³€ê²½: ${msg})`, 'success');
    _locallyModified.clear();
  } else {
    showToast('âœ… ì¶œì„ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
    _locallyModified.clear();
  }

  await loadStudents();
  renderDashboard();
  await loadAttendanceStats();
  // ìƒíƒœ ë³€ê²½(ì¥ê²°ìâ†’ë“±ë¡ ë“±) ë°˜ì˜: í˜„ì¬ ë°˜ ì¶œì„ ëª©ë¡ ì¬ë¡œë“œ
  const clsAfter = document.getElementById('attClass').value;
  const dateAfter = document.getElementById('attDate').value;
  if (clsAfter && dateAfter) await loadAttendance();
}

// â”€â”€ ì—°ì† ê²°ì„/ë¯¸ì²´í¬ íšŸìˆ˜ (ì´ë²ˆ ê¸°ë¡ í¬í•¨) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function getConsecutiveAbsentCount(studentId, currentDate) {
  const r = await callGAS('getAttendanceHistory', { studentId, beforeDate: currentDate, weeks: 12 });
  if (!r.success || !r.data) return 0;
  // ì´ë²ˆ ê¸°ë¡ì„ ë§¨ ì•ì— ì¶”ê°€ (ì•„ì§ ì €ì¥ëœ ì§í›„ì´ë¯€ë¡œ í¬í•¨)
  const current = currentAttRecords[studentId];
  const fullHistory = current
    ? [{ date: currentDate, status: current.status || 'ë¯¸ì²´í¬', reason: current.reason||'' }, ...r.data]
    : r.data;

  let count = 0;
  for (const entry of fullHistory) {
    const isAbsent = entry.status === 'ê²°ì„' || entry.status === 'ë¯¸ì²´í¬' || !entry.status;
    if (isAbsent) count++;
    else break;
  }
  return count;
}

// â”€â”€ ì¶œì„ í†µê³„ ë¡œë“œ ë° ë Œë” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadAttendanceStats() {
  if (!currentUser || currentUser.role !== 'admin') return;
  const r = await callGAS('getAttendanceStats', {});
  if (!r.success) return;
  renderAttendanceStats(r.data);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì¶œì„í˜„í™© íƒ­ ë¡œì§
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _attstatMode = 'student'; // 'student' | 'teacher'
let _attstatData = null;      // { headers, rows, dates }


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì¶œì„ ë¸Œë¦¬í•‘ & ì¶”ì´ ë¶„ì„ (êµì—­ììš©)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let _briefingData = null;

async function loadWeeklyBriefing() {
  const panel = document.getElementById('weeklyBriefingPanel');
  if (!panel) return;
  if (currentUser?.role !== 'admin') { panel.style.display='none'; return; }

  panel.style.display = 'block';
  panel.innerHTML = '<div class="loading"><div class="spinner"></div><span>ë¸Œë¦¬í•‘ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span></div>';

  const r = await callGAS('getWeeklyBriefing', {});
  if (!r.success || !r.data) { panel.style.display='none'; return; }

  _briefingData = r.data;
  const d = r.data;
  const rate = d.total > 0 ? Math.round(d.present / d.total * 100) : 0;

  const dateStr = d.lastSunday ? (d.lastSunday.slice(5,7)*1) + '/' + (d.lastSunday.slice(8,10)*1) + ' ì£¼ì¼' : '';
  const weekStr = d.weekStart && d.weekEnd
    ? `(${d.weekStart.slice(5,7)*1}/${d.weekStart.slice(8,10)*1} ~ ${d.weekEnd.slice(5,7)*1}/${d.weekEnd.slice(8,10)*1})`
    : '';

  panel.innerHTML = `
    <div style="background:linear-gradient(135deg,#EFF6FF,#F0FDF4);border:1.5px solid #BAE6FD;border-radius:12px;padding:14px 16px;">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
        <div>
          <div style="font-size:.78rem;font-weight:800;color:var(--primary);">ğŸ“‹ ì´ë²ˆì£¼ ì¶œì„ ë¸Œë¦¬í•‘</div>
          <div style="font-size:.7rem;color:var(--gray-400);margin-top:2px;">${dateStr} ê¸°ì¤€ ${weekStr}</div>
        </div>
        <button onclick="openTrendPopup()" style="
          background:var(--primary);color:#fff;border:none;border-radius:8px;
          padding:7px 12px;font-size:.75rem;font-weight:700;cursor:pointer;">
          ğŸ“ˆ ì¶”ì´ ë¶„ì„
        </button>
      </div>
      <div class="briefing-grid">
        <div class="briefing-card" style="border-color:#BFDBFE;">
          <div class="num" style="color:var(--primary);">${d.present}<span style="font-size:.9rem;color:var(--gray-400);">/${d.total}</span></div>
          <div class="lbl">ì¶œì„ ì¸ì›<span style="display:block;color:var(--primary);font-weight:700;">${rate}%</span></div>
        </div>
        <div class="briefing-card" style="border-color:#FEF08A;">
          <div class="num" style="color:#CA8A04;">${d.visitNeeded}</div>
          <div class="lbl">ì‹¬ë°©í•„ìš”</div>
        </div>
        <div class="briefing-card" style="border-color:#FECACA;">
          <div class="num" style="color:#DC2626;">${d.longAbsent}</div>
          <div class="lbl">ì¥ê²°ì</div>
        </div>
        <div class="briefing-card" style="border-color:#BBF7D0;">
          <div class="num" style="color:var(--green);">${d.total - d.visitNeeded - d.longAbsent}</div>
          <div class="lbl">ë“±ë¡ (ì •ìƒ)</div>
        </div>
      </div>
    </div>`;
}

function openTrendPopup() {
  const popup = document.getElementById('trendPopup');
  if (popup) popup.style.display = 'flex';
  loadTrend(3);
}

function closeTrendPopup() {
  const popup = document.getElementById('trendPopup');
  if (popup) popup.style.display = 'none';
}

async function loadTrend(months) {
  // ë²„íŠ¼ active ìƒíƒœ
  document.querySelectorAll('.trend-period-btn').forEach(b => {
    b.classList.toggle('active', parseInt(b.dataset.months) === months);
  });

  const el = document.getElementById('trendContent');
  if (!el) return;
  el.innerHTML = '<div class="loading"><div class="spinner"></div><span>ê³„ì‚° ì¤‘...</span></div>';

  const r = await callGAS('getAttendanceTrend', { months });
  if (!r.success || !r.data) {
    el.innerHTML = '<div class="empty">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
    return;
  }
  const data = r.data;

  // í˜„ì¬ ìƒíƒœ ìŠ¤ëƒ…ìƒ·
  const snap = data.snapshot || {};
  const monthly = data.monthly || [];
  const trend   = data.trend   || [];

  // ìµœê³ /ìµœì € ì¶œì„ë¥ 
  const rates = monthly.filter(m=>m.enrolled>0).map(m=>m.rate);
  const maxRate = rates.length ? Math.max(...rates) : 0;
  const minRate = rates.length ? Math.min(...rates) : 0;
  const avgRate = rates.length ? Math.round(rates.reduce((a,b)=>a+b,0)/rates.length) : 0;

  // ë°” ì°¨íŠ¸ ë Œë”ë§
  const maxPresent = Math.max(...monthly.map(m=>m.enrolled||1), 1);
  const chartHtml = monthly.map(m => {
    const barH = m.enrolled > 0 ? Math.round(m.present / m.enrolled * 80) : 0;
    const mo = m.month.slice(5,7)*1;
    const rateCol = m.rate >= 70 ? '#16A34A' : m.rate >= 50 ? '#D97706' : '#DC2626';
    return `
      <div style="display:flex;flex-direction:column;align-items:center;gap:3px;flex:1;min-width:0;">
        <div style="font-size:.65rem;color:${rateCol};font-weight:700;">${m.rate}%</div>
        <div style="width:100%;height:80px;background:var(--gray-100);border-radius:4px;display:flex;align-items:flex-end;overflow:hidden;">
          <div style="width:100%;height:${barH}%;background:${rateCol};border-radius:4px;transition:height .5s;"></div>
        </div>
        <div style="font-size:.65rem;color:var(--gray-500);text-align:center;">${mo}ì›”</div>
        <div style="font-size:.68rem;color:var(--gray-700);font-weight:600;">${m.present}</div>
      </div>`;
  }).join('');

  el.innerHTML = `
    <!-- ìŠ¤ëƒ…ìƒ· -->
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-bottom:14px;">
      <div style="background:#EFF6FF;border-radius:8px;padding:10px;text-align:center;">
        <div style="font-size:1.4rem;font-weight:800;color:var(--primary);">${snap.enrolled||0}</div>
        <div style="font-size:.65rem;color:var(--gray-500);">ë“±ë¡</div>
      </div>
      <div style="background:#FFFBEB;border-radius:8px;padding:10px;text-align:center;">
        <div style="font-size:1.4rem;font-weight:800;color:#CA8A04;">${snap.visitNeeded||0}</div>
        <div style="font-size:.65rem;color:var(--gray-500);">ì‹¬ë°©í•„ìš”</div>
      </div>
      <div style="background:#FEF2F2;border-radius:8px;padding:10px;text-align:center;">
        <div style="font-size:1.4rem;font-weight:800;color:#DC2626;">${snap.longAbsent||0}</div>
        <div style="font-size:.65rem;color:var(--gray-500);">ì¥ê²°ì</div>
      </div>
    </div>
    <!-- í†µê³„ ìš”ì•½ -->
    <div style="background:var(--gray-50);border-radius:8px;padding:10px 12px;margin-bottom:12px;display:flex;justify-content:space-between;">
      <div style="text-align:center;"><div style="font-size:1rem;font-weight:800;color:var(--primary);">${avgRate}%</div><div style="font-size:.65rem;color:var(--gray-400);">í‰ê·  ì¶œì„ë¥ </div></div>
      <div style="text-align:center;"><div style="font-size:1rem;font-weight:800;color:#16A34A;">${maxRate}%</div><div style="font-size:.65rem;color:var(--gray-400);">ìµœê³ </div></div>
      <div style="text-align:center;"><div style="font-size:1rem;font-weight:800;color:#DC2626;">${minRate}%</div><div style="font-size:.65rem;color:var(--gray-400);">ìµœì €</div></div>
      <div style="text-align:center;"><div style="font-size:1rem;font-weight:800;">${months}ê°œì›”</div><div style="font-size:.65rem;color:var(--gray-400);">ê¸°ê°„</div></div>
    </div>
    <!-- ë°” ì°¨íŠ¸ -->
    <div style="font-size:.75rem;font-weight:700;color:var(--gray-600);margin-bottom:8px;">ì›”ë³„ ì¶œì„ í˜„í™©</div>
    <div style="display:flex;gap:4px;align-items:flex-end;padding:4px 0;">
      ${chartHtml || '<div style="font-size:.8rem;color:var(--gray-400);padding:16px;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>'}
    </div>
    <!-- ì£¼ë³„ ìƒì„¸ í…Œì´ë¸” -->
    ${trend.length > 0 ? `
    <div style="font-size:.75rem;font-weight:700;color:var(--gray-600);margin:12px 0 6px;">ì£¼ë³„ ìƒì„¸</div>
    <div style="overflow-x:auto;">
    <table style="width:100%;border-collapse:collapse;font-size:.75rem;">
      <thead><tr>
        <th style="padding:5px 8px;background:var(--gray-100);border-radius:4px;text-align:left;">ë‚ ì§œ</th>
        <th style="padding:5px 8px;background:var(--gray-100);text-align:center;">ì¬ì </th>
        <th style="padding:5px 8px;background:var(--gray-100);text-align:center;">ì¶œì„</th>
        <th style="padding:5px 8px;background:var(--gray-100);text-align:center;">ì¶œì„ë¥ </th>
      </tr></thead>
      <tbody>
        ${trend.slice().reverse().map(t => {
          const rc = t.rate >= 70 ? '#16A34A' : t.rate >= 50 ? '#D97706' : '#DC2626';
          return `<tr>
            <td style="padding:5px 8px;">${t.date.slice(5,7)*1}/${t.date.slice(8,10)*1}</td>
            <td style="padding:5px 8px;text-align:center;">${t.enrolled}</td>
            <td style="padding:5px 8px;text-align:center;">${t.present}</td>
            <td style="padding:5px 8px;text-align:center;color:${rc};font-weight:700;">${t.rate}%</td>
          </tr>`;
        }).join('')}
      </tbody>
    </table></div>` : ''}`;
}

async function initAttstatView() {
  const role = currentUser ? currentUser.role : '';
  const isAdmin      = role === 'admin';
  const isLeadership = role === 'leadership';
  const isTeacher    = role === 'teacher';
  const isNewbieT    = role === 'newbie_teacher';

  // êµì—­ì: í•™ìƒ/êµì‚¬ íƒ­ í‘œì‹œ
  const tabBar = document.getElementById('attstatTabBar');
  if (tabBar) tabBar.style.display = isAdmin ? 'flex' : 'none';

  // ë°˜ ì„ íƒ ë°” (êµì—­ìÂ·êµì‚¬)
  const classBar = document.getElementById('attstatClassBar');
  const classEl  = document.getElementById('attstatClass');

  if (isAdmin) {
    _attstatMode = 'student';
    setAttstatMode('student');
    loadWeeklyBriefing(); // êµì—­ììš© ë¸Œë¦¬í•‘ ë¡œë“œ
  } else if (isLeadership) {
    _attstatMode = 'teacher';
    // ë¦¬ë”ì‹­ ê²¸ ë‹´ì„ ì—¬ë¶€ í™•ì¸
    const myClass = currentUser.classGroup || '';
    const myClasses = myClass.split(',').map(c=>c.trim()).filter(c=>c);
    const isLeaderAndTeacher = myClasses.length > 0;

    if (tabBar) tabBar.style.display = isLeaderAndTeacher ? 'flex' : 'none';

    if (isLeaderAndTeacher) {
      // íƒ­ ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
      const tabStudent = document.getElementById('attstatTabStudent');
      if (tabStudent) tabStudent.textContent = 'ğŸ“š ' + myClasses.join(', ') + ' í˜„í™©';
      document.getElementById('attstatTabStudent').classList.remove('active');
      document.getElementById('attstatTabTeacher').classList.add('active');
      if (classBar) classBar.style.display = 'none';
      await _loadAttstatData('__teachers__');
    } else {
      if (classBar) classBar.style.display = 'none';
      await _loadAttstatData('__teachers__');
    }
  } else {
    // êµì‚¬: ë‹´ë‹¹ ë°˜ ê³ ì •
    _attstatMode = 'student';
    if (classBar) classBar.style.display = 'none';
    const myClass = currentUser.classGroup || '';
    if (myClass) {
      await _loadAttstatData(myClass);
    } else {
      document.getElementById('attstatContent').innerHTML =
        '<div class="empty"><div class="empty-icon">ğŸ“‹</div>ë‹´ë‹¹ ë°˜ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
    }
  }
}

async function setAttstatMode(mode) {
  _attstatMode = mode;
  const isAdmin      = currentUser && currentUser.role === 'admin';
  const isLeadership = currentUser && currentUser.role === 'leadership';
  document.getElementById('attstatTabStudent').classList.toggle('active', mode === 'student');
  document.getElementById('attstatTabTeacher').classList.toggle('active', mode === 'teacher');

  const classBar = document.getElementById('attstatClassBar');
  const classEl  = document.getElementById('attstatClass');

  if (mode === 'teacher') {
    if (classBar) classBar.style.display = 'none';
    await _loadAttstatData('__teachers__');
  } else {
    // í•™ìƒ ëª¨ë“œ: ë°˜ ì„ íƒ
    if (classBar && (isAdmin || isLeadership)) classBar.style.display = 'block';
    // ë°˜ ëª©ë¡ ë¹Œë“œ
    const validSt = ['ë“±ë¡','ì‹¬ë°©í•„ìš”'];
    const allClasses = [...new Set(allStudents.filter(s=>validSt.includes(s['ìƒíƒœ'])).map(s=>s['í•™ë…„-ë°˜']))]
      .sort((a,b)=>_attstatClassOrder(a).localeCompare(_attstatClassOrder(b)));

    // ë¦¬ë”ì‹­ ê²¸ ë‹´ì„: ë‹´ë‹¹ ë°˜ë§Œ ì„ íƒ ê°€ëŠ¥
    const myClass2 = currentUser ? (currentUser.classGroup || '') : '';
    const myClasses2 = myClass2.split(',').map(c=>c.trim()).filter(c=>c);
    const classes = (isLeadership && myClasses2.length) ? myClasses2 : allClasses;

    if (classEl) {
      const allOpt = (isAdmin) ? '<option value="">ì „ì²´ (ë°˜ë³„)</option>' : '';
      classEl.innerHTML = allOpt + classes.map(c=>`<option value="${c}">${c}</option>`).join('');
      if (isLeadership && myClasses2.length) classEl.value = myClasses2[0];
    }
    await _loadAttstatData(classEl ? classEl.value : '');
  }
}

function _attstatClassOrder(c) {
  const order = ['ì´ˆ6','ì¤‘1','ì¤‘2','ì¤‘3','ê³ 1','ê³ 2','ê³ 3'];
  for (let i=0;i<order.length;i++) if (c.startsWith(order[i])) return String(i).padStart(2,'0')+'_'+c;
  return '99_'+c;
}

async function renderAttstatTable() {
  const classEl = document.getElementById('attstatClass');
  await _loadAttstatData(classEl ? classEl.value : '');
}

async function _loadAttstatData(classFilter) {
  const el = document.getElementById('attstatContent');
  el.innerHTML = '<div class="loading"><div class="spinner"></div><span>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span></div>';

  const r = await callGAS('getAttendanceTable', { classFilter, mode: _attstatMode });
  if (!r.success) {
    const isGasError = (r.message||'').includes('ì•Œ ìˆ˜ ì—†ëŠ” ì•¡ì…˜');
    const msg = isGasError
      ? 'âš ï¸ GAS ì¬ë°°í¬ í•„ìš”: Code.gsë¥¼ ìµœì‹  ë²„ì „ìœ¼ë¡œ êµì²´ í›„ ìƒˆ ë²„ì „ìœ¼ë¡œ ë°°í¬í•˜ì„¸ìš”.'
      : (r.message || 'ë°ì´í„° ì˜¤ë¥˜');
    el.innerHTML = `<div class="empty" style="padding:30px 16px;"><div class="empty-icon">âš ï¸</div><div style="font-size:.82rem;color:var(--danger);line-height:1.6;">${msg}</div></div>`;
    return;
  }
  _renderAttstatGrid(r.data);
}

function _renderAttstatGrid(data) {
  const el = document.getElementById('attstatContent');
  if (!data || !data.rows || !data.rows.length) {
    el.innerHTML = '<div class="empty"><div class="empty-icon">ğŸ“Š</div>ì¶œì„ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
    return;
  }

  const { dates, rows } = data;
  // ë‚ ì§œ í¬ë§·: YYYY-MM-DD â†’ M/D
  function fmtDate(d) {
    const parts = String(d).split('-');
    if (parts.length===3) return parseInt(parts[1])+'/'+parseInt(parts[2]);
    return d;
  }

  let html = '<div class="attstat-wrap"><table class="attstat-table"><thead><tr>';
  html += '<th style="min-width:72px;">ì´ë¦„</th>';
  dates.forEach(d => { html += `<th>${fmtDate(d)}</th>`; });
  html += '</tr></thead><tbody>';

  rows.forEach(row => {
    html += '<tr>';
    html += `<td title="${row.name}">${row.name}${row.cls ? '<br><span style="font-size:.65rem;color:var(--gray-400);">'+row.cls+'</span>' : ''}</td>`;
    dates.forEach(d => {
      const v = row.values[d] || '';
      if (v === 'o') html += '<td class="att-o">â—‹</td>';
      else if (v && v.startsWith('ê²°ì„')) {
        const reason = v.match(/\((.+)\)/);
        html += `<td class="att-x" title="${reason?reason[1]:'ê²°ì„'}">âœ•</td>`;
      }
      else html += '<td class="att-empty">-</td>';
    });
    html += '</tr>';
  });

  html += '</tbody></table></div>';
  el.innerHTML = html;
}

function renderAttendanceStats(stats) {
  const panel = document.getElementById('attStatsPanel');
  const list  = document.getElementById('attStatsList');
  if (!panel || !list) return;

  if (!stats || !stats.length) {
    panel.style.display = 'none';
    return;
  }
  panel.style.display = 'block';

  list.innerHTML = `
    <table class="att-stats-table">
      <thead>
        <tr>
          <th>ë‚ ì§œ</th>
          <th>ì¬ì </th>
          <th>ì¶œì„</th>
          <th>ì¶œì„ë¥ </th>
        </tr>
      </thead>
      <tbody>
        ${stats.slice().reverse().slice(0,10).map(s => {
          const rateClass = s.rate >= 80 ? '' : s.rate >= 60 ? 'mid' : 'low';
          return `<tr>
            <td>${formatDateShort(s.date)}</td>
            <td>${s.total}</td>
            <td>${s.present}</td>
            <td class="att-stats-rate ${rateClass}">${s.rate}%</td>
          </tr>`;
        }).join('')}
      </tbody>
    </table>`;
}

function formatDateShort(d) {
  if (!d) return '';
  const [y,m,day] = d.split('-');
  return `${m}/${day}`;
}

// â”€â”€ ìƒˆì¹œêµ¬ 4ì£¼ ì¶œì„ ì™„ë£Œ ì•Œë¦¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function checkNewbieCompletion() {
  if (!currentUser || currentUser.role !== 'admin') return;
  const completed = allNewbies.filter(n => {
    const done = [1,2,3,4].every(w => n[`${w}ì£¼ì°¨ì¶œê²°`] === 'ì¶œì„');
    return done && n['ë°˜ë°°ì •ì™„ë£Œì—¬ë¶€'] !== 'TRUE';
  });
  if (completed.length > 0) {
    // ìƒë‹¨ ê³ ì • ì•Œë¦¼ ë°°ë„ˆ
    const existBanner = document.getElementById('newbieReadyBanner');
    if (!existBanner) {
      const banner = document.createElement('div');
      banner.id = 'newbieReadyBanner';
      banner.style.cssText = 'position:fixed;top:0;left:0;right:0;z-index:9999;background:linear-gradient(135deg,#065F46,#047857);color:#fff;padding:12px 16px;display:flex;align-items:center;justify-content:space-between;gap:10px;box-shadow:0 2px 12px rgba(0,0,0,.3);';
      banner.innerHTML = `
        <div style="display:flex;align-items:center;gap:10px;">
          <span style="font-size:1.3rem;">ğŸŒ±</span>
          <div>
            <div style="font-size:.88rem;font-weight:700;">ë°˜ë°°ì • í•„ìš” ìƒˆì¹œêµ¬ ${completed.length}ëª…</div>
            <div style="font-size:.75rem;opacity:.85;">${completed.map(n=>n['ì´ë¦„']).join(', ')}</div>
          </div>
        </div>
        <div style="display:flex;gap:8px;align-items:center;">
          <button onclick="document.querySelector('.nav-btn[data-view=newbie]').click();document.getElementById('newbieReadyBanner').remove();"
            style="background:rgba(255,255,255,.25);border:1.5px solid rgba(255,255,255,.5);color:#fff;border-radius:6px;padding:5px 12px;font-size:.78rem;cursor:pointer;font-weight:600;">
            ìƒˆì¹œêµ¬ íƒ­ ì´ë™
          </button>
          <button onclick="this.parentElement.parentElement.remove();" style="background:none;border:none;color:#fff;font-size:1.1rem;cursor:pointer;opacity:.7;">âœ•</button>
        </div>`;
      document.body.prepend(banner);
    }
  }
  completed.forEach(n => { showNewbieAlert(n['ì´ë¦„']); });
}

function showNewbieAlert(name) {
  const existing = document.getElementById(`newbieAlert_${name}`);
  if (existing) return;
  const banner = document.createElement('div');
  banner.id = `newbieAlert_${name}`;
  banner.style.cssText = `
    position:fixed;bottom:80px;left:50%;transform:translateX(-50%);
    background:linear-gradient(135deg,#065F46,#047857);
    color:#fff;padding:13px 20px;border-radius:var(--radius);
    font-size:.88rem;font-weight:700;
    box-shadow:0 8px 24px rgba(0,0,0,.25);
    z-index:9999;cursor:pointer;
    animation:slideUp .3s ease;max-width:90vw;text-align:center;
  `;
  banner.innerHTML = `ğŸ‰ ${name} í•™ìƒ ë°˜ë°°ì • ìš”ë§`;
  banner.onclick = () => banner.remove();
  document.body.appendChild(banner);
  setTimeout(() => banner && banner.remove(), 8000);
}

// êµì—­ì ì‹¬ë°©í•„ìš” íŒì—… ì•Œë¦¼
const _visitAlertShown = new Set();
function showVisitAlert(name) {
  if (!currentUser || currentUser.role !== 'admin') return;
  if (_visitAlertShown.has(name)) return;
  _visitAlertShown.add(name);

  const id = `visitAlert_${name}`;
  const existing = document.getElementById(id);
  if (existing) return;

  // ìŠ¤íƒí˜• ìœ„ì¹˜ ê³„ì‚° (ì—¬ëŸ¬ ê°œ ê²¹ì¹˜ì§€ ì•Šê²Œ)
  const bannerCount = document.querySelectorAll('[id^="visitAlert_"]').length;
  const bottomOffset = 80 + bannerCount * 68;

  const banner = document.createElement('div');
  banner.id = id;
  banner.style.cssText = `
    position:fixed;bottom:${bottomOffset}px;left:50%;transform:translateX(-50%);
    background:linear-gradient(135deg,#7C2D12,#B45309);
    color:#fff;padding:12px 20px;border-radius:var(--radius);
    font-size:.85rem;font-weight:700;
    box-shadow:0 8px 24px rgba(0,0,0,.25);
    z-index:9998;cursor:pointer;
    animation:slideUp .3s ease;max-width:90vw;text-align:center;
    display:flex;align-items:center;gap:8px;
  `;
  banner.innerHTML = `âš ï¸ ${name} í•™ìƒ ì‹¬ë°© í•„ìš”`;
  banner.onclick = () => { banner.remove(); _visitAlertShown.delete(name); };
  document.body.appendChild(banner);
  setTimeout(() => { banner && banner.remove(); _visitAlertShown.delete(name); }, 10000);
}

// í•™ìƒ ìƒíƒœ ë³€ê²½ (ë³€ê²½ ë°œìƒ ì—¬ë¶€ ë°˜í™˜)
async function applyStatusChange(studentId, newStatus) {
  const stu = allStudents.find(s => s['í•™ìƒID'] === studentId);
  if (!stu) return false;
  if (stu['ìƒíƒœ'] === newStatus) return false; // ì´ë¯¸ ê°™ì€ ìƒíƒœ

  const payload = {
    id: studentId,
    name: stu['ì´ë¦„'],
    classGroup: stu['í•™ë…„-ë°˜'],
    teacher: stu['ë‹´ì„êµì‚¬'] || '',
    gender: stu['ì„±ë³„'] || '',
    age: stu['ë‚˜ì´'] || '',
    birthdate: stu['ìƒë…„ì›”ì¼'] || '',
    contact: stu['ë³¸ì¸ì—°ë½ì²˜'] || '',
    parentContactFather: stu['í•™ë¶€ëª¨ì—°ë½ì²˜(ë¶€)'] || stu['í•™ë¶€ëª¨ì—°ë½ì²˜'] || '',
    parentContactMother: stu['í•™ë¶€ëª¨ì—°ë½ì²˜(ëª¨)'] || '',
    address: stu['ì£¼ì†Œ'] || '',
    status: newStatus,
  };

  const r = await callGAS('updateStudent', payload);
  if (r.success) {
    stu['ìƒíƒœ'] = newStatus; // ë¡œì»¬ ìƒíƒœë„ ì¦‰ì‹œ ë°˜ì˜
    return true;
  }
  return false;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ìƒˆì¹œêµ¬ ê´€ë¦¬
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// êµ¬ê¸€ í¼ ì—°ë™
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function saveFormUrl() {
  const url = document.getElementById('formUrlInput').value.trim();
  if (!url) return;
  try { localStorage.setItem('formUrl', url); } catch(e) {}
  document.getElementById('formUrlSaved').style.display = 'block';
  setTimeout(()=>document.getElementById('formUrlSaved').style.display='none', 2000);
}

async function syncFormNewbies() {
  const btn = document.getElementById('syncBtn');
  btn.disabled = true;
  btn.textContent = 'â³ ìƒˆë¡œê³ ì¹¨ ì¤‘...';

  if (!GAS_URL) {
    showToast('ë°ëª¨ ëª¨ë“œ: GAS_URL ì—°ê²° í•„ìš”', 'error');
    btn.disabled = false; btn.textContent = 'ğŸ”„ ìƒˆì¹œêµ¬ ìƒˆë¡œê³ ì¹¨';
    return;
  }

  try {
    const r = await callGAS('syncFormResponses', {});
    if (r.success) {
      const added = r.data && r.data.added ? r.data.added : 0;
      const sheetName = r.data && r.data.sheetName ? r.data.sheetName : '';
      const totalRows = r.data && r.data.totalRows ? r.data.totalRows : 0;
      await loadNewbies();
      renderNewbieList();
      const msg = added > 0
        ? `âœ… ${added}ëª… ì¶”ê°€ë¨ (ì‹œíŠ¸: ${sheetName}, ì´ ${totalRows}ê±´)`
        : `ì‹œíŠ¸ "${sheetName}" ì—°ê²°ë¨. ìƒˆ ì‘ë‹µ ì—†ìŒ (ì´ ${totalRows}ê±´)`;
      showToast(msg, added > 0 ? 'success' : '');
    } else {
      // ì‹¤íŒ¨ ì‹œ ìƒì„¸ ì˜¤ë¥˜ + ì§„ë‹¨ ì•ˆë‚´
      const errMsg = r.message || 'ë™ê¸°í™” ì‹¤íŒ¨';
      showToast('âŒ ' + errMsg.split('\n')[0], 'error');
      // ì§„ë‹¨ ëª¨ë‹¬ í‘œì‹œ
      _showFormDiagnoseResult(errMsg);
    }
  } catch(e) {
    showToast('ë™ê¸°í™” ì˜¤ë¥˜: ' + e.message, 'error');
  } finally {
    btn.disabled = false;
    btn.textContent = 'ğŸ”„ ìƒˆì¹œêµ¬ ìƒˆë¡œê³ ì¹¨';
  }
}

// í¼ ì—°ë™ ì‹¤íŒ¨ ì‹œ ì§„ë‹¨ ê²°ê³¼ í‘œì‹œ
async function _showFormDiagnoseResult(errMsg) {
  let diagInfo = errMsg;
  try {
    const r = await callGAS('diagnoseFormSheet', {});
    if (r.success) {
      const { sheets, formCandidates } = r.data;
      const sheetList = sheets.map(s => `â€¢ ${s.name} (${s.rows}í–‰)`).join('\n');
      const candidates = formCandidates.length > 0
        ? '\n\nğŸ“‹ í¼ ì‘ë‹µ í›„ë³´ ì‹œíŠ¸:\n' + formCandidates.map(c => `â€¢ ${c.name}\n  í—¤ë”: ${c.headers.slice(0,4).join(', ')}`).join('\n')
        : '\n\nâš ï¸ íƒ€ì„ìŠ¤íƒ¬í”„ ì—´ì´ ìˆëŠ” ì‹œíŠ¸ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.';
      diagInfo = 'í˜„ì¬ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì‹œíŠ¸ ëª©ë¡:\n' + sheetList + candidates
        + '\n\nğŸ’¡ í•´ê²°: Code.gs ìƒë‹¨ì˜ FORM_RESPONSE_SHEET = \'ì„¤ë¬¸ì§€ ì‘ë‹µ 1\' ë¥¼ ì‹¤ì œ ì‹œíŠ¸ ì´ë¦„ìœ¼ë¡œ ë³€ê²½ í›„ ì¬ë°°í¬';
    }
  } catch(e) {}
  alert('ğŸ” í¼ ì—°ë™ ì§„ë‹¨\n\n' + diagInfo);
}

// â”€â”€ ì •ë ¬ ë“œë¡­ë‹¤ìš´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SORT_LABELS = {
  name_asc:  'ì´ë¦„ â†‘ ì˜¤ë¦„ì°¨ìˆœ',
  name_desc: 'ì´ë¦„ â†“ ë‚´ë¦¼ì°¨ìˆœ',
  age_asc:   'ë‚˜ì´ â†‘ ì–´ë¦° ìˆœ',
  age_desc:  'ë‚˜ì´ â†“ ë§ì€ ìˆœ',
  weeks_asc: 'ì¶œì„ â†‘ ì ì€ ìˆœ',
  weeks_desc:'ì¶œì„ â†“ ë§ì€ ìˆœ',
  date_asc:  'ë“±ë¡ë‚ ì§œ â†‘ ì˜¤ë˜ëœ ìˆœ',
  date_desc: 'ë“±ë¡ë‚ ì§œ â†“ ìµœì‹  ìˆœ',
};

function toggleSortMenu() {
  const btn  = document.getElementById('sortDropdownBtn');
  const menu = document.getElementById('sortMenu');
  const isOpen = menu.classList.contains('open');
  if (isOpen) {
    menu.classList.remove('open');
    btn.classList.remove('open');
  } else {
    menu.classList.add('open');
    btn.classList.add('open');
  }
}

function closeSortMenu() {
  document.getElementById('sortMenu').classList.remove('open');
  document.getElementById('sortDropdownBtn').classList.remove('open');
}

function setNewbieSort(key) {
  newbieSortKey = key;

  // ë¼ë²¨ ì—…ë°ì´íŠ¸
  document.getElementById('sortLabel').textContent = SORT_LABELS[key] || key;

  // ë©”ë‰´ ì•„ì´í…œ active ì²˜ë¦¬
  document.querySelectorAll('.sort-menu-item').forEach(item => {
    if (item.dataset.sort === key) {
      item.classList.add('active');
    } else {
      item.classList.remove('active');
    }
  });

  // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
  closeSortMenu();

  // ëª©ë¡ ë‹¤ì‹œ ë Œë”
  renderNewbieList();
}

// ë“œë¡­ë‹¤ìš´ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
document.addEventListener('click', function(e) {
  const wrap = document.getElementById('sortDropdownWrap');
  if (wrap && !wrap.contains(e.target)) closeSortMenu();
});
// MM.DD í…ìŠ¤íŠ¸ â†’ ì €ì¥ìš© ë¬¸ìì—´ (ê·¸ëŒ€ë¡œ ì‚¬ìš©)
function parseMmDd(val) {
  // ì‚¬ìš©ìê°€ ì…ë ¥í•œ MM.DD í˜•ì‹ ê·¸ëŒ€ë¡œ ë°˜í™˜ (ë¹ˆê°’ì´ë©´ '')
  return (val || '').trim();
}

// ì €ì¥ëœ ë‚ ì§œ ê°’ â†’ MM.DD í‘œì‹œìš© (YYYY-MM-DD í˜•ì‹ì´ë©´ ë³€í™˜, ì•„ë‹ˆë©´ ê·¸ëŒ€ë¡œ)
function toMmDd(val) {
  if (!val) return '';
  const m = String(val).match(/^(\d{4})-(\d{2})-(\d{2})$/);
  if (m) return m[2] + '.' + m[3];
  return val;
}

function renderNewbieList() {
  const el = document.getElementById('newbieList');
  let active = allNewbies.filter(n => n['ë°˜ë°°ì •ì™„ë£Œì—¬ë¶€'] !== 'TRUE' && n['ë°˜ë°°ì •ì™„ë£Œì—¬ë¶€'] !== true);

  // â”€â”€ ì •ë ¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  active = active.slice().sort((a, b) => {
    const [field, dir] = newbieSortKey.split('_'); // e.g. 'name', 'asc'
    const asc = dir === 'asc';

    if (field === 'name') {
      const cmp = (a['ì´ë¦„'] || '').localeCompare(b['ì´ë¦„'] || '', 'ko');
      return asc ? cmp : -cmp;
    } else if (field === 'weeks') {
      const wA = [1,2,3,4].filter(w => a[`${w}ì£¼ì°¨ì¶œê²°`] === 'ì¶œì„').length;
      const wB = [1,2,3,4].filter(w => b[`${w}ì£¼ì°¨ì¶œê²°`] === 'ì¶œì„').length;
      return asc ? wA - wB : wB - wA;
    } else if (field === 'age') {
      const stuA = allStudents.find(s => s['í•™ìƒID'] === a['í•™ìƒID']);
      const stuB = allStudents.find(s => s['í•™ìƒID'] === b['í•™ìƒID']);
      const ageA = stuA ? (parseInt(stuA['ë‚˜ì´']) || 0) : 0;
      const ageB = stuB ? (parseInt(stuB['ë‚˜ì´']) || 0) : 0;
      return asc ? ageA - ageB : ageB - ageA;
    } else if (field === 'date') {
      const dA = String(a['ë“±ë¡ë‚ ì§œ'] || '');
      const dB = String(b['ë“±ë¡ë‚ ì§œ'] || '');
      return asc ? dA.localeCompare(dB) : dB.localeCompare(dA);
    }
    return 0;
  });

  if (!active.length) {
    el.innerHTML = `<div class="empty"><div class="empty-icon">ğŸŒ±</div>ìƒˆì¹œêµ¬ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
    return;
  }

  el.innerHTML = active.map(n => {
    // í•™ìƒ ì •ë³´ (í•™ë…„-ë°˜, ì„±ë³„) ê°€ì ¸ì˜¤ê¸°
    const stu = n['í•™ìƒID'] ? allStudents.find(s => s['í•™ìƒID'] === n['í•™ìƒID'])
                              : allStudents.find(s => s['ì´ë¦„'] === n['ì´ë¦„']);
    const grade = stu ? (stu['í•™ë…„-ë°˜'] || '') : '';
    const gender = stu ? (stu['ì„±ë³„'] || '') : '';
    const age = stu ? `ë§Œ${stu['ë‚˜ì´']}ì„¸` : '';

    const weeks = [1,2,3,4].map(w => ({
      date: n[`${w}ì£¼ì°¨ë‚ ì§œ`] || '',
      att:  n[`${w}ì£¼ì°¨ì¶œê²°`] || ''
    }));
    const doneCount = weeks.filter(w => w.att === 'ì¶œì„').length;
    const allDone   = doneCount >= 4;

    return `
    <div class="newbie-card">
      <div class="newbie-header">
        <div>
          <div class="newbie-name">
            ${n['ì´ë¦„']}
            ${n['ë“±ë¡ë‚ ì§œ'] ? `<small style="color:var(--gray-400);font-weight:400;font-size:.7rem;">${n['ë“±ë¡ë‚ ì§œ']} ë“±ë¡</small>` : ''}
            ${grade ? `<span class="badge badge-blue" style="font-size:.65rem;margin-left:4px;">${grade}</span>` : ''}
            ${gender ? `<span class="badge badge-gray" style="font-size:.65rem;">${gender}</span>` : ''}
          </div>
          <div style="font-size:.75rem;color:var(--gray-600);margin-top:3px;">
            ì¶œì„ ${doneCount}/4ì£¼ ${age ? `Â· ${age}` : ''}
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:6px;">
          <button class="btn btn-outline btn-sm" onclick="openEditNewbieModal('${n['ì´ë¦„']}')"
            style="padding:4px 10px;font-size:.72rem;border-color:var(--gray-200);color:var(--gray-600);">
            âœï¸ ìˆ˜ì •
          </button>
          <div class="badge ${allDone ? 'badge-green' : 'badge-amber'}">${allDone ? 'âœ… 4ì£¼ ì™„ë£Œ' : 'ì§„í–‰ ì¤‘'}</div>
        </div>
      </div>
      <div class="week-grid">
        ${weeks.map((w, i) => `
          <div class="week-item">
            <div class="week-label">${i+1}ì£¼ì°¨</div>
            <input class="mmdd-input" type="text" maxlength="5"
              id="wdate_${n['ì´ë¦„'].replace(/\s/g,'_')}_${i+1}"
              value="${toMmDd(w.date)}"
              placeholder="MM.DD"
              oninput="formatMmDdInput(this)">
            <div style="margin-top:5px;">
              ${w.att === 'ì¶œì„'
                ? `<div style="font-size:.7rem;color:#16A34A;font-weight:700;">âœ… ì¶œì„</div>`
                : `<button class="btn btn-primary btn-sm" style="width:100%;font-size:.72rem;padding:4px;"
                    onclick="saveNewbieWeek('${n['ì´ë¦„']}',${i+1})">ì €ì¥</button>`}
            </div>
          </div>`).join('')}
      </div>
      ${allDone ? `
      <div class="assign-section">
        <div style="font-size:.85rem;font-weight:600;margin-bottom:8px;color:var(--primary);">ğŸ‰ 4ì£¼ ì¶œì„ ì™„ë£Œ! ì •ê·œ ë°˜ì— ë°°ì •í•˜ì„¸ìš”.</div>
        <button class="btn btn-success btn-sm" onclick="openAssignModal('${n['ì´ë¦„']}','${n['ì´ë¦„']}')">ì •ê·œ ë°˜ ë°°ì •í•˜ê¸° â†’</button>
      </div>` : ''}
    </div>`;
  }).join('');
}

// MM.DD ìë™ í¬ë§· (ìˆ«ì 2ìë¦¬ ì…ë ¥ í›„ . ìë™ ì‚½ì…)
function formatMmDdInput(el) {
  let v = el.value.replace(/[^\d.]/g, '');
  // ì  ì—†ì´ ìˆ«ìë§Œ 3-4ìë¦¬ ì…ë ¥ ì‹œ ìë™ìœ¼ë¡œ ì  ì‚½ì…
  if (/^\d{3,4}$/.test(v)) {
    v = v.slice(0, 2) + '.' + v.slice(2);
  }
  el.value = v;
}


// â”€â”€ ìƒˆì¹œêµ¬ ì£¼ì°¨ ì¶œì„ ì €ì¥ (ë‚ ì§œ ì…ë ¥ + ì €ì¥ ë²„íŠ¼) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function saveNewbieWeek(name, week) {
  const inputId = 'wdate_' + name.replace(/\s/g, '_') + '_' + week;
  const input = document.getElementById(inputId);
  if (!input) { showToast('ë‚ ì§œ ì…ë ¥ë€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error'); return; }
  const rawVal = input.value.trim();
  if (!rawVal) { showToast(`${week}ì£¼ì°¨ ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì˜ˆ: 02.09)`, 'error'); return; }
  const date = parseMmDd(rawVal);
  if (!date) { showToast('ë‚ ì§œ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. MM.DD í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•˜ì„¸ìš”.', 'error'); return; }

  const newbie = allNewbies.find(n => (n['ì´ë¦„'] === name) || (n['í•™ìƒID'] === name));
  if (!newbie) { showToast('ìƒˆì¹œêµ¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error'); return; }

  const r = await callGAS('updateNewbieAtt', {
    studentId: newbie['í•™ìƒID'] || '',
    name,
    weekNum: week,
    date,
    status: 'ì¶œì„',  // ì €ì¥ = ì¶œì„
  });

  if (r.success) {
    newbie[`${week}ì£¼ì°¨ë‚ ì§œ`] = date;
    newbie[`${week}ì£¼ì°¨ì¶œê²°`] = 'ì¶œì„';
    showToast(`${week}ì£¼ì°¨ ì¶œì„ ì €ì¥ë¨ (${toMmDd(date)})`, 'success');
    renderNewbieList();
  } else {
    showToast(r.message || 'ì €ì¥ ì‹¤íŒ¨', 'error');
  }
}
async function updateNewbieDate(id, week, rawVal) {
  const date = parseMmDd(rawVal);
  // ì‹ ê·œ ì‹œíŠ¸: ì´ë¦„ì´ í‚¤, êµ¬ë²„ì „: í•™ìƒIDê°€ í‚¤
  const newbie = allNewbies.find(n => (n['ì´ë¦„'] === id) || (n['í•™ìƒID'] === id));
  if (!newbie) return;
  const attKey = `${week}ì£¼ì°¨ì¶œê²°`;
  const name = newbie['ì´ë¦„'] || '';
  await callGAS('updateNewbieAtt', {studentId: newbie['í•™ìƒID']||'', name, weekNum:week, date, status:newbie[attKey]||''});
  newbie[`${week}ì£¼ì°¨ë‚ ì§œ`] = date;
}

async function setNewbieAtt(id, week, status, btn) {
  const dateKey = `${week}ì£¼ì°¨ë‚ ì§œ`;
  const newbie  = allNewbies.find(n => (n['ì´ë¦„'] === id) || (n['í•™ìƒID'] === id));
  if (!newbie) return;
  const date = newbie[dateKey] || '';
  if (!date) { showToast('ë‚ ì§œë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.','error'); return; }
  const name = newbie['ì´ë¦„'] || '';
  const r = await callGAS('updateNewbieAtt', {studentId: newbie['í•™ìƒID']||'', name, weekNum:week, date, status});
  if (r.success) {
    newbie[`${week}ì£¼ì°¨ì¶œê²°`] = status;
    showToast('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.','success');
    renderNewbieList();
  } else showToast(r.message,'error');
}


// â”€â”€ ìƒˆì¹œêµ¬ ì§ì ‘ ì •ë³´ ìˆ˜ì • ëª¨ë‹¬ (ì´ë¦„ ê¸°ë°˜) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openEditNewbieModal(name) {
  // ìƒˆì¹œêµ¬ ë°ì´í„°
  const nb = allNewbies.find(n => n['ì´ë¦„'] === name);
  if (!nb) { showToast('ìƒˆì¹œêµ¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error'); return; }
  // í•™ìƒ ì‹œíŠ¸ì—ë„ ìˆëŠ” ê²½ìš° (êµ¬ë²„ì „)
  if (nb['í•™ìƒID']) { openEditStudentModal(nb['í•™ìƒID']); return; }
  // ì‹ ê·œ ì‹œíŠ¸: ìƒˆì¹œêµ¬ ì •ë³´ í¸ì§‘ ëª¨ë‹¬
  openNewbieInfoModal(nb);
}

function openNewbieInfoModal(nb) {
  let modal = document.getElementById('newbieInfoModal');
  if (!modal) {
    modal = document.createElement('div');
    modal.className = 'modal-backdrop';
    modal.id = 'newbieInfoModal';
    modal.addEventListener('click', e => { if (e.target === modal) closeModal('newbieInfoModal'); });
    document.body.appendChild(modal);
  }
  modal.innerHTML = `
    <div class="modal" style="max-width:400px;">
      <div class="modal-header">
        <div class="modal-title">ğŸŒ± ìƒˆì¹œêµ¬ ì •ë³´ ìˆ˜ì •</div>
        <button class="modal-close" onclick="closeModal('newbieInfoModal')">âœ•</button>
      </div>
      <div class="modal-body" style="display:grid;gap:10px;">
        <input type="hidden" id="nbiName" value="${nb['ì´ë¦„']}">
        <div class="form-group">
          <label class="form-label">ì´ë¦„</label>
          <input class="form-control" id="nbiNameEdit" value="${nb['ì´ë¦„']||''}">
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
          <div class="form-group">
            <label class="form-label">ì„±ë³„</label>
            <select class="form-control" id="nbiGender">
              <option value="ë‚¨" ${nb['ì„±ë³„']==='ë‚¨'?'selected':''}>ë‚¨</option>
              <option value="ì—¬" ${nb['ì„±ë³„']==='ì—¬'?'selected':''}>ì—¬</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">ìƒë…„ì›”ì¼</label>
            <input class="form-control" id="nbiBirth" value="${nb['ìƒë…„ì›”ì¼']||''}">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">ë³¸ì¸ ì—°ë½ì²˜</label>
          <input class="form-control" id="nbiPhone" value="${nb['ë³¸ì¸ì—°ë½ì²˜']||''}">
        </div>
        <div class="form-group">
          <label class="form-label">í•™ë¶€ëª¨ ì—°ë½ì²˜ (ë¶€)</label>
          <input class="form-control" id="nbiParentFather" value="${nb['í•™ë¶€ëª¨ì—°ë½ì²˜(ë¶€)']||''}">
        </div>
        <div class="form-group">
          <label class="form-label">í•™ë¶€ëª¨ ì—°ë½ì²˜ (ëª¨)</label>
          <input class="form-control" id="nbiParentMother" value="${nb['í•™ë¶€ëª¨ì—°ë½ì²˜(ëª¨)']||''}">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" style="flex:1" onclick="closeModal('newbieInfoModal')">ì·¨ì†Œ</button>
        <button class="btn btn-danger btn-sm" style="flex:1" onclick="deleteNewbieByName('${nb['ì´ë¦„']}')">ì‚­ì œ</button>
        <button class="btn btn-primary" style="flex:2" onclick="submitNewbieInfoEdit()">ì €ì¥</button>
      </div>
    </div>`;
  openModal('newbieInfoModal');
}

async function submitNewbieInfoEdit() {
  const origName = document.getElementById('nbiName').value;
  const updates = {
    origName,
    name:   document.getElementById('nbiNameEdit').value.trim(),
    gender: document.getElementById('nbiGender').value,
    birth:  document.getElementById('nbiBirth').value.trim(),
    phone:  document.getElementById('nbiPhone').value.trim(),
    parentFather: document.getElementById('nbiParentFather').value.trim(),
    parentMother: document.getElementById('nbiParentMother').value.trim(),
  };
  const r = await callGAS('updateNewbieInfo', updates);
  if (r.success) {
    showToast('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
    closeModal('newbieInfoModal');
    await loadNewbies();
    renderNewbieList();
  } else showToast(r.message || 'ì €ì¥ ì‹¤íŒ¨', 'error');
}

async function deleteNewbieByName(name) {
  if (!confirm(`"${name}" ìƒˆì¹œêµ¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
  const r = await callGAS('deleteNewbieByName', { name });
  if (r.success) {
    showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
    closeModal('newbieInfoModal');
    await loadNewbies();
    renderNewbieList();
  } else showToast(r.message || 'ì‚­ì œ ì‹¤íŒ¨', 'error');
}
function openAssignModal(id, name) {
  document.getElementById('assignStudentId').value = id;
  // ì´ë¦„ hidden input (ì‹ ê·œ ì‹œíŠ¸ìš©)
  let nameInput = document.getElementById('assignStudentName');
  if (!nameInput) {
    nameInput = document.createElement('input');
    nameInput.type = 'hidden';
    nameInput.id = 'assignStudentName';
    document.getElementById('assignStudentId').parentNode.appendChild(nameInput);
  }
  nameInput.value = name;
  document.getElementById('assignModal').querySelector('.modal-title').textContent = `${name} - ë°˜ ë°°ì •`;
  const classes = [...new Set(allStudents.filter(s=>s['ìƒíƒœ']==='ë“±ë¡').map(s=>s['í•™ë…„-ë°˜']))].sort();
  const teachers = allTeachers.filter(t=>t['êµ¬ë¶„']==='ë‹´ì„');
  const opts = classes.map(c=>`<option value="${c}">${c}</option>`);
  if (!opts.length) opts.push(`<option value="">ë°˜ì„ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”</option>`);
  document.getElementById('assignClass').innerHTML = opts.join('');
  openModal('assignModal');
}

async function confirmAssign() {
  const id   = document.getElementById('assignStudentId').value;
  const name = document.getElementById('assignStudentName') ? document.getElementById('assignStudentName').value : id;
  const cls  = document.getElementById('assignClass').value;
  if (!cls) { showToast('ë°˜ì„ ì„ íƒí•´ì£¼ì„¸ìš”.','error'); return; }
  const teacher = allTeachers.find(t => (t['ë‹´ë‹¹ í•™ë…„-ë°˜']||'').split(',').map(c=>c.trim()).includes(cls));
  const teacherName = teacher ? teacher['ì´ë¦„'] : '';
  const r = await callGAS('assignToClass', { studentId: id, name, targetClass: cls, teacher: teacherName });
  if (r.success) {
    showToast(r.message, 'success');
    closeModal('assignModal');
    await loadStudents(); await loadNewbies();
    renderDashboard(); renderNewbieList(); renderRecords();
    setupAttendanceDateSelect();
  } else showToast(r.message,'error');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// êµì  ê´€ë¦¬ ë·°
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentRecordTab = 'students';
let recSortKey = 'class';

function switchRecordTab(tab) {
  currentRecordTab = tab;
  document.getElementById('recordStudentList').style.display = tab === 'students' ? '' : 'none';
  document.getElementById('recordTeacherList').style.display  = tab === 'teachers' ? '' : 'none';
  document.getElementById('recSortBar').style.display = tab === 'students' ? '' : 'none';
  const filterBar = document.getElementById('recFilterBar');
  if (filterBar) filterBar.style.display = tab === 'students' ? '' : 'none';
  document.getElementById('recTabStudents').classList.toggle('active', tab === 'students');
  document.getElementById('recTabTeachers').classList.toggle('active', tab === 'teachers');
  if (tab === 'students') renderRecords();
  else renderTeacherRecords();
}

function toggleRecSortMenu() {
  const m = document.getElementById('recSortMenu');
  m.style.display = m.style.display === 'none' ? 'block' : 'none';
}

function setRecSort(key) {
  recSortKey = key;
  const labels = {
    name_asc:'ì´ë¦„ â†‘', name_desc:'ì´ë¦„ â†“',
    age_asc:'ë‚˜ì´ â†‘', age_desc:'ë‚˜ì´ â†“',
    status:'ìƒíƒœë³„', class:'í•™ë…„-ë°˜ìˆœ'
  };
  document.getElementById('recSortLabel').textContent = labels[key] || key;
  // ì²´í¬ í‘œì‹œ
  document.querySelectorAll('[id^="rschk_"]').forEach(el => el.style.opacity = '0');
  const chk = document.getElementById(`rschk_${key}`);
  if (chk) chk.style.opacity = '1';
  document.getElementById('recSortMenu').style.display = 'none';
  renderRecords();
}

// í•™ë…„-ë°˜ ì •ë ¬ ìš°ì„ ìˆœìœ„
function classOrder(c) {
  if (!c) return '9_zzz';
  if (c.startsWith('ì´ˆ6')) return '1_' + c;
  if (c.startsWith('ì¤‘1')) return '2_' + c;
  if (c.startsWith('ì¤‘2')) return '3_' + c;
  if (c.startsWith('ì¤‘3')) return '4_' + c;
  if (c.startsWith('ê³ 1')) return '5_' + c;
  if (c.startsWith('ê³ 2')) return '6_' + c;
  if (c.startsWith('ê³ 3')) return '7_' + c;
  return '9_' + c;
}

const STATUS_ORDER = ['ë“±ë¡','ì‹¬ë°©í•„ìš”','ì¥ê²°ì','ìœ í•™ì¤‘','ìƒˆì¹œêµ¬'];

function sortStudents(list) {
  const s = [...list];
  switch (recSortKey) {
    case 'name_asc':  return s.sort((a,b)=>a['ì´ë¦„'].localeCompare(b['ì´ë¦„'],'ko'));
    case 'name_desc': return s.sort((a,b)=>b['ì´ë¦„'].localeCompare(a['ì´ë¦„'],'ko'));
    case 'age_asc':   return s.sort((a,b)=>(Number(a['ë‚˜ì´'])||0)-(Number(b['ë‚˜ì´'])||0));
    case 'age_desc':  return s.sort((a,b)=>(Number(b['ë‚˜ì´'])||0)-(Number(a['ë‚˜ì´'])||0));
    case 'status':    return s.sort((a,b)=>{
      const ai = STATUS_ORDER.indexOf(a['ìƒíƒœ']); const bi = STATUS_ORDER.indexOf(b['ìƒíƒœ']);
      return (ai<0?99:ai)-(bi<0?99:bi);
    });
    case 'class':
    default:          return s.sort((a,b)=>classOrder(a['í•™ë…„-ë°˜']).localeCompare(classOrder(b['í•™ë…„-ë°˜'])));
  }
}

// â”€â”€ êµì  í•„í„° ìƒíƒœ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let recViewMode = 'all'; // 'all' | 'grade' | 'status'
const _gradeFilter = new Set();
const _statusFilter = new Set();
const GRADE_ORDER_REC = ['ì´ˆ6','ì¤‘1','ì¤‘2','ì¤‘3','ê³ 1','ê³ 2','ê³ 3','ì˜ì–´ë°˜'];

function setRecViewMode(mode) {
  recViewMode = mode;
  ['all','grade','status'].forEach(m => {
    document.getElementById('recView'+m.charAt(0).toUpperCase()+m.slice(1)).classList.toggle('active', m === mode);
  });
  document.getElementById('recGradeFilter').style.display = mode === 'grade' ? 'flex' : 'none';
  document.getElementById('recStatusFilter').style.display = mode === 'status' ? 'flex' : 'none';
  if (mode !== 'grade') _gradeFilter.clear();
  if (mode !== 'status') _statusFilter.clear();
  // íƒœê·¸ ì´ˆê¸°í™”
  document.querySelectorAll('.filter-tag').forEach(b => b.classList.remove('active'));
  renderRecords();
}

function toggleGradeFilter(grade) {
  if (_gradeFilter.has(grade)) _gradeFilter.delete(grade);
  else _gradeFilter.add(grade);
  const btn = document.getElementById('fg_' + grade);
  if (btn) btn.classList.toggle('active', _gradeFilter.has(grade));
  renderRecords();
}

function toggleStatusFilter(st) {
  if (_statusFilter.has(st)) _statusFilter.delete(st);
  else _statusFilter.add(st);
  const btn = document.getElementById('fs_' + st);
  if (btn) btn.classList.toggle('active', _statusFilter.has(st));
  renderRecords();
}

function _studentCard(s) {
  const isAdmin = currentUser && currentUser.role === 'admin';
  const btns = isAdmin
    ? `<div style="display:flex;gap:6px;">
        <button class="btn btn-outline btn-sm" onclick="openEditStudentModal('${s['í•™ìƒID']}')">âœï¸</button>
        <button class="btn btn-danger btn-sm" onclick="deleteStudentConfirm('${s['í•™ìƒID']}','${s['ì´ë¦„']}')">ğŸ—‘ï¸</button>
      </div>`
    : `<button class="btn btn-outline btn-sm" onclick="showStudentDetail('${s['í•™ìƒID']}')">ìƒì„¸</button>`;
  // ë‚˜ì´ ìë™ ê³„ì‚° (ìƒë…„ì›”ì¼ì—ì„œ)
  let displayAge = s['ë‚˜ì´'] || '';
  if (!displayAge && s['ìƒë…„ì›”ì¼']) {
    const bd = String(s['ìƒë…„ì›”ì¼']).replace(/\s/g,'');
    if (/^\d{6}$/.test(bd)) {
      const yy = parseInt(bd.slice(0,2));
      const mm = parseInt(bd.slice(2,4));
      const dd = parseInt(bd.slice(4,6));
      const fy = yy <= (new Date().getFullYear()%100) ? 2000+yy : 1900+yy;
      const today = new Date();
      let age = today.getFullYear() - fy;
      if (today < new Date(today.getFullYear(), mm-1, dd)) age--;
      displayAge = age;
    }
  }
  return `<div class="card" style="margin-bottom:6px;" onclick="">
    <div class="card-body" style="display:flex;align-items:center;gap:12px;padding:11px 14px;">
      <div style="width:34px;height:34px;border-radius:50%;background:var(--primary-lt);display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--primary);font-size:.85rem;flex-shrink:0;">${s['ì´ë¦„'].charAt(0)}</div>
      <div style="flex:1;min-width:0;">
        <div style="font-weight:700;font-size:.88rem;">${s['ì´ë¦„']} <span class="badge ${statusBadgeClass(s['ìƒíƒœ'])}" style="font-size:.62rem;">${s['ìƒíƒœ']}</span></div>
        <div style="font-size:.73rem;color:var(--gray-500);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${s['í•™ë…„-ë°˜']||'-'} Â· ${s['ì„±ë³„']||'-'} Â· ë§Œ${displayAge||'-'}ì„¸ Â· ${s['ë‹´ì„êµì‚¬']||'-'}</div>
      </div>
      ${btns}
    </div>
  </div>`;
}

function renderRecords() {
  const el = document.getElementById('recordStudentList');
  const q = searchQuery.toLowerCase();
  let filtered = allStudents.filter(s => !q || s['ì´ë¦„'].includes(q));

  // í•„í„° ì ìš©
  if (recViewMode === 'grade' && _gradeFilter.size > 0) {
    filtered = filtered.filter(s => {
      const cls = s['í•™ë…„-ë°˜'] || '';
      return [..._gradeFilter].some(g => {
        if (g === 'ì˜ì–´ë°˜') return cls.includes('ì˜ì–´ë°˜');
        return cls.startsWith(g);
      });
    });
    // í•™ë…„ ìˆœì„œ ì •ë ¬
    filtered = filtered.sort((a,b) => {
      function gIdx(s) {
        const cls = s['í•™ë…„-ë°˜'] || '';
        for (let i=0;i<GRADE_ORDER_REC.length;i++) {
          if (GRADE_ORDER_REC[i]==='ì˜ì–´ë°˜' ? cls.includes('ì˜ì–´ë°˜') : cls.startsWith(GRADE_ORDER_REC[i])) return i;
        }
        return 99;
      }
      return gIdx(a)-gIdx(b) || (a['í•™ë…„-ë°˜']||'').localeCompare(b['í•™ë…„-ë°˜']||'');
    });
    // í•™ë…„ë³„ ì„¹ì…˜ ê·¸ë£¹
    if (!filtered.length) { el.innerHTML = `<div class="empty"><div class="empty-icon">ğŸ“š</div>í•´ë‹¹ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.</div>`; return; }
    const groups = {};
    filtered.forEach(s => {
      const cls = s['í•™ë…„-ë°˜'] || 'ê¸°íƒ€';
      const key = GRADE_ORDER_REC.find(g => g==='ì˜ì–´ë°˜' ? cls.includes('ì˜ì–´ë°˜') : cls.startsWith(g)) || 'ê¸°íƒ€';
      if (!groups[key]) groups[key];
      (groups[key] = groups[key] || []).push(s);
    });
    el.innerHTML = GRADE_ORDER_REC.filter(g => groups[g])
      .map(g => `
        <div style="background:var(--primary-lt);border-left:3px solid var(--primary);padding:6px 12px;border-radius:4px;margin:10px 0 6px;font-size:.78rem;font-weight:800;color:var(--primary);">${g} Â· ${groups[g].length}ëª…</div>
        ${sortStudents(groups[g]).map(_studentCard).join('')}
      `).join('');
    return;
  }

  if (recViewMode === 'status' && _statusFilter.size > 0) {
    filtered = filtered.filter(s => _statusFilter.has(s['ìƒíƒœ']));
  }

  filtered = sortStudents(filtered);
  if (!filtered.length) { el.innerHTML = `<div class="empty"><div class="empty-icon">ğŸ“š</div>í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.</div>`; return; }

  // â”€â”€ í•™ë…„Â·ë°˜ë³„ ê·¸ë£¹ í—¤ë” í‘œì‹œ (ì •ë ¬í‚¤ê°€ 'class'ì¸ ê²½ìš°) â”€
  if (recSortKey === 'class') {
    // 1ë‹¨ê³„: í•™ë…„ë³„ ê·¸ë£¹
    const gradeGroups = {};
    filtered.forEach(s => {
      const cls = s['í•™ë…„-ë°˜'] || 'ê¸°íƒ€';
      const gradeKey = GRADE_ORDER_REC.find(g => g==='ì˜ì–´ë°˜' ? cls.includes('ì˜ì–´ë°˜') : cls.startsWith(g)) || 'ê¸°íƒ€';
      (gradeGroups[gradeKey] = gradeGroups[gradeKey] || []).push(s);
    });
    const orderedGrades = [...GRADE_ORDER_REC.filter(g => gradeGroups[g]), ...(gradeGroups['ê¸°íƒ€'] ? ['ê¸°íƒ€'] : [])];

    // 2ë‹¨ê³„: ê° í•™ë…„ ë‚´ ë°˜ë³„ ê·¸ë£¹ (í•™ë…„-ë°˜ ê°’ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
    el.innerHTML = orderedGrades.map(grade => {
      const gradeStudents = gradeGroups[grade];
      // ë°˜ë³„ ì„œë¸Œê·¸ë£¹
      const classGroups = {};
      gradeStudents.forEach(s => {
        const cls = s['í•™ë…„-ë°˜'] || 'ê¸°íƒ€';
        (classGroups[cls] = classGroups[cls] || []).push(s);
      });
      // ë°˜ ì´ë¦„ ì •ë ¬
      const orderedClasses = Object.keys(classGroups).sort((a,b) => a.localeCompare(b,'ko'));

      const classHtml = orderedClasses.map(cls => {
        const stuInClass = classGroups[cls];
        // ë°˜ ë¼ë²¨ì„ ëª…ë‹¨ ì™¼ìª½ ì‚¬ì´ë“œì— ì„¸ë¡œë¡œ í‘œì‹œ
        const shortCls = cls.replace(grade,'').trim() || cls; // í•™ë…„ ë¶€ë¶„ ì œê±° í›„ '1ë°˜' ë“±ë§Œ
        return `
          <div style="display:flex;margin:4px 0 2px;">
            <div style="writing-mode:vertical-rl;text-orientation:mixed;background:var(--primary);color:#fff;
                        font-size:.72rem;font-weight:800;padding:8px 5px;border-radius:4px 0 0 4px;
                        min-height:40px;display:flex;align-items:center;justify-content:center;
                        flex-shrink:0;letter-spacing:.1em;cursor:default;" title="${cls}">
              ${shortCls}
            </div>
            <div style="flex:1;border:1.5px solid var(--primary-lt);border-left:none;border-radius:0 4px 4px 0;padding:4px 6px;overflow:hidden;">
              ${stuInClass.map(_studentCard).join('')}
            </div>
          </div>`;
      }).join('');

      const totalCount = gradeStudents.length;
      return `
        <div style="background:var(--primary-lt);border-left:3px solid var(--primary);padding:6px 12px;border-radius:4px;margin:10px 0 4px;font-size:.78rem;font-weight:800;color:var(--primary);">${grade} Â· ì´ ${totalCount}ëª…</div>
        ${classHtml}`;
    }).join('');
    return;
  }

  el.innerHTML = filtered.map(_studentCard).join('');
}

// ì™¸ë¶€ í´ë¦­ ì‹œ ì •ë ¬ ë©”ë‰´ ë‹«ê¸°

// â”€â”€ êµì‚¬ êµì  ì •ë ¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function toggleTeacherSortMenu() {
  const m = document.getElementById('teacherSortMenu');
  if (m) m.style.display = (m.style.display === 'none') ? 'block' : 'none';
}
function setTeacherSort(key) {
  teacherSortKey = key;
  const m = document.getElementById('teacherSortMenu');
  if (m) m.style.display = 'none';
  renderTeacherRecords();
}

function renderTeacherRecords() {
  const el = document.getElementById('recordTeacherList');
  if (!el) return;
  const q = searchQuery.toLowerCase();
  let filtered = allTeachers.filter(t => !q || (t['\uc774\ub984']||'').includes(q));
  if (!filtered.length) {
    el.innerHTML = '<div class="empty"><div class="empty-icon">\ud83d\udc68\u200d\ud83c\udfeb</div>\uad50\uc0ac\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.</div>';
    return;
  }
  const TOP_ROLES = ['\uad50\uc5ed\uc790','\ubaa9\uc0ac','\uc804\ub3c4\uc0ac','\ubd80\uc7a5','\ub9ac\ub354\uc2ed'];
  const FILTER_ROLES = ['\ub2f4\uc784','\ubd80\ub2f4\uc784','\uc0c8\uce5c\uad6c','\ubbf8\ub514\uc5b4','\ucc2c\uc591\ud300','\uc6cc\uc2ed\ud300','\uc0ac\uc5ed\ud300'];
  function isTop(t) { return (t['\uad6c\ubd84']||'').split(',').map(r=>r.trim()).some(r=>TOP_ROLES.includes(r)); }
  const anyChecked = FILTER_ROLES.some(r => _teacherRoleFilter.has(r));
  if (anyChecked) {
    filtered = filtered.filter(t => {
      if (isTop(t)) return true;
      return (t['\uad6c\ubd84']||'').split(',').map(r=>r.trim()).some(r => _teacherRoleFilter.has(r));
    });
  }
  const topTeachers = filtered.filter(isTop);
  let regular = filtered.filter(t => !isTop(t));
  switch(teacherSortKey) {
    case 'name_asc':   regular.sort((a,b)=>a['\uc774\ub984'].localeCompare(b['\uc774\ub984'],'ko')); break;
    case 'name_desc':  regular.sort((a,b)=>b['\uc774\ub984'].localeCompare(a['\uc774\ub984'],'ko')); break;
    case 'class_asc':  regular.sort((a,b)=>classOrder(a['\ub2f4\ub2f9 \ud559\ub144-\ubc18']).localeCompare(classOrder(b['\ub2f4\ub2f9 \ud559\ub144-\ubc18']))); break;
    case 'class_desc': regular.sort((a,b)=>classOrder(b['\ub2f4\ub2f9 \ud559\ub144-\ubc18']).localeCompare(classOrder(a['\ub2f4\ub2f9 \ud559\ub144-\ubc18']))); break;
    default: break;
  }
  el.innerHTML = _buildTeacherSortBar(anyChecked) + _buildTeacherFilterTags(anyChecked, FILTER_ROLES)
    + (topTeachers.length ? _teacherSectionHeader('\ud83d\udccc \uad50\uc5ed\uc790 \u00b7 \ub9ac\ub354\uc2ed', topTeachers.length) : '')
    + topTeachers.map(_renderTeacherCard).join('')
    + (regular.length ? _teacherSectionHeader('\uc77c\ubc18 \uad50\uc0ac', regular.length) : '')
    + regular.map(_renderTeacherCard).join('');
}

function _teacherSectionHeader(label, count) {
  return '<div style="font-size:.7rem;font-weight:800;color:var(--gray-400);letter-spacing:.05em;padding:6px 2px;border-bottom:1px solid var(--gray-100);margin-bottom:6px;">'
    + label + ' (' + count + '\uba85)</div>';
}

function _renderTeacherCard(t) {
  const id = t['\uad50\uc0acID'];
  const name = t['\uc774\ub984'];
  const roles = (t['\uad6c\ubd84']||'').split(',').map(r=>r.trim());
  const badges = roles.map(r=>'<span class="badge badge-amber" style="font-size:.62rem;">' + r + '</span>').join(' ');
  return '<div class="card" style="margin-bottom:6px;cursor:pointer;" onclick="showTeacherDetail(this.dataset.id)" data-id="' + id + '">'
    + '<div class="card-body" style="display:flex;align-items:center;gap:10px;padding:10px 14px;">'
    + '<div style="flex:1"><div style="font-weight:700;font-size:.88rem;">' + name + ' ' + badges + '</div>'
    + '<div style="font-size:.73rem;color:var(--gray-500);">' + (t['\ub2f4\ub2f9 \ud559\ub144-\ubc18']||'\ub2f4\ub2f9\ubc18 \uc5c6\uc74c') + ' \u00b7 ' + (t['\uc5f0\ub77d\uccb4']||'-') + '</div></div>'
    + '<div style="display:flex;gap:6px;">'
    + '<button class="btn btn-outline btn-sm" onclick="event.stopPropagation();openEditTeacherModal(this.closest(\'.card\').dataset.id)">\u270f\ufe0f</button>'
    + '<button class="btn btn-danger btn-sm" data-name="' + name + '" onclick="event.stopPropagation();deleteTeacherConfirm(this.closest(\'.card\').dataset.id,this.dataset.name)">\ud83d\uddd1\ufe0f</button>'
    + '</div></div></div>';
}

function _buildTeacherSortBar(anyChecked) {
  const lbl = TEACHER_SORT_LABELS[teacherSortKey] || '\uae30\ubcf8\uc21c';
  const FILTER_ROLES = ['\ub2f4\uc784','\ubd80\ub2f4\uc784','\uc0c8\uce5c\uad6c','\ubbf8\ub514\uc5b4','\ucc2c\uc591\ud300','\uc6cc\uc2ed\ud300','\uc0ac\uc5ed\ud300'];
  const clearHtml = anyChecked ? '<span onclick="_teacherRoleFilter.clear();renderTeacherRecords();event.stopPropagation();" style="font-size:.67rem;color:var(--primary);cursor:pointer;font-weight:700;margin-left:auto;">\uc804\uccb4\ud574\uc81c</span>' : '';
  const mkCheck = (key, label) => {
    const op = teacherSortKey === key ? 1 : 0;
    return '<div class="sort-menu-item" onclick="setTeacherSort(\'' + key + '\')">' + label + ' <span class="sort-check" style="opacity:' + op + '">\u2713</span></div>';
  };
  const filterRows = FILTER_ROLES.map(r => {
    const checked = _teacherRoleFilter.has(r);
    const bg = checked ? 'var(--primary)' : '#fff';
    const bd = checked ? 'var(--primary)' : 'var(--gray-300)';
    const clr = checked ? '#fff' : 'transparent';
    return '<div class="sort-menu-item" onclick="_toggleTeacherRoleFilter(\'' + r + '\');event.stopPropagation();" style="display:flex;align-items:center;gap:7px;">'
      + '<span style="width:15px;height:15px;border:1.5px solid ' + bd + ';border-radius:3px;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;background:' + bg + ';color:' + clr + ';font-size:.7rem;font-weight:900;">'
      + (checked ? '\u2713' : '') + '</span>' + r + '</div>';
  }).join('');

  return '<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">'
    + '<span style="font-size:.75rem;color:var(--gray-400);flex-shrink:0;">\uc815\ub82c/\ud544\ud130</span>'
    + '<div style="position:relative;" id="teacherSortWrap">'
    + '<button class="sort-dropdown-btn" onclick="toggleTeacherSortMenu()" style="font-size:.75rem;padding:5px 12px;">\ud83d\udd03 ' + lbl + (anyChecked ? ' \u00b7 \ud544\ud130' : '') + ' \u25bc</button>'
    + '<div class="sort-menu" id="teacherSortMenu" style="display:none;min-width:200px;">'
    + mkCheck('default', '\uae30\ubcf8\uc21c')
    + '<div class="sort-group-label">\uc774\ub984</div>'
    + mkCheck('name_asc', '\u2191 \uc774\ub984 \uc624\ub984\ucc28\uc21c')
    + mkCheck('name_desc', '\u2193 \uc774\ub984 \ub0b4\ub9bc\ucc28\uc21c')
    + '<div class="sort-group-label">\ud559\ub144\ubcc4</div>'
    + mkCheck('class_asc', '\u2191 \ud559\ub144 \uc624\ub984\ucc28\uc21c')
    + mkCheck('class_desc', '\u2193 \ud559\ub144 \ub0b4\ub9bc\ucc28\uc21c')
    + '<div class="sort-group-label" style="display:flex;align-items:center;">\uad6c\ubd84\ubcc4 \ud544\ud130 ' + clearHtml + '</div>'
    + filterRows
    + '</div></div></div>';
}

function _buildTeacherFilterTags(anyChecked, FILTER_ROLES) {
  if (!anyChecked) return '';
  const tags = FILTER_ROLES.filter(r=>_teacherRoleFilter.has(r)).map(r =>
    '<span style="font-size:.72rem;background:var(--primary-lt);color:var(--primary);padding:2px 8px;border-radius:50px;border:1px solid var(--primary);cursor:pointer;" onclick="_teacherRoleFilter.delete(\'' + r + '\');renderTeacherRecords();">' + r + ' \u2715</span>'
  ).join('');
  return '<div style="display:flex;flex-wrap:wrap;gap:4px;margin-bottom:8px;">'
    + tags
    + '<span style="font-size:.72rem;color:var(--gray-400);padding:2px 6px;cursor:pointer;text-decoration:underline;" onclick="_teacherRoleFilter.clear();renderTeacherRecords();">\uc804\uccb4 \ubcf4\uae30</span>'
    + '</div>';
}


const TEACHER_SORT_LABELS = {default:'ê¸°ë³¸ìˆœ',name_asc:'ì´ë¦„ â†‘',name_desc:'ì´ë¦„ â†“',class_asc:'í•™ë…„ â†‘',class_desc:'í•™ë…„ â†“',role:'êµ¬ë¶„í•„í„°'};
let teacherSortKey = 'default';
const _teacherRoleFilter = new Set(); // ì„ íƒëœ êµ¬ë¶„ í•„í„°

function _toggleTeacherRoleFilter(role) {
  if (_teacherRoleFilter.has(role)) _teacherRoleFilter.delete(role);
  else _teacherRoleFilter.add(role);
  renderTeacherRecords();
  // ë©”ë‰´ ë‹¤ì‹œ ì—´ê¸°
  setTimeout(() => {
    const m = document.getElementById('teacherSortMenu');
    if (m) m.style.display = 'block';
  }, 10);
}

function toggleTeacherSortMenu() {
  const m = document.getElementById('teacherSortMenu');
  if (m) m.style.display = (m.style.display === 'none') ? 'block' : 'none';
}
function setTeacherSort(key) {
  teacherSortKey = key;
  const m = document.getElementById('teacherSortMenu');
  if (m) m.style.display = 'none';
  renderTeacherRecords();
}



document.addEventListener('click', e => {
  const recWrap = document.getElementById('recSortWrap');
  if (recWrap && !recWrap.contains(e.target)) {
    const m = document.getElementById('recSortMenu');
    if (m) m.style.display='none';
  }
  const tWrap = document.getElementById('teacherSortWrap');
  if (tWrap && !tWrap.contains(e.target)) {
    const m = document.getElementById('teacherSortMenu');
    if (m) m.style.display='none';
  }
});

function formatBirthdateDisplay(bd) {
  if (!bd) return '-';
  const s = String(bd).replace(/\s/g,'');
  // YYMMDD í˜•ì‹
  if (/^\d{6}$/.test(s)) {
    const yy = s.slice(0,2), mm = s.slice(2,4), dd = s.slice(4,6);
    const fullYear = parseInt(yy) <= (new Date().getFullYear()%100) ? 2000+parseInt(yy) : 1900+parseInt(yy);
    return `20${yy}. ${parseInt(mm)}. ${parseInt(dd)}.`;
  }
  // YYYY-MM-DD
  if (/^\d{4}-\d{2}-\d{2}$/.test(s)) {
    const [y,m,d] = s.split('-');
    return `${y}. ${parseInt(m)}. ${parseInt(d)}.`;
  }
  return bd;
}

function showStudentDetail(id) {
  const s = allStudents.find(s=>s['í•™ìƒID']===id);
  if (!s) return;
  document.getElementById('detailTitle').textContent = s['ì´ë¦„'] + ' ìƒì„¸ì •ë³´';
  document.getElementById('detailBody').innerHTML = `
    <div style="display:grid;gap:10px;">
      ${detailRow('ì´ë¦„', s['ì´ë¦„'])}
      ${detailRow('í•™ë…„-ë°˜', s['í•™ë…„-ë°˜'])}
      ${detailRow('ë‹´ì„êµì‚¬', s['ë‹´ì„êµì‚¬']||'-')}
      ${detailRow('ì„±ë³„/ë‚˜ì´', `${s['ì„±ë³„']} / ë§Œ${s['ë‚˜ì´']}ì„¸`)}
      ${detailRow('ìƒë…„ì›”ì¼', formatBirthdateDisplay(s['ìƒë…„ì›”ì¼']))}
      ${detailRow('ë³¸ì¸ì—°ë½ì²˜', s['ë³¸ì¸ì—°ë½ì²˜']||'-')}
      ${detailRow('í•™ë¶€ëª¨ì—°ë½ì²˜(ë¶€)', s['í•™ë¶€ëª¨ì—°ë½ì²˜(ë¶€)']||s['í•™ë¶€ëª¨ì—°ë½ì²˜']||'-')}
      ${detailRow('í•™ë¶€ëª¨ì—°ë½ì²˜(ëª¨)', s['í•™ë¶€ëª¨ì—°ë½ì²˜(ëª¨)']||'-')}
      ${s['í•™êµ'] ? detailRow('í•™êµ', s['í•™êµ']) : ''}
      ${s['ì£¼ì†Œ'] ? detailRow('ì£¼ì†Œ', s['ì£¼ì†Œ']) : ''}
      ${detailRow('ìƒíƒœ', `<span class="badge ${statusBadgeClass(s['ìƒíƒœ'])}">${s['ìƒíƒœ']}</span>`)}
    </div>`;
  document.getElementById('detailFooter').innerHTML = `
    <button class="btn btn-outline" style="flex:1" onclick="closeModal('detailModal')">ë‹«ê¸°</button>
    <button class="btn btn-primary" style="flex:2" onclick="closeModal('detailModal');openEditStudentModal('${id}')">âœï¸ ìˆ˜ì •</button>`;
  openModal('detailModal');
}

function showTeacherDetail(id) {
  const t = allTeachers.find(t=>t['êµì‚¬ID']===id);
  if (!t) return;
  document.getElementById('detailTitle').textContent = t['ì´ë¦„'] + ' ì„ ìƒë‹˜';
  document.getElementById('detailBody').innerHTML = `
    <div style="display:grid;gap:10px;">
      ${detailRow('ì´ë¦„', t['ì´ë¦„'])}
      ${detailRow('ë‹´ë‹¹ë°˜', t['ë‹´ë‹¹ í•™ë…„-ë°˜']||'ë¯¸ë°°ì •')}
      ${detailRow('ì—°ë½ì²˜', t['ì—°ë½ì²˜']||'-')}
      ${t['ìƒë…„ì›”ì¼'] ? detailRow('ìƒë…„ì›”ì¼', t['ìƒë…„ì›”ì¼']) : ''}
      ${t['ì£¼ì†Œ'] ? detailRow('ì£¼ì†Œ', t['ì£¼ì†Œ']) : ''}
      ${detailRow('êµ¬ë¶„', (t['êµ¬ë¶„']||'').split(',').map(r=>`<span class="badge badge-amber">${r.trim()}</span>`).join(' '))}
    </div>`;
  document.getElementById('detailFooter').innerHTML = `
    <button class="btn btn-outline" style="flex:1" onclick="closeModal('detailModal')">ë‹«ê¸°</button>
    <button class="btn btn-primary" style="flex:2" onclick="closeModal('detailModal');openEditTeacherModal('${id}')">âœï¸ ìˆ˜ì •</button>`;
  openModal('detailModal');
}

function detailRow(label, value) {
  return `<div style="display:flex;gap:12px;padding:10px;background:var(--gray-50);border-radius:8px;align-items:center;">
    <span style="font-size:.78rem;font-weight:700;color:var(--gray-600);min-width:80px;">${label}</span>
    <span style="font-size:.88rem;">${value}</span>
  </div>`;
}

// â”€â”€ í•œêµ­ ë‚˜ì´ & ë§Œ ë‚˜ì´ ìë™ ê³„ì‚° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcAgeFromBirth(yymmdd) {
  const val = String(yymmdd).replace(/\D/g, '');
  const ageEl    = document.getElementById('sAge');
  const korAgeEl = document.getElementById('sKorAge');
  const hintEl   = document.getElementById('ageHint');
  function reset(msg) {
    if (ageEl) { ageEl.value = ''; ageEl.placeholder = msg || 'ë§Œ ë‚˜ì´'; }
    if (korAgeEl) { korAgeEl.value = ''; korAgeEl.placeholder = msg || 'í•œêµ­ ë‚˜ì´'; }
    if (hintEl) hintEl.style.display = 'none';
  }
  if (val.length < 6) { reset('ìë™ ê³„ì‚°'); return; }
  const yy = parseInt(val.slice(0,2));
  const mm = parseInt(val.slice(2,4));
  const dd = parseInt(val.slice(4,6));
  if (mm < 1 || mm > 12 || dd < 1 || dd > 31) { reset('ë‚ ì§œ ì˜¤ë¥˜'); return; }
  const today = new Date();
  const currentYY = today.getFullYear() % 100;
  const fullYear = yy <= currentYY ? 2000 + yy : 1900 + yy;
  let intAge = today.getFullYear() - fullYear;
  if (today < new Date(today.getFullYear(), mm-1, dd)) intAge -= 1;
  const korAge = today.getFullYear() - fullYear + 1;
  if (intAge < 0 || intAge > 120) { reset('í™•ì¸ í•„ìš”'); return; }
  if (korAgeEl) korAgeEl.value = korAge + 'ì„¸';
  if (ageEl)    ageEl.value    = intAge + 'ì„¸';
  if (hintEl) {
    const kEl = document.getElementById('ageKorDisplay');
    const iEl = document.getElementById('ageIntDisplay');
    if (kEl) kEl.textContent = korAge;
    if (iEl) iEl.textContent = intAge;
    hintEl.style.display = 'block';
  }
}

function openAddStudentModal(isNewbie=false) {
  document.getElementById('studentModalTitle').textContent = 'í•™ìƒ ë“±ë¡';
  document.getElementById('sId').value = '';
  document.getElementById('sName').value = '';
  document.getElementById('sGender').value = 'ë‚¨';
  document.getElementById('sAge').value = '';
  document.getElementById('sAge').placeholder = 'ë§Œ ë‚˜ì´';
  if (document.getElementById('sKorAge')) document.getElementById('sKorAge').value = '';
  if (document.getElementById('ageHint')) document.getElementById('ageHint').style.display = 'none';
  document.getElementById('sBirth').value = '';
  document.getElementById('sClass').value = isNewbie ? 'ìƒˆì¹œêµ¬' : '';
  document.getElementById('sTeacher').value = '';
  document.getElementById('sStatus').value = isNewbie ? 'ìƒˆì¹œêµ¬' : 'ë“±ë¡';
  document.getElementById('sContact').value = '';
  document.getElementById('sParentFather').value = '';
  document.getElementById('sParentMother').value = '';
  document.getElementById('sSchool').value = '';
  document.getElementById('sAddress').value = '';
  openModal('studentModal');
}

function openEditStudentModal(id) {
  const s = allStudents.find(s=>s['í•™ìƒID']===id);
  if (!s) return;
  document.getElementById('studentModalTitle').textContent = 'í•™ìƒ ì •ë³´ ìˆ˜ì •';
  document.getElementById('sId').value = s['í•™ìƒID'];
  document.getElementById('sName').value = s['ì´ë¦„'];
  document.getElementById('sGender').value = s['ì„±ë³„'];
  document.getElementById('sAge').value = s['ë‚˜ì´'];
  if (document.getElementById('sKorAge')) document.getElementById('sKorAge').value = s['í•œêµ­ë‚˜ì´'] || '';
  document.getElementById('sBirth').value = s['ìƒë…„ì›”ì¼'];
  if (s['ìƒë…„ì›”ì¼'] && typeof calcAgeFromBirth === 'function') calcAgeFromBirth(s['ìƒë…„ì›”ì¼']);
  document.getElementById('sClass').value = s['í•™ë…„-ë°˜'];
  document.getElementById('sTeacher').value = s['ë‹´ì„êµì‚¬']||'';
  document.getElementById('sStatus').value = s['ìƒíƒœ'];
  document.getElementById('sContact').value = s['ë³¸ì¸ì—°ë½ì²˜']||'';
  document.getElementById('sParentFather').value = s['í•™ë¶€ëª¨ì—°ë½ì²˜(ë¶€)']||s['í•™ë¶€ëª¨ì—°ë½ì²˜']||'';
  document.getElementById('sParentMother').value = s['í•™ë¶€ëª¨ì—°ë½ì²˜(ëª¨)']||'';
  if (document.getElementById('sSchool')) document.getElementById('sSchool').value = s['í•™êµ']||'';
  document.getElementById('sAddress').value = s['ì£¼ì†Œ']||'';
  openModal('studentModal');
}

async function submitStudent() {
  const id = document.getElementById('sId').value;
  const payload = {
    id,
    name: document.getElementById('sName').value.trim(),
    gender: document.getElementById('sGender').value,
    age: parseInt(document.getElementById('sAge').value) || '',
    birthdate: document.getElementById('sBirth').value.trim(),
    classGroup: document.getElementById('sClass').value.trim() || 'ìƒˆì¹œêµ¬',
    teacher: document.getElementById('sTeacher').value.trim(),
    status: document.getElementById('sStatus').value,
    contact: document.getElementById('sContact').value.trim(),
    parentContactFather: document.getElementById('sParentFather').value.trim(),
    parentContactMother: document.getElementById('sParentMother').value.trim(),
    school: document.getElementById('sSchool') ? document.getElementById('sSchool').value.trim() : '',
    address: document.getElementById('sAddress').value.trim(),
  };
  if (!payload.name) { showToast('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error'); return; }
  const action = id ? 'updateStudent' : 'addStudent';
  const r = await callGAS(action, payload);
  if (r.success) {
    showToast(r.message || 'ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
    closeModal('studentModal');
    await loadStudents(); await loadNewbies();
    renderDashboard(); renderNewbieList(); renderRecords();
    setupAttendanceDateSelect();
  } else showToast(r.message, 'error');
}

async function deleteStudentConfirm(id, name) {
  if (!confirm(`"${name}" í•™ìƒì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) return;
  const r = await callGAS('deleteStudent', {id});
  if (r.success) {
    showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.','success');
    await loadStudents();
    renderDashboard(); renderRecords();
  } else showToast(r.message,'error');
}

async function deleteTeacherConfirm(id, name) {
  if (!confirm(`"${name}" êµì‚¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) return;
  const r = await callGAS('deleteTeacher', {id});
  if (r.success) {
    showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.','success');
    await loadTeachers();
    renderDashboard(); renderTeacherRecords();
  } else showToast(r.message,'error');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// êµì‚¬ ëª¨ë‹¬ CRUD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleTeacherClassField() {
  const checks = [...document.querySelectorAll('#tRoleCheckboxes input[type=checkbox]')];
  const hasClass = checks.some(c => (c.value==='ë‹´ì„'||c.value==='ë¶€ë‹´ì„') && c.checked);
  document.getElementById('tClassGroup').style.display = hasClass ? '' : 'none';
}

function getTeacherRoles() {
  return [...document.querySelectorAll('#tRoleCheckboxes input[type=checkbox]:checked')].map(c=>c.value);
}

function setTeacherRoles(roleStr) {
  const roles = roleStr ? roleStr.split(',').map(r=>r.trim()) : [];
  document.querySelectorAll('#tRoleCheckboxes input[type=checkbox]').forEach(c => {
    c.checked = roles.includes(c.value);
  });
  toggleTeacherClassField();
}

function openAddTeacherModal() {
  document.getElementById('teacherModalTitle').textContent = 'êµì‚¬ ë“±ë¡';
  document.getElementById('tId').value = '';
  document.getElementById('tName').value = '';
  document.getElementById('tContact').value = '';
  document.getElementById('tBirth').value = '';
  document.getElementById('tClass').value = '';
  document.getElementById('tAddress').value = '';
  setTeacherRoles('ë‹´ì„');
  openModal('teacherModal');
}

function openEditTeacherModal(id) {
  const t = allTeachers.find(t=>t['êµì‚¬ID']===id);
  if (!t) return;
  document.getElementById('teacherModalTitle').textContent = 'êµì‚¬ ì •ë³´ ìˆ˜ì •';
  document.getElementById('tId').value = t['êµì‚¬ID'];
  document.getElementById('tName').value = t['ì´ë¦„'];
  document.getElementById('tContact').value = t['ì—°ë½ì²˜']||'';
  document.getElementById('tBirth').value = t['ìƒë…„ì›”ì¼']||'';
  document.getElementById('tClass').value = t['ë‹´ë‹¹ í•™ë…„-ë°˜']||'';
  document.getElementById('tAddress').value = t['ì£¼ì†Œ']||'';
  setTeacherRoles(t['êµ¬ë¶„']||'ë‹´ì„');
  openModal('teacherModal');
}

async function submitTeacher() {
  const id = document.getElementById('tId').value;
  const roles = getTeacherRoles();
  if (!roles.length) { showToast('êµ¬ë¶„ì„ í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.','error'); return; }
  const hasClassRole = roles.includes('ë‹´ì„') || roles.includes('ë¶€ë‹´ì„');
  const payload = {
    id,
    name: document.getElementById('tName').value.trim(),
    contact: document.getElementById('tContact').value.trim(),
    birthdate: document.getElementById('tBirth').value.trim(),
    classGroup: hasClassRole ? document.getElementById('tClass').value.trim() : '',
    role: roles.join(','),
    address: document.getElementById('tAddress').value.trim(),
  };
  if (!payload.name) { showToast('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.','error'); return; }
  const action = id ? 'updateTeacher' : 'addTeacher';
  const r = await callGAS(action, payload);
  if (r.success) {
    showToast(r.message||'ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.','success');
    closeModal('teacherModal');
    await loadTeachers();
    renderDashboard();
    renderTeacherRecords();
  } else showToast(r.message,'error');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ëª¨ë‹¬ / í† ìŠ¤íŠ¸ / ìœ í‹¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openModal(id) {
  document.getElementById(id).classList.add('open');
  document.body.style.overflow='hidden';
}
function closeModal(id) {
  document.getElementById(id).classList.remove('open');
  document.body.style.overflow='';
}

let toastTimer;
function showToast(msg, type='') {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.className = 'toast ' + (type==='success'?'success':type==='error'?'error':'');
  el.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(()=>el.classList.remove('show'), 3000);
}

function formatDate(d) {
  if (!d) return '';
  const [y, m, day] = d.split('-').map(Number);
  const dt = new Date(y, m - 1, day);
  const days = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
  return m + '/' + day + ' (' + days[dt.getDay()] + ')';
}

// ëª¨ë‹¬ ë°°ê²½ í´ë¦­ì‹œ ë‹«ê¸°
document.querySelectorAll('.modal-backdrop').forEach(el => {
  el.addEventListener('click', e => { if (e.target===el) closeModal(el.id); });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ë„¤ë¹„ê²Œì´ì…˜
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function goHome() {
  clearSearch();
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.getElementById('view-dashboard').classList.add('active');
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  const homeBtn = document.querySelector('.nav-btn[data-view="dashboard"]');
  if (homeBtn) homeBtn.classList.add('active');
}

document.querySelectorAll('.nav-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    clearSearch();
    const prevView = document.querySelector('.nav-btn.active');
    // ì´ì „ íƒ­ì´ ì¶œì„ì²´í¬ì˜€ìœ¼ë©´ í´ë§ ì¤‘ì§€
    if (prevView && prevView.dataset.view === 'attendance') stopAttPoll();

    document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
    document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
    btn.classList.add('active');
    const viewId = 'view-' + btn.dataset.view;
    document.getElementById(viewId).classList.add('active');

    if (btn.dataset.view === 'newbie') renderNewbieList();
    if (btn.dataset.view === 'attstat') initAttstatView();
    if (btn.dataset.view === 'records') switchRecordTab(currentRecordTab || 'students');
    if (btn.dataset.view === 'attendance') {
      loadAttendanceStats();
      startAttPoll(); // ì¶œì„ì²´í¬ íƒ­ ì§„ì… ì‹œ í´ë§ ì‹œì‘
    }
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// í—¤ë” ê²€ìƒ‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _isComposing = false;

const _searchInput = document.getElementById('globalSearch');

_searchInput.addEventListener('compositionstart', () => { _isComposing = true; });

_searchInput.addEventListener('compositionend', e => {
  _isComposing = false;
  searchQuery = e.target.value.trim();
  setTimeout(() => renderSearchDropdown(), 10); // í•œê¸€ ì™„ì„± ëŒ€ê¸°
});

_searchInput.addEventListener('input', e => {
  if (_isComposing) return;
  searchQuery = e.target.value.trim();
  // ë¡œë”© ì•ˆëœ ê²½ìš° ì¬ì‹œë„
  if (searchQuery && !allStudents.length && !allTeachers.length) {
    loadStudents().then(() => loadTeachers()).then(() => renderSearchDropdown());
    return;
  }
  renderSearchDropdown();
});

_searchInput.addEventListener('keydown', e => {
  if (e.key === 'Escape') { clearSearch(); return; }
  if (e.key === 'Enter' && !_isComposing) {
    e.preventDefault();
    if (searchQuery) openSearchPage(searchQuery);
  }
});

function clearSearch() {
  document.getElementById('globalSearch').value = '';
  searchQuery = '';
  document.getElementById('searchDropdown').classList.remove('show');
  document.getElementById('searchClearBtn').classList.remove('show');
}

// ê²€ìƒ‰ ëŒ€ìƒ: ì´ë¦„ + ë³¸ì¸ì—°ë½ì²˜ + í•™ë¶€ëª¨ì—°ë½ì²˜
function matchStudent(s, q) {
  if (!q) return false;
  return (s['ì´ë¦„'] || '').includes(q) ||
         (s['ë³¸ì¸ì—°ë½ì²˜'] || '').replace(/-/g,'').includes(q.replace(/-/g,'')) ||
         (s['í•™ë¶€ëª¨ì—°ë½ì²˜'] || '').replace(/-/g,'').includes(q.replace(/-/g,'')) ||
         (s['í•™ë¶€ëª¨ì—°ë½ì²˜(ë¶€)'] || '').replace(/-/g,'').includes(q.replace(/-/g,'')) ||
         (s['í•™ë¶€ëª¨ì—°ë½ì²˜(ëª¨)'] || '').replace(/-/g,'').includes(q.replace(/-/g,''));
}

function renderSearchDropdown() {
  const dropdown = document.getElementById('searchDropdown');
  const clearBtn = document.getElementById('searchClearBtn');
  const q = searchQuery.toLowerCase();

  if (!q) { dropdown.classList.remove('show'); clearBtn.classList.remove('show'); return; }
  clearBtn.classList.add('show');

  const matchStudents = allStudents.filter(s => matchStudent(s, q));
  const matchTeachers = allTeachers.filter(t => t['ì´ë¦„'] && t['ì´ë¦„'].toLowerCase().includes(q));

  if (!matchStudents.length && !matchTeachers.length) {
    dropdown.innerHTML = `<div class="search-drop-empty">ğŸ” "<strong>${escapeHtml(searchQuery)}</strong>" ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
    dropdown.classList.add('show');
    return;
  }

  let html = '';
  if (matchStudents.length) {
    html += `<div class="search-drop-header">í•™ìƒ ${matchStudents.length}ëª…</div>`;
    html += matchStudents.slice(0,8).map(s => {
      // ì—°ë½ì²˜ë¡œ ê²€ìƒ‰ëœ ê²½ìš° ì—°ë½ì²˜ í‘œì‹œ
      const nameMatch = (s['ì´ë¦„']||'').toLowerCase().includes(q);
      const subContact = !nameMatch ? `<span style="color:var(--primary);font-size:.68rem;">ğŸ“± ì—°ë½ì²˜ ë§¤ì¹­</span> ` : '';
      return `<div class="search-drop-item" onclick="closeSearchAndShow('student','${s['í•™ìƒID']}')">
        <div>
          <div class="search-drop-name">${highlightMatch(s['ì´ë¦„'], nameMatch ? searchQuery : '')}
            <span class="badge ${statusBadgeClass(s['ìƒíƒœ'])}" style="font-size:.62rem;margin-left:4px;">${s['ìƒíƒœ']}</span>
          </div>
          <div class="search-drop-sub">${subContact}${s['í•™ë…„-ë°˜']||'-'} Â· ${s['ì„±ë³„']||'-'} Â· ë§Œ${s['ë‚˜ì´']||'-'}ì„¸</div>
        </div>
      </div>`;
    }).join('');
    if (matchStudents.length > 8) html += `<div style="font-size:.72rem;color:var(--gray-400);padding:6px 12px;">ì™¸ ${matchStudents.length-8}ëª… ë” ìˆìŒ (ì—”í„°ë¡œ ì „ì²´ ê²€ìƒ‰)</div>`;
  }
  if (matchTeachers.length) {
    html += `<div class="search-drop-header">êµì‚¬ ${matchTeachers.length}ëª…</div>`;
    html += matchTeachers.slice(0,5).map(t => `
      <div class="search-drop-item" onclick="closeSearchAndShow('teacher','${t['êµì‚¬ID']}')">
        <div>
          <div class="search-drop-name">${highlightMatch(t['ì´ë¦„'], searchQuery)}</div>
          <div class="search-drop-sub">${t['ë‹´ë‹¹ í•™ë…„-ë°˜']||'ë¯¸ë°°ì •'} Â· ${t['êµ¬ë¶„']}</div>
        </div>
      </div>`).join('');
  }

  dropdown.innerHTML = html;
  dropdown.classList.add('show');
}

function highlightMatch(text, query) {
  if (!query) return escapeHtml(text);
  const escaped = escapeHtml(text);
  const re = new RegExp(`(${query.replace(/[.*+?^${}()|[\]\\]/g,'\\$&')})`, 'gi');
  return escaped.replace(re, '<mark style="background:#FEF08A;border-radius:2px;padding:0 1px;">$1</mark>');
}

function closeSearchAndShow(type, id) {
  clearSearch();
  if (type === 'student') showStudentDetail(id);
  else showTeacherDetail(id);
}

// ì—”í„°: ê²€ìƒ‰ ê²°ê³¼ ì „ìš© í™”ë©´ìœ¼ë¡œ ì „í™˜
let _prevView = 'dashboard';
function openSearchPage(q) {
  if (!q) return;
  document.getElementById('searchDropdown').classList.remove('show');
  // í˜„ì¬ í™œì„± ë·° ì €ì¥
  const activeView = document.querySelector('.view.active');
  if (activeView) _prevView = activeView.id.replace('view-','');

  // ëª¨ë“  ë·° ë¹„í™œì„±í™”, ê²€ìƒ‰ ë·° í™œì„±í™”
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.getElementById('view-search').classList.add('active');
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));

  renderSearchPage(q);
}

function exitSearchPage() {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  const target = document.getElementById('view-' + _prevView) || document.getElementById('view-dashboard');
  target.classList.add('active');
  const navBtn = document.querySelector(`.nav-btn[data-view="${_prevView}"]`);
  if (navBtn) navBtn.classList.add('active');
  clearSearch();
}

function renderSearchPage(q) {
  const qLow = q.toLowerCase();
  document.getElementById('searchPageTitle').textContent = `"${q}" ê²€ìƒ‰ ê²°ê³¼`;

  const matchStudents = allStudents.filter(s => matchStudent(s, qLow));
  const matchTeachers = allTeachers.filter(t => (t['ì´ë¦„']||'').toLowerCase().includes(qLow));

  let html = '';

  if (!matchStudents.length && !matchTeachers.length) {
    html = `<div class="empty"><div class="empty-icon">ğŸ”</div>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
  }

  if (matchStudents.length) {
    html += `<div class="section-title" style="margin-bottom:8px;">ğŸ‘¨â€ğŸ“ í•™ìƒ ${matchStudents.length}ëª…</div>`;
    html += matchStudents.map(s => {
      const nameMatch = (s['ì´ë¦„']||'').toLowerCase().includes(qLow);
      return `<div class="card" style="margin-bottom:8px;" onclick="showStudentDetail('${s['í•™ìƒID']}')">
        <div class="card-body" style="display:flex;align-items:center;gap:12px;padding:12px 14px;cursor:pointer;">
          <div style="flex:1">
            <div style="font-weight:700;font-size:.9rem;">${s['ì´ë¦„']}
              <span class="badge ${statusBadgeClass(s['ìƒíƒœ'])}" style="font-size:.68rem;">${s['ìƒíƒœ']}</span>
              ${!nameMatch?'<span style="font-size:.65rem;background:#DCFCE7;color:#166534;border-radius:50px;padding:1px 6px;margin-left:4px;">ğŸ“± ì—°ë½ì²˜</span>':''}
            </div>
            <div style="font-size:.75rem;color:var(--gray-600);">${s['í•™ë…„-ë°˜']||'-'} Â· ${s['ì„±ë³„']||'-'} Â· ë§Œ${s['ë‚˜ì´']||'-'}ì„¸</div>
            ${!nameMatch?`<div style="font-size:.7rem;color:var(--gray-400);">ğŸ“± ${s['ë³¸ì¸ì—°ë½ì²˜']||s['í•™ë¶€ëª¨ì—°ë½ì²˜(ë¶€)']||s['í•™ë¶€ëª¨ì—°ë½ì²˜']||''}</div>`:''}
          </div>
          <span style="color:var(--gray-300);">â€º</span>
        </div>
      </div>`;
    }).join('');
  }

  if (matchTeachers.length) {
    html += `<div class="section-title" style="margin:14px 0 8px;">ğŸ‘©â€ğŸ« êµì‚¬ ${matchTeachers.length}ëª…</div>`;
    html += matchTeachers.map(t => `
      <div class="card" style="margin-bottom:8px;" onclick="showTeacherDetail('${t['êµì‚¬ID']}')">
        <div class="card-body" style="display:flex;align-items:center;gap:12px;padding:12px 14px;cursor:pointer;">
          <div style="flex:1">
            <div style="font-weight:700;font-size:.9rem;">${t['ì´ë¦„']}
              <span class="badge badge-amber" style="font-size:.65rem;">${t['êµ¬ë¶„']}</span>
            </div>
            <div style="font-size:.75rem;color:var(--gray-600);">${t['ë‹´ë‹¹ í•™ë…„-ë°˜']||'ë¯¸ë°°ì •'} Â· ${t['ì—°ë½ì²˜']||'-'}</div>
          </div>
          <span style="color:var(--gray-300);">â€º</span>
        </div>
      </div>`).join('');
  }

  document.getElementById('searchPageContent').innerHTML = html;
}

// ë“œë¡­ë‹¤ìš´ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
document.addEventListener('click', e => {
  const wrap = document.getElementById('searchWrap');
  if (wrap && !wrap.contains(e.target)) {
    document.getElementById('searchDropdown').classList.remove('show');
  }
});

// ìƒì¼ ì›” í•„í„°
document.getElementById('monthFilter').addEventListener('click', e => {
  const btn = e.target.closest('.month-btn');
  if (!btn) return;
  document.querySelectorAll('.month-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  filterMonth = parseInt(btn.dataset.month);
  renderStudentList();
});

// â”€â”€ ì •ë ¬ ë©”ë‰´ ì™¸ë¶€ í´ë¦­ ë‹«ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener('click', e => {
  ['recSortWrap','teacherSortWrap'].forEach(id => {
    const wrap = document.getElementById(id);
    const menuId = id === 'recSortWrap' ? 'recSortMenu' : 'teacherSortMenu';
    if (wrap && !wrap.contains(e.target)) {
      const m = document.getElementById(menuId);
      if (m) m.style.display = 'none';
    }
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì‹œì‘ â€” sessionStorage ìë™ ë¡œê·¸ì¸ ì‹œë„
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(async function startup() {
  // â”€â”€ ë¹„ë°€ë²ˆí˜¸ ê°•ì œ ì´ˆê¸°í™” ëª©ë¡ (ê´€ë¦¬ìê°€ ì§ì ‘ ì§€ì •)
  // ì´ ë°°ì—´ì— ì´ë¦„ì„ ë„£ìœ¼ë©´ ì•± ë¡œë“œ ì‹œ í•´ë‹¹ ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸ê°€ 1234ë¡œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤
  const _FORCE_RESET_PASSWORDS = ['ìµœê´‘ì‹'];
  _FORCE_RESET_PASSWORDS.forEach(n => {
    _localClearPw(n); // localStorage ì‚­ì œ
    if (GAS_URL) callGAS('resetPassword', { name: n }).catch(() => {}); // GAS ì‹œíŠ¸ë„ ì‚­ì œ
  });

  // â”€â”€ í•­ìƒ ë¡œê·¸ì¸ í™”ë©´ì„ ë¨¼ì € ë³´ì—¬ì¤Œ (ê¸°ë³¸ê°’: display:flex)
  document.getElementById('loginScreen').style.display = 'flex';

  // â”€â”€ êµì‚¬ ëª©ë¡ ë¡œë“œ (ì‹¤íŒ¨í•´ë„ ë¡œê·¸ì¸ í™”ë©´ì€ ìœ ì§€)
  try { await loadTeachers(); } catch(e) { console.warn('startup loadTeachers:', e); }

  // â”€â”€ ì €ì¥ëœ ì„¸ì…˜ í™•ì¸
  let saved = null;
  try { saved = JSON.parse(localStorage.getItem('churchUser') || 'null'); } catch(e) {}

  // ë²„ì „ ë¶ˆì¼ì¹˜ â†’ ì„¸ì…˜ ë¬´íš¨í™” (ì´ì „ ìë™ë¡œê·¸ì¸ ë°ì´í„° ì œê±°)
  if (saved && saved._version !== APP_SESSION_VERSION) {
    try { localStorage.removeItem('churchUser'); } catch(e) {}
    saved = null;
  }

  if (!saved || !saved.name) {
    // ì„¸ì…˜ ì—†ìŒ â†’ ë¡œê·¸ì¸ í™”ë©´ ìœ ì§€
    return;
  }

  // â”€â”€ ì„¸ì…˜ ìœ íš¨ì„± ê²€ì¦ í›„ ìë™ ë¡œê·¸ì¸
  if (saved.role === 'admin') {
    const savedTeacher = allTeachers.find(t => t['ì´ë¦„'] === saved.name);
    const savedIsAdmin = isAdminName(saved.name) || (savedTeacher && hasRole(savedTeacher, ADMIN_ROLES));
    if (!savedIsAdmin) {
      try { localStorage.removeItem('churchUser'); } catch(e) {}
      return;
    }
    currentUser = { name: saved.name, role: 'admin', classGroup: saved.classGroup || '' };
    if (savedTeacher) currentUser.teacherObj = savedTeacher;
    completeLogin();

  } else if (saved.role === 'newbie_teacher') {
    const teacher = allTeachers.find(t => t['ì´ë¦„'] === saved.name);
    if (!teacher || !hasRole(teacher, NEWBIE_TEACHER_ROLES)) {
      try { localStorage.removeItem('churchUser'); } catch(e) {}
      return;
    }
    currentUser = { name: teacher['ì´ë¦„'], role: 'newbie_teacher',
      classGroup: teacher['ë‹´ë‹¹ í•™ë…„-ë°˜'] || '', teacherObj: teacher };
    completeLogin();

  } else {
    // ì¼ë°˜êµì‚¬ / ë¦¬ë”ì‹­
    const teacher = allTeachers.find(t => t['ì´ë¦„'] === saved.name);
    if (!teacher) {
      try { localStorage.removeItem('churchUser'); } catch(e) {}
      return;
    }
    currentUser = { name: teacher['ì´ë¦„'], role: getTeacherRole(teacher),
      classGroup: teacher['ë‹´ë‹¹ í•™ë…„-ë°˜'] || '', teacherObj: teacher };
    completeLogin();
  }
})();
</script>
</body>
</html>
